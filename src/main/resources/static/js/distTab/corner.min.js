/*!ipacs4.0 - 1.0.0-2021-06-22 */
!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define("cornerstone-core",[],b):"object"==typeof exports?exports["cornerstone-core"]=b():a.cornerstone=b()}(window,function(){return function(a){function b(a){delete installedChunks[a]}function c(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.charset="utf-8",c.src=n.p+""+a+"."+u+".hot-update.js",b.appendChild(c)}function d(a){return a=a||1e4,new Promise(function(b,c){if("undefined"==typeof XMLHttpRequest)return c(new Error("No browser support"));try{var d=new XMLHttpRequest,e=n.p+""+u+".hot-update.json";d.open("GET",e,!0),d.timeout=a,d.send(null)}catch(f){return c(f)}d.onreadystatechange=function(){if(4===d.readyState)if(0===d.status)c(new Error("Manifest request to "+e+" timed out."));else if(404===d.status)b();else if(200!==d.status&&304!==d.status)c(new Error("Manifest request to "+e+" failed."));else{try{var a=JSON.parse(d.responseText)}catch(f){return void c(f)}b(a)}}})}function e(a){var b=G[a];if(!b)return n;var c=function(c){return b.hot.active?(G[c]?G[c].parents.indexOf(a)===-1&&G[c].parents.push(a):(x=[a],p=c),b.children.indexOf(c)===-1&&b.children.push(c)):(console.warn("[HMR] unexpected require("+c+") from disposed module "+a),x=[]),n(c)},d=function(a){return{configurable:!0,enumerable:!0,get:function(){return n[a]},set:function(b){n[a]=b}}};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&"e"!==e&&"t"!==e&&Object.defineProperty(c,e,d(e));return c.e=function(a){function b(){C--,"prepare"===A&&(D[a]||k(a),0===C&&0===B&&l())}return"ready"===A&&g("prepare"),C++,n.e(a).then(b,function(a){throw b(),a})},c.t=function(a,b){return 1&b&&(a=c(a)),n.t(a,b&-2)},c}function f(a){var b={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:p!==a,active:!0,accept:function(a,c){if(void 0===a)b._selfAccepted=!0;else if("function"==typeof a)b._selfAccepted=a;else if("object"==typeof a)for(var d=0;d<a.length;d++)b._acceptedDependencies[a[d]]=c||function(){};else b._acceptedDependencies[a]=c||function(){}},decline:function(a){if(void 0===a)b._selfDeclined=!0;else if("object"==typeof a)for(var c=0;c<a.length;c++)b._declinedDependencies[a[c]]=!0;else b._declinedDependencies[a]=!0},dispose:function(a){b._disposeHandlers.push(a)},addDisposeHandler:function(a){b._disposeHandlers.push(a)},removeDisposeHandler:function(a){var c=b._disposeHandlers.indexOf(a);c>=0&&b._disposeHandlers.splice(c,1)},check:i,apply:m,status:function(a){return a?void z.push(a):A},addStatusHandler:function(a){z.push(a)},removeStatusHandler:function(a){var b=z.indexOf(a);b>=0&&z.splice(b,1)},data:w[a]};return p=void 0,b}function g(a){A=a;for(var b=0;b<z.length;b++)z[b].call(null,a)}function h(a){var b=+a+""===a;return b?+a:a}function i(a){if("idle"!==A)throw new Error("check() is only allowed in idle status");return t=a,g("check"),d(v).then(function(a){if(!a)return g("idle"),null;E={},D={},F=a.c,s=a.h,g("prepare");var b=new Promise(function(a,b){q={resolve:a,reject:b}});r={};var c="cornerstone";return k(c),"prepare"===A&&0===C&&0===B&&l(),b})}function j(a,b){if(F[a]&&E[a]){E[a]=!1;for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(r[c]=b[c]);0===--B&&0===C&&l()}}function k(a){F[a]?(E[a]=!0,B++,c(a)):D[a]=!0}function l(){g("ready");var a=q;if(q=null,a)if(t)Promise.resolve().then(function(){return m(t)}).then(function(b){a.resolve(b)},function(b){a.reject(b)});else{var b=[];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&b.push(h(c));a.resolve(b)}}function m(c){function d(a){for(var b=[a],c={},d=b.slice().map(function(a){return{chain:[a],id:a}});d.length>0;){var f=d.pop(),g=f.id,h=f.chain;if(k=G[g],k&&!k.hot._selfAccepted){if(k.hot._selfDeclined)return{type:"self-declined",chain:h,moduleId:g};if(k.hot._main)return{type:"unaccepted",chain:h,moduleId:g};for(var i=0;i<k.parents.length;i++){var j=k.parents[i],l=G[j];if(l){if(l.hot._declinedDependencies[g])return{type:"declined",chain:h.concat([j]),moduleId:g,parentId:j};b.indexOf(j)===-1&&(l.hot._acceptedDependencies[g]?(c[j]||(c[j]=[]),e(c[j],[g])):(delete c[j],b.push(j),d.push({chain:h.concat([j]),id:j})))}}}}return{type:"accepted",moduleId:a,outdatedModules:b,outdatedDependencies:c}}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];a.indexOf(d)===-1&&a.push(d)}}if("ready"!==A)throw new Error("apply() is only allowed in ready status");c=c||{};var f,i,j,k,l,m={},o=[],p={},q=function(){console.warn("[HMR] unexpected require("+v.moduleId+") to disposed module")};for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){l=h(t);var v;v=r[t]?d(l):{type:"disposed",moduleId:t};var y=!1,z=!1,B=!1,C="";switch(v.chain&&(C="\nUpdate propagation: "+v.chain.join(" -> ")),v.type){case"self-declined":c.onDeclined&&c.onDeclined(v),c.ignoreDeclined||(y=new Error("Aborted because of self decline: "+v.moduleId+C));break;case"declined":c.onDeclined&&c.onDeclined(v),c.ignoreDeclined||(y=new Error("Aborted because of declined dependency: "+v.moduleId+" in "+v.parentId+C));break;case"unaccepted":c.onUnaccepted&&c.onUnaccepted(v),c.ignoreUnaccepted||(y=new Error("Aborted because "+l+" is not accepted"+C));break;case"accepted":c.onAccepted&&c.onAccepted(v),z=!0;break;case"disposed":c.onDisposed&&c.onDisposed(v),B=!0;break;default:throw new Error("Unexception type "+v.type)}if(y)return g("abort"),Promise.reject(y);if(z){p[l]=r[l],e(o,v.outdatedModules);for(l in v.outdatedDependencies)Object.prototype.hasOwnProperty.call(v.outdatedDependencies,l)&&(m[l]||(m[l]=[]),e(m[l],v.outdatedDependencies[l]))}B&&(e(o,[v.moduleId]),p[l]=q)}var D=[];for(i=0;i<o.length;i++)l=o[i],G[l]&&G[l].hot._selfAccepted&&D.push({module:l,errorHandler:G[l].hot._selfAccepted});g("dispose"),Object.keys(F).forEach(function(a){F[a]===!1&&b(a)});for(var E,H=o.slice();H.length>0;)if(l=H.pop(),k=G[l]){var I={},J=k.hot._disposeHandlers;for(j=0;j<J.length;j++)(f=J[j])(I);for(w[l]=I,k.hot.active=!1,delete G[l],delete m[l],j=0;j<k.children.length;j++){var K=G[k.children[j]];K&&(E=K.parents.indexOf(l),E>=0&&K.parents.splice(E,1))}}var L,M;for(l in m)if(Object.prototype.hasOwnProperty.call(m,l)&&(k=G[l]))for(M=m[l],j=0;j<M.length;j++)L=M[j],E=k.children.indexOf(L),E>=0&&k.children.splice(E,1);g("apply"),u=s;for(l in p)Object.prototype.hasOwnProperty.call(p,l)&&(a[l]=p[l]);var N=null;for(l in m)if(Object.prototype.hasOwnProperty.call(m,l)&&(k=G[l])){M=m[l];var O=[];for(i=0;i<M.length;i++)if(L=M[i],f=k.hot._acceptedDependencies[L]){if(O.indexOf(f)!==-1)continue;O.push(f)}for(i=0;i<O.length;i++){f=O[i];try{f(M)}catch(P){c.onErrored&&c.onErrored({type:"accept-errored",moduleId:l,dependencyId:M[i],error:P}),c.ignoreErrored||N||(N=P)}}}for(i=0;i<D.length;i++){var Q=D[i];l=Q.module,x=[l];try{n(l)}catch(P){if("function"==typeof Q.errorHandler)try{Q.errorHandler(P)}catch(R){c.onErrored&&c.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:R,originalError:P}),c.ignoreErrored||N||(N=R),N||(N=P)}else c.onErrored&&c.onErrored({type:"self-accept-errored",moduleId:l,error:P}),c.ignoreErrored||N||(N=P)}}return N?(g("fail"),Promise.reject(N)):(g("idle"),new Promise(function(a){a(o)}))}function n(b){if(G[b])return G[b].exports;var c=G[b]={i:b,l:!1,exports:{},hot:f(b),parents:(y=x,x=[],y),children:[]};return a[b].call(c.exports,c,c.exports,e(b)),c.l=!0,c.exports}var o=window.webpackHotUpdate;window.webpackHotUpdate=function(a,b){j(a,b),o&&o(a,b)};var p,q,r,s,t=!0,u="236f9d7982d2d4eff8cb",v=1e4,w={},x=[],y=[],z=[],A="idle",B=0,C=0,D={},E={},F={},G={};return n.m=a,n.c=G,n.d=function(a,b,c){n.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:c})},n.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},n.t=function(a,b){if(1&b&&(a=n(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var d in a)n.d(c,d,function(b){return a[b]}.bind(null,d));return c},n.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};return n.d(b,"a",b),b},n.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},n.p="",n.h=function(){return u},e("./index.js")(n.s="./index.js")}({"./canvasToPixel.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/getTransform.js");b["default"]=function(a,b){var c=Object(d.getEnabledElement)(a),f=Object(e["default"])(c);return f.invert(),f.transformPoint(b.x,b.y)}},"./colors/colormap.js":function(a,b,c){"use strict";function d(a,b,c){c=null===c?100:c;for(var d=(b-a)/(c-1),e=[];c-- >0;)e.push(a),a+=d;return e[e.length-1]=b,e}function e(a,b){for(var c=0,d=a.length-1;c<=d;){var e=c+Math.floor((d-c)/2),f=a[e];if(f===b)return e;b<f?d=e-1:c=e+1}return c}function f(a,b){var c,d=[],f=b.length;for(a.sort(function(a,b){return a-b}),c=0;c<f;c++)d[c]=e(a,b[c]);return d}function g(a,b,c){var e,g=[],h=[],i=[],j=[];for(c=null===c?1:c,e=0;e<b.length;e++){var k=b[e];g.push((a-1)*k[0]),h.push(k[1]),i.push(k[1])}var l=d(0,1,a);for(e=0;e<a;e++)l[e]=(a-1)*Math.pow(l[e],c);var m=f(g,l);for(e=1;e<a-1;e++){var n=m[e],o=(l[e]-g[n-1])/(g[n]-g[n-1]),p=h[n]-i[n-1];j[e]=o*p+i[n-1]}return j[0]=i[0],j[a-1]=h[b.length-1],j}function h(a,b,c){var d,e=[];b=null===b?256:b,c=null===c?1:c;var f=g(b,a.red,c),h=g(b,a.green,c),i=g(b,a.blue,c);for(d=0;d<b;d++){var j=Math.round(255*f[d]),k=Math.round(255*h[d]),l=Math.round(255*i[d]),m=[j,k,l,255];e.push(m)}return e}function i(){var a=[],b=Object.keys(m);return b.forEach(function(b){if(m.hasOwnProperty(b)){var c=m[b];a.push({id:b,name:c.name})}}),a.sort(function(a,b){var c=a.name.toLowerCase(),d=b.name.toLowerCase();return c===d?0:c<d?-1:1}),a}function j(a,b){var c=m[a];return c||(c=m[a]=b||{name:"",colors:[]}),!c.colors&&c.segmentedData&&(c.colors=h(c.segmentedData,c.numColors,c.gamma)),{getId:function(){return a},getColorSchemeName:function(){return c.name},setColorSchemeName:function(a){c.name=a},getNumberOfColors:function(){return c.colors.length},setNumberOfColors:function(a){for(;c.colors.length<a;)c.colors.push(l);c.colors.length=a},getColor:function(a){return this.isValidIndex(a)?c.colors[a]:l},getColorRepeating:function(a){var b=c.colors.length;return a=b?a%b:0,this.getColor(a)},setColor:function(a,b){this.isValidIndex(a)&&(c.colors[a]=b)},addColor:function(a){c.colors.push(a)},insertColor:function(a,b){this.isValidIndex(a)&&c.colors.splice(a,1,b)},removeColor:function(a){this.isValidIndex(a)&&c.colors.splice(a,1)},clearColors:function(){c.colors=[]},buildLookupTable:function(a){if(a){var b=c.colors.length;a.setNumberOfTableValues(b);for(var d=0;d<b;d++)a.setTableValue(d,c.colors[d])}},createLookupTable:function(){var a=new k["default"];return this.buildLookupTable(a),a},isValidIndex:function(a){return a>=0&&a<c.colors.length}}}c.r(b),c.d(b,"getColormapsList",function(){return i}),c.d(b,"getColormap",function(){return j});var k=c("./colors/lookupTable.js"),l=[0,0,0,0],m={rainbowColorPallet:{name:"rainbowColorPallet",numOfColors:256,colors:[[0,0,0],[4,4,4],[8,0,8],[16,0,16],[20,0,20],[24,0,24],[33,0,33],[37,0,37],[41,0,41],[44,0,44],[49,0,49],[53,0,53],[57,0,57],[60,0,60],[66,0,66],[70,0,70],[74,0,74],[82,0,82],[90,0,90],[99,0,99],[107,0,107],[115,0,115],[123,0,123],[132,0,132],[140,0,140],[148,0,148],[156,0,156],[165,0,165],[173,0,173],[181,0,181],[189,0,189],[198,0,198],[206,0,206],[214,0,214],[222,0,222],[231,0,231],[239,0,239],[247,0,247],[255,0,255],[255,0,255],[247,0,255],[239,0,255],[231,0,255],[222,0,255],[214,0,255],[206,0,255],[198,0,255],[189,0,255],[181,0,255],[173,0,255],[165,0,255],[156,0,255],[148,0,255],[140,0,255],[132,0,255],[123,0,255],[115,0,255],[107,0,255],[99,0,255],[90,0,255],[82,0,255],[74,0,255],[66,0,255],[57,0,255],[49,0,255],[41,0,255],[33,0,255],[24,0,255],[16,0,255],[8,0,255],[0,0,255],[0,0,255],[0,8,255],[0,16,255],[0,24,255],[0,33,255],[0,41,255],[0,49,255],[0,57,255],[0,66,255],[0,74,255],[0,82,255],[0,90,255],[0,99,255],[0,107,255],[0,115,255],[0,123,255],[0,132,255],[0,140,255],[0,148,255],[0,156,255],[0,165,255],[0,169,255],[0,173,255],[0,181,255],[0,189,255],[0,198,255],[0,206,255],[0,214,255],[0,222,255],[0,231,255],[0,239,255],[0,247,255],[0,255,255],[0,255,247],[0,255,255],[0,247,231],[0,247,239],[0,239,214],[0,239,222],[0,231,198],[0,231,206],[0,222,181],[0,222,189],[0,214,165],[0,214,173],[0,206,148],[0,206,156],[0,198,123],[0,198,132],[0,198,140],[0,189,115],[0,189,123],[0,181,99],[0,181,107],[0,177,94],[0,173,82],[0,173,90],[0,165,66],[0,165,74],[0,156,41],[0,156,49],[0,156,57],[0,148,24],[0,148,33],[0,148,41],[0,140,16],[0,140,24],[0,136,10],[0,132,0],[0,132,8],[0,132,0],[8,132,0],[8,136,0],[8,140,0],[16,140,0],[24,140,0],[24,148,0],[33,148,0],[37,148,0],[41,148,0],[41,156,0],[45,156,0],[49,156,0],[57,156,0],[57,165,0],[66,165,0],[74,165,0],[74,173,0],[82,173,0],[90,173,0],[94,177,0],[99,181,0],[107,181,0],[115,189,0],[123,189,0],[132,198,0],[140,198,0],[144,202,0],[148,206,0],[156,206,0],[165,214,0],[169,214,0],[173,214,0],[181,222,0],[189,222,0],[198,231,0],[202,231,0],[206,231,0],[214,239,0],[222,239,0],[231,247,0],[239,247,0],[247,255,0],[255,255,0],[255,255,0],[255,247,0],[255,239,0],[255,231,0],[255,222,0],[255,214,0],[255,206,0],[255,198,0],[255,189,0],[255,181,0],[255,177,0],[255,173,0],[255,165,0],[255,156,0],[255,148,0],[255,144,0],[255,140,0],[255,132,0],[255,123,0],[255,115,0],[255,107,0],[255,99,0],[255,94,0],[255,90,0],[255,82,0],[255,74,0],[255,66,0],[255,57,0],[255,49,0],[255,41,0],[255,33,0],[255,24,0],[255,16,0],[255,8,0],[255,0,0],[255,0,0],[255,8,8],[255,16,16],[255,24,24],[255,33,33],[255,41,41],[255,49,49],[255,57,57],[255,66,66],[255,74,74],[255,82,82],[255,90,90],[255,99,99],[255,107,107],[255,115,115],[255,123,123],[255,132,132],[255,140,140],[255,144,144],[255,148,148],[255,152,152],[255,156,156],[255,165,165],[255,173,173],[255,181,181],[255,185,185],[255,189,189],[255,198,198],[255,206,206],[255,214,214],[255,222,222],[255,231,231],[255,239,239],[255,247,247],[255,255,255],[255,255,255]]},hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]
}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}}},"./colors/index.js":function(a,b,c){"use strict";c.r(b);var d=c("./colors/colormap.js"),e=c("./colors/lookupTable.js");b["default"]={getColormap:d.getColormap,getColormapsList:d.getColormapsList,LookupTable:e["default"]}},"./colors/lookupTable.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}function g(a,b,c){if(a>1)throw new Error("HSVToRGB expects hue < 1");var d=[];if(0===b)return d[0]=c,d[1]=c,d[2]=c,d;var e=Math.floor(6*a),f=6*a-e,g=c*(1-b),h=c*(1-b*f),i=c*(1-b*(1-f));switch(e){case 0:case 6:d[0]=c,d[1]=i,d[2]=g;break;case 1:d[0]=h,d[1]=c,d[2]=g;break;case 2:d[0]=g,d[1]=c,d[2]=i;break;case 3:d[0]=g,d[1]=h,d[2]=c;break;case 4:d[0]=i,d[1]=g,d[2]=c;break;case 5:d[0]=c,d[1]=g,d[2]=h}return d}function h(a,b){var c;return c=a<b.Range[0]?b.MaxIndex+i+1.5:a>b.Range[1]?b.MaxIndex+j+1.5:(a+b.Shift)*b.Scale,Math.floor(c)}c.r(b);var i=0,j=1,k=2,l=function(){function a(){d(this,a),this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}return f(a,[{key:"setNumberOfTableValues",value:function(a){this.NumberOfColors=a}},{key:"setRamp",value:function(a){this.Ramp=a}},{key:"setTableRange",value:function(a,b){this.TableRange[0]=a,this.TableRange[1]=b}},{key:"setHueRange",value:function(a,b){this.HueRange[0]=a,this.HueRange[1]=b}},{key:"setSaturationRange",value:function(a,b){this.SaturationRange[0]=a,this.SaturationRange[1]=b}},{key:"setValueRange",value:function(a,b){this.ValueRange[0]=a,this.ValueRange[1]=b}},{key:"setRange",value:function(a,b){this.InputRange[0]=a,this.InputRange[1]=b}},{key:"setAlphaRange",value:function(a,b){this.AlphaRange[0]=a,this.AlphaRange[1]=b}},{key:"getColor",value:function(a){return this.mapValue(a)}},{key:"build",value:function(a){if(!(this.Table.length>1)||a){this.Table=[];var b,c,d,e,f=this.NumberOfColors-1;f?(b=(this.HueRange[1]-this.HueRange[0])/f,c=(this.SaturationRange[1]-this.SaturationRange[0])/f,d=(this.ValueRange[1]-this.ValueRange[0])/f,e=(this.AlphaRange[1]-this.AlphaRange[0])/f):b=c=d=e=0;for(var h=0;h<=f;h++){var i=this.HueRange[0]+h*b,j=this.SaturationRange[0]+h*c,k=this.ValueRange[0]+h*d,l=this.AlphaRange[0]+h*e,m=g(i,j,k),n=[];switch(this.Ramp){case"scurve":n[0]=Math.floor(127.5*(1+Math.cos((1-m[0])*Math.PI))),n[1]=Math.floor(127.5*(1+Math.cos((1-m[1])*Math.PI))),n[2]=Math.floor(127.5*(1+Math.cos((1-m[2])*Math.PI))),n[3]=Math.floor(255*l);break;case"linear":n[0]=Math.floor(255*m[0]+.5),n[1]=Math.floor(255*m[1]+.5),n[2]=Math.floor(255*m[2]+.5),n[3]=Math.floor(255*l+.5);break;case"sqrt":n[0]=Math.floor(255*Math.sqrt(m[0])+.5),n[1]=Math.floor(255*Math.sqrt(m[1])+.5),n[2]=Math.floor(255*Math.sqrt(m[2])+.5),n[3]=Math.floor(255*Math.sqrt(l)+.5);break;default:throw new Error("Invalid Ramp value (".concat(this.Ramp,")"))}this.Table.push(n)}this.buildSpecialColors()}}},{key:"buildSpecialColors",value:function(){var a=this.NumberOfColors,b=a+i,c=a+j,d=a+k;this.UseBelowRangeColor||0===a?this.Table[b]=this.BelowRangeColor:this.Table[b]=this.Table[0],this.UseAboveRangeColor||0===a?this.Table[c]=this.AboveRangeColor:this.Table[c]=this.Table[a-1],this.Table[d]=this.NaNColor}},{key:"mapValue",value:function(a){var b=this.getIndex(a);if(b<0)return this.NaNColor;if(0===b){if(this.UseBelowRangeColor&&a<this.TableRange[0])return this.BelowRangeColor}else if(b===this.NumberOfColors-1&&this.UseAboveRangeColor&&a>this.TableRange[1])return this.AboveRangeColor;return this.Table[b]}},{key:"getIndex",value:function(a){var b={};if(b.Range=[],b.MaxIndex=this.NumberOfColors-1,b.Shift=-this.TableRange[0],this.TableRange[1]<=this.TableRange[0]?b.Scale=Number.MAX_VALUE:b.Scale=b.MaxIndex/(this.TableRange[1]-this.TableRange[0]),b.Range[0]=this.TableRange[0],b.Range[1]=this.TableRange[1],isNaN(a))return-1;var c=h(a,b);return c===this.NumberOfColors+i?c=0:c===this.NumberOfColors+j&&(c=this.NumberOfColors-1),c}},{key:"setTableValue",value:function(a,b){if(5===arguments.length&&(b=Array.prototype.slice.call(arguments,1)),a<0)throw new Error("Can't set the table value for negative index (".concat(a,")"));a>=this.NumberOfColors&&new Error("Index ".concat(a," is greater than the number of colors ").concat(this.NumberOfColors)),this.Table[a]=b,0!==a&&a!==this.NumberOfColors-1||this.buildSpecialColors()}}]),a}();b["default"]=l},"./disable.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./triggerEvent.js"),f=c("./events.js");b["default"]=function(a){if(void 0===a)throw new Error("disable: element must not be undefined");for(var b=Object(d.getEnabledElements)(),c=0;c<b.length;c++)if(b[c].element===a){var g={element:a};Object(e["default"])(a,f["default"].ELEMENT_DISABLED,g),Object(e["default"])(f.events,f["default"].ELEMENT_DISABLED,g),b[c].element.removeChild(b[c].canvas),b[c].canvas=void 0,b.splice(c,1);break}}},"./displayImage.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/getDefaultViewport.js"),f=c("./updateImage.js"),g=c("./internal/now.js"),h=c("./layers.js"),i=c("./triggerEvent.js"),j=c("./events.js");b["default"]=function(a,b,c){if(void 0===a)throw new Error("displayImage: parameter element must not be undefined");if(void 0===b)throw new Error("displayImage: parameter image must not be undefined");var k=Object(d.getEnabledElement)(a),l=k.image;if(k.image=b,k.layers&&k.layers.length&&Object(h.setLayerImage)(a,b),void 0===k.viewport&&(k.viewport=Object(e["default"])(k.canvas,b)),c)for(var m in c)null!==c[m]&&(k.viewport[m]=c[m]);var n;if(void 0!==k.lastImageTimeStamp){var o=Object(g["default"])()-k.lastImageTimeStamp;n=(1e3/o).toFixed()}k.lastImageTimeStamp=Object(g["default"])();var p={viewport:k.viewport,element:k.element,image:k.image,oldImage:l,enabledElement:k,frameRate:n};Object(i["default"])(k.element,j["default"].NEW_IMAGE,p),Object(f["default"])(a)}},"./displayImageDraw.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/getDefaultViewport.js"),f=c("./updateImage.js"),g=c("./internal/now.js"),h=(c("./layers.js"),c("./triggerEvent.js")),i=c("./events.js");b["default"]=function(a,b,c){if(void 0===a)throw new Error("displayImage: parameter element must not be undefined");if(void 0===b)throw new Error("displayImage: parameter image must not be undefined");var j=Object(d.getEnabledElement)(a);if(j.image=b,void 0===j.viewport&&(j.viewport=Object(e["default"])(j.canvas,b)),c)for(var k in c)null!==c[k]&&(j.viewport[k]=c[k]);var l;if(void 0!==j.lastImageTimeStamp){var m=Object(g["default"])()-j.lastImageTimeStamp;l=(1e3/m).toFixed()}j.lastImageTimeStamp=Object(g["default"])();var n={viewport:j.viewport,element:j.element,image:j.image,enabledElement:j,frameRate:l};return Object(h["default"])(j.element,i["default"].NEW_IMAGE,n),Object(f["default"])(a),!0}},"./draw.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/drawImage.js");b["default"]=function(a){var b=Object(d.getEnabledElement)(a);if(void 0===b.image)throw new Error("draw: image has not been loaded yet");Object(e["default"])(b)}},"./drawInvalidated.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/drawImage.js");b["default"]=function(){for(var a=Object(d.getEnabledElements)(),b=0;b<a.length;b++){var c=a[b];c.invalid===!0&&Object(e["default"])(c,!0)}}},"./enable.js":function(a,b,c){"use strict";function d(a){return void 0!==a.image||a.layers.length>0}c.r(b);var e=c("./enabledElements.js"),f=c("./resize.js"),g=c("./internal/drawImageSync.js"),h=c("./internal/requestAnimationFrame.js"),i=c("./internal/tryEnableWebgl.js"),j=c("./triggerEvent.js"),k=c("./generateUUID.js"),l=c("./events.js"),m=c("./internal/getCanvas.js");b["default"]=function(a,b){function c(a){if(void 0!==o.canvas){var b={enabledElement:o,timestamp:a};Object(j["default"])(o.element,l["default"].PRE_RENDER,b),o.needsRedraw&&d(o)&&Object(g["default"])(o,o.invalid),Object(h["default"])(c)}}if(void 0===a)throw new Error("enable: parameter element cannot be undefined");b&&b.renderer&&"webgl"===b.renderer.toLowerCase()&&Object(i["default"])(b);var n=Object(m["default"])(a),o={element:a,canvas:n,image:void 0,invalid:!1,needsRedraw:!0,options:b,layers:[],data:{},renderingTools:{},uuid:Object(k["default"])()};Object(e.addEnabledElement)(o),Object(j["default"])(l.events,l["default"].ELEMENT_ENABLED,o),Object(f["default"])(a,!0),c()}},"./enabledElementData.js":function(a,b,c){"use strict";function d(a,b){var c=Object(f.getEnabledElement)(a);return c.data.hasOwnProperty(b)===!1&&(c.data[b]={}),c.data[b]}function e(a,b){var c=Object(f.getEnabledElement)(a);delete c.data[b]}c.r(b),c.d(b,"getElementData",function(){return d}),c.d(b,"removeElementData",function(){return e});var f=c("./enabledElements.js")},"./enabledElements.js":function(a,b,c){"use strict";function d(a){if(void 0===a)throw new Error("getEnabledElement: parameter element must not be undefined");for(var b=0;b<h.length;b++)if(h[b].element===a)return h[b];throw new Error("element not enabled")}function e(a){if(void 0===a)throw new Error("getEnabledElement: enabledElement element must not be undefined");h.push(a)}function f(a){var b=[];return h.forEach(function(c){c.image&&c.image.imageId===a&&b.push(c)}),b}function g(){return h}c.r(b),c.d(b,"getEnabledElement",function(){return d}),c.d(b,"addEnabledElement",function(){return e}),c.d(b,"getEnabledElementsByImageId",function(){return f}),c.d(b,"getEnabledElements",function(){return g});var h=[]},"./events.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}c.r(b),c.d(b,"events",function(){return i});var g={NEW_IMAGE:"cornerstonenewimage",INVALIDATED:"cornerstoneinvalidated",PRE_RENDER:"cornerstoneprerender",IMAGE_CACHE_MAXIMUM_SIZE_CHANGED:"cornerstoneimagecachemaximumsizechanged",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",IMAGE_CACHE_FULL:"cornerstoneimagecachefull",IMAGE_CACHE_CHANGED:"cornerstoneimagecachechanged",WEBGL_TEXTURE_REMOVED:"cornerstonewebgltextureremoved",WEBGL_TEXTURE_CACHE_FULL:"cornerstonewebgltexturecachefull",IMAGE_LOADED:"cornerstoneimageloaded",IMAGE_LOAD_FAILED:"cornerstoneimageloadfailed",ELEMENT_RESIZED:"cornerstoneelementresized",IMAGE_RENDERED:"cornerstoneimagerendered",LAYER_ADDED:"cornerstonelayeradded",LAYER_REMOVED:"cornerstonelayerremoved",ACTIVE_LAYER_CHANGED:"cornerstoneactivelayerchanged",ELEMENT_DISABLED:"cornerstoneelementdisabled",ELEMENT_ENABLED:"cornerstoneelementenabled"};b["default"]=g;var h=function(){function a(){d(this,a),this.listeners={},this.namespaces={}}return f(a,[{key:"addEventNamespaceListener",value:function(a,b){a.indexOf(".")<=0||(this.namespaces[a]=b,this.addEventListener(a.split(".")[0],b))}},{key:"removeEventNamespaceListener",value:function(a){a.indexOf(".")<=0||!this.namespaces[a]||(this.removeEventListener(a.split(".")[0],this.namespaces[a]),delete this.namespaces[a])}},{key:"addEventListener",value:function(a,b){return a.indexOf(".")>0?void this.addEventNamespaceListener(a,b):(a in this.listeners||(this.listeners[a]=[]),void this.listeners[a].push(b))}},{key:"removeEventListener",value:function(a,b){if(a.indexOf(".")>0)return void this.removeEventNamespaceListener(a);if(a in this.listeners)for(var c=this.listeners[a],d=0,e=c.length;d<e;d++)if(c[d]===b)return void c.splice(d,1)}},{key:"dispatchEvent",value:function(a){if(!(a.type in this.listeners))return!0;for(var b=this.listeners[a.type],c=0,d=b.length;c<d;c++)b[c].call(this,a);return!a.defaultPrevented}}]),a}(),i=new h},"./falseColorMapping.js":function(a,b,c){"use strict";function d(a){for(var b,c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=a.length,f=0;f<e;f++)b=a[f],c=c<b?c:b,d=d>b?d:b;return{minPixelValue:c,maxPixelValue:d}}function e(a){if(a.restore)return a.restore;var b=a.color,c=a.rgba,d=a.cachedLut,e=a.slope,f=a.windowWidth,g=a.windowCenter,h=a.minPixelValue,i=a.maxPixelValue;return function(){if(a.color=b,a.rgba=c,a.cachedLut=d,a.slope=e,a.windowWidth=f,a.windowCenter=g,a.minPixelValue=h,a.maxPixelValue=i,a.origPixelData){var j=a.origPixelData;a.getPixelData=function(){return j}}a.origPixelData=void 0,a.colormapId=void 0,a.falseColor=void 0}}function f(a){return a&&"string"==typeof a&&(a=Object(l.getColormap)(a)),a}function g(a){return!(!a.restore||"function"!=typeof a.restore)&&(a.restore(),!0)}function h(a,b){if(a.color&&!a.falseColor)throw new Error("Color transforms are not implemented yet");b=f(b);var c=b.getId();if(a.colormapId===c)return!1;if(g(a),c){var h=a.minPixelValue||0,i=a.maxPixelValue||255;a.restore=e(a);var j=b.createLookupTable();j.setTableRange(h,i),Object(k["default"])(a,j);var l=d(a.getPixelData());a.minPixelValue=l.minPixelValue,a.maxPixelValue=l.maxPixelValue,a.windowWidth=255,a.windowCenter=128,a.colormapId=c}return!0}function i(a,b){var c=Object(j.getEnabledElement)(a);return h(c.image,b)}c.r(b),c.d(b,"convertImageToFalseColorImage",function(){return h}),c.d(b,"convertToFalseColorImage",function(){return i}),c.d(b,"restoreImage",function(){return g});var j=c("./enabledElements.js"),k=c("./pixelDataToFalseColorData.js"),l=c("./colors/colormap.js")},"./fitToWindow.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./updateImage.js"),f=c("./internal/getImageFitScale.js");b["default"]=function(a){var b=Object(d.getEnabledElement)(a),c=b.image;b.viewport.scale=Object(f["default"])(b.canvas,c,b.viewport.rotation).scaleFactor,b.viewport.translation.x=0,b.viewport.translation.y=0,Object(e["default"])(a)}},"./generateUUID.js":function(a,b,c){"use strict";c.r(b),b["default"]=function(){var a=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(a+=performance.now()),"x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===b?c:3&c|8).toString(16)})}},"./getDefaultViewportForImage.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/getDefaultViewport.js");b["default"]=function(a,b){var c=Object(d.getEnabledElement)(a);return Object(e["default"])(c.canvas,b)}},"./getImage.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js");b["default"]=function(a){var b=Object(d.getEnabledElement)(a);return b.image}},"./getPixels.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./getStoredPixels.js"),f=c("./internal/getModalityLUT.js");b["default"]=function(a,b,c,g,h){var i=Object(e["default"])(a,b,c,g,h),j=Object(d.getEnabledElement)(a),k=Object(f["default"])(j.image.slope,j.image.intercept,j.viewport.modalityLUT);return i.map(k)}},"./getStoredPixels.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js");b["default"]=function(a,b,c,e,f){if(void 0===a)throw new Error("getStoredPixels: parameter element must not be undefined");b=Math.round(b),c=Math.round(c);for(var g=Object(d.getEnabledElement)(a),h=[],i=0,j=g.image.getPixelData(),k=0;k<f;k++)for(var l=0;l<e;l++){var m=(k+c)*g.image.columns+(l+b);h[i++]=j[m]}return h}},"./getViewport.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js");b["default"]=function(a){var b=Object(d.getEnabledElement)(a),c=b.viewport;if(void 0!==c)return Object.assign({},c)}},"./imageCache.js":function(a,b,c){"use strict";function d(a){if(void 0===a)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===a.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");o=a,Object(n["default"])(m.events,m["default"].IMAGE_CACHE_MAXIMUM_SIZE_CHANGED),e()}function e(){function a(a,b){return a.timeStamp>b.timeStamp?-1:a.timeStamp<b.timeStamp?1:0}if(!(p<=o)){for(r.sort(a);p>o;){var b=r[r.length-1],c=b.imageId;h(c),Object(n["default"])(m.events,m["default"].IMAGE_CACHE_PROMISE_REMOVED,{imageId:c})}var d=i();Object(n["default"])(m.events,m["default"].IMAGE_CACHE_FULL,d)}}function f(a,b){if(void 0===a)throw new Error("putImageLoadObject: imageId must not be undefined");if(void 0===b.promise)throw new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");if(q.hasOwnProperty(a)===!0)throw new Error("putImageLoadObject: imageId already in cache");if(b.cancelFn&&"function"!=typeof b.cancelFn)throw new Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");var c={loaded:!1,imageId:a,sharedCacheKey:void 0,imageLoadObject:b,timeStamp:Date.now(),sizeInBytes:0};q[a]=c,r.push(c),b.promise.then(function(a){if(r.indexOf(c)!==-1){if(c.loaded=!0,c.image=a,void 0===a.sizeInBytes)throw new Error("putImageLoadObject: image.sizeInBytes must not be undefined");if(void 0===a.sizeInBytes.toFixed)throw new Error("putImageLoadObject: image.sizeInBytes is not a number");c.sizeInBytes=a.sizeInBytes,p+=c.sizeInBytes;var b={action:"addImage",image:c};Object(n["default"])(m.events,m["default"].IMAGE_CACHE_CHANGED,b),c.sharedCacheKey=a.sharedCacheKey,e()}},function(){var b=q[a];r.splice(r.indexOf(b),1),delete q[a]})}function g(a){if(void 0===a)throw new Error("getImageLoadObject: imageId must not be undefined");var b=q[a];if(void 0!==b)return b.timeStamp=Date.now(),b.imageLoadObject}function h(a){if(void 0===a)throw new Error("removeImageLoadObject: imageId must not be undefined");var b=q[a];if(void 0===b)throw new Error("removeImageLoadObject: imageId was not present in imageCache");r.splice(r.indexOf(b),1),p-=b.sizeInBytes;var c={action:"deleteImage",image:b};Object(n["default"])(m.events,m["default"].IMAGE_CACHE_CHANGED,c),j(b.imageLoadObject),delete q[a]}function i(){return{maximumSizeInBytes:o,cacheSizeInBytes:p,numberOfImagesCached:r.length}}function j(a){a.promise.then(function(){a.decache&&a.decache()},function(){a.decache&&a.decache()})}function k(){for(;r.length>0;){var a=r[0];h(a.imageId)}}function l(a,b){var c=q[a];c&&c.imageLoadObject.promise.then(function(a){var d=b-a.sizeInBytes;a.sizeInBytes=b,c.sizeInBytes=b,p+=d;var e={action:"changeImageSize",image:a};Object(n["default"])(m.events,m["default"].IMAGE_CACHE_CHANGED,e)})}c.r(b),c.d(b,"cachedImages",function(){return r}),c.d(b,"setMaximumSizeBytes",function(){return d}),c.d(b,"putImageLoadObject",function(){return f}),c.d(b,"getImageLoadObject",function(){return g}),c.d(b,"removeImageLoadObject",function(){return h}),c.d(b,"getCacheInfo",function(){return i}),c.d(b,"purgeCache",function(){return k}),c.d(b,"changeImageIdCacheSize",function(){return l});var m=c("./events.js"),n=c("./triggerEvent.js"),o=1073741824,p=0,q={},r=[];b["default"]={imageCache:q,cachedImages:r,setMaximumSizeBytes:d,putImageLoadObject:f,getImageLoadObject:g,removeImageLoadObject:h,getCacheInfo:i,purgeCache:k,changeImageIdCacheSize:l}},"./imageLoader.js":function(a,b,c){"use strict";function d(a,b){var c=a.indexOf(":"),d=a.substring(0,c),e=o[d];if(void 0===e||null===e){if(void 0!==k)return k(a);throw new Error("loadImageFromImageLoader: no image loader for imageId")}var f=e(a,b);return f.promise.then(function(a){Object(n["default"])(m.events,m["default"].IMAGE_LOADED,{image:a})},function(b){var c={imageId:a,error:b};Object(n["default"])(m.events,m["default"].IMAGE_LOAD_FAILED,c)}),f}function e(a,b){var c=a.indexOf(":"),d=(a.substring(0,c),o.byteArray);if(void 0===d||null===d){if(void 0!==k)return k(a);throw new Error("loadImageFromImageLoader: no image loader for imageId")}var e=d(a,b);return e.promise.then(function(a){Object(n["default"])(m.events,m["default"].IMAGE_LOADED,{image:a})},function(b){var c={imageId:a,error:b};Object(n["default"])(m.events,m["default"].IMAGE_LOAD_FAILED,c)}),e}function f(a,b){if(void 0===a)throw new Error("loadImage: parameter imageId must not be undefined");var c=Object(l.getImageLoadObject)(a);return void 0!==c?c.promise:d(a,b).promise}function g(a,b){if(void 0===a)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");var c=Object(l.getImageLoadObject)(a);return void 0!==c?c.promise:(c=d(a,b),Object(l.putImageLoadObject)(a,c),c.promise)}function h(a,b){if(void 0===a)throw new Error("loadDatasetImage: parameter imageId must not be undefined");var c=Object(l.getImageLoadObject)(a);return void 0!==c?c.promise:(c=e(a,b),Object(l.putImageLoadObject)(a,c),c.promise)}function i(a,b){o[a]=b}function j(a){var b=k;return k=a,b}c.r(b),c.d(b,"loadImage",function(){return f}),c.d(b,"loadAndCacheImage",function(){return g}),c.d(b,"loadByteArrayImage",function(){return h}),c.d(b,"registerImageLoader",function(){return i}),c.d(b,"registerUnknownImageLoader",function(){return j});var k,l=c("./imageCache.js"),m=c("./events.js"),n=c("./triggerEvent.js"),o={}},"./index.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/drawImage.js");c.d(b,"drawImage",function(){return d["default"]});var e=c("./internal/generateLut.js");c.d(b,"generateLut",function(){return e["default"]});var f=c("./internal/getDefaultViewport.js");c.d(b,"getDefaultViewport",function(){return f["default"]});var g=c("./internal/requestAnimationFrame.js");c.d(b,"requestAnimationFrame",function(){return g["default"]});var h=c("./internal/storedPixelDataToCanvasImageData.js");c.d(b,"storedPixelDataToCanvasImageData",function(){return h["default"]});var i=c("./internal/storedColorPixelDataToCanvasImageData.js");c.d(b,"storedColorPixelDataToCanvasImageData",function(){return i["default"]});var j=c("./internal/storedPixelDataToCanvasImageDataColorLUT.js");c.d(b,"storedPixelDataToCanvasImageDataColorLUT",function(){return j["default"]});var k=c("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js");c.d(b,"storedPixelDataToCanvasImageDataPseudocolorLUT",function(){return k["default"]});var l=c("./internal/index.js");c.d(b,"internal",function(){return l["default"]});var m=c("./rendering/renderLabelMapImage.js");c.d(b,"renderLabelMapImage",function(){return m.renderLabelMapImage});var n=c("./rendering/renderPseudoColorImage.js");c.d(b,"renderPseudoColorImage",function(){return n.renderPseudoColorImage});var o=c("./rendering/renderColorImage.js");c.d(b,"renderColorImage",function(){return o.renderColorImage});var p=c("./rendering/renderGrayscaleImage.js");c.d(b,"renderGrayscaleImage",function(){return p.renderGrayscaleImage});var q=c("./rendering/renderWebImage.js");c.d(b,"renderWebImage",function(){return q.renderWebImage});var r=c("./rendering/renderToCanvas.js");c.d(b,"renderToCanvas",function(){return r["default"]});var s=c("./canvasToPixel.js");c.d(b,"canvasToPixel",function(){return s["default"]});var t=c("./disable.js");c.d(b,"disable",function(){return t["default"]});var u=c("./displayImage.js");c.d(b,"displayImage",function(){return u["default"]});var v=c("./displayImageDraw.js");c.d(b,"displayImageDraw",function(){return v["default"]});var w=c("./draw.js");c.d(b,"draw",function(){return w["default"]});var x=c("./drawInvalidated.js");c.d(b,"drawInvalidated",function(){return x["default"]});var y=c("./enable.js");c.d(b,"enable",function(){return y["default"]});var z=c("./enabledElementData.js");c.d(b,"getElementData",function(){return z.getElementData}),c.d(b,"removeElementData",function(){return z.removeElementData});var A=c("./enabledElements.js");c.d(b,"getEnabledElement",function(){return A.getEnabledElement}),c.d(b,"addEnabledElement",function(){return A.addEnabledElement}),c.d(b,"getEnabledElementsByImageId",function(){return A.getEnabledElementsByImageId}),c.d(b,"getEnabledElements",function(){return A.getEnabledElements});var B=c("./layers.js");c.d(b,"addLayer",function(){return B.addLayer}),c.d(b,"removeLayer",function(){return B.removeLayer}),c.d(b,"getLayer",function(){return B.getLayer}),c.d(b,"getLayers",function(){return B.getLayers}),c.d(b,"getVisibleLayers",function(){return B.getVisibleLayers}),c.d(b,"setActiveLayer",function(){return B.setActiveLayer}),c.d(b,"getActiveLayer",function(){return B.getActiveLayer}),c.d(b,"purgeLayers",function(){return B.purgeLayers}),c.d(b,"setLayerImage",function(){return B.setLayerImage});var C=c("./fitToWindow.js");c.d(b,"fitToWindow",function(){return C["default"]});var D=c("./getDefaultViewportForImage.js");c.d(b,"getDefaultViewportForImage",function(){return D["default"]});var E=c("./getImage.js");c.d(b,"getImage",function(){return E["default"]});var F=c("./getPixels.js");c.d(b,"getPixels",function(){return F["default"]});var G=c("./getStoredPixels.js");c.d(b,"getStoredPixels",function(){return G["default"]});var H=c("./getViewport.js");c.d(b,"getViewport",function(){return H["default"]});var I=c("./imageLoader.js");c.d(b,"loadImage",function(){return I.loadImage}),c.d(b,"loadAndCacheImage",function(){return I.loadAndCacheImage}),c.d(b,"loadByteArrayImage",function(){return I.loadByteArrayImage}),c.d(b,"registerImageLoader",function(){return I.registerImageLoader}),c.d(b,"registerUnknownImageLoader",function(){return I.registerUnknownImageLoader});var J=c("./invalidate.js");c.d(b,"invalidate",function(){return J["default"]});var K=c("./invalidateImageId.js");c.d(b,"invalidateImageId",function(){return K["default"]});var L=c("./pageToPixel.js");c.d(b,"pageToPixel",function(){return L["default"]});var M=c("./pixelToCanvas.js");c.d(b,"pixelToCanvas",function(){return M["default"]});var N=c("./reset.js");c.d(b,"reset",function(){return N["default"]});var O=c("./resize.js");c.d(b,"resize",function(){return O["default"]});var P=c("./setToPixelCoordinateSystem.js");c.d(b,"setToPixelCoordinateSystem",function(){return P["default"]});var Q=c("./setViewport.js");c.d(b,"setViewport",function(){return Q["default"]});var R=c("./updateImage.js");c.d(b,"updateImage",function(){return R["default"]});var S=c("./pixelDataToFalseColorData.js");c.d(b,"pixelDataToFalseColorData",function(){return S["default"]});var T=c("./rendering/index.js");c.d(b,"rendering",function(){return T["default"]});var U=c("./imageCache.js");c.d(b,"imageCache",function(){return U["default"]});var V=c("./metaData.js");
c.d(b,"metaData",function(){return V["default"]});var W=c("./webgl/index.js");c.d(b,"webGL",function(){return W["default"]});var X=c("./colors/index.js");c.d(b,"colors",function(){return X["default"]});var Y=c("./falseColorMapping.js");c.d(b,"convertImageToFalseColorImage",function(){return Y.convertImageToFalseColorImage}),c.d(b,"convertToFalseColorImage",function(){return Y.convertToFalseColorImage}),c.d(b,"restoreImage",function(){return Y.restoreImage});var Z=c("./events.js");c.d(b,"EVENTS",function(){return Z["default"]}),c.d(b,"events",function(){return Z.events});var $=c("./triggerEvent.js");c.d(b,"triggerEvent",function(){return $["default"]})},"./internal/calculateTransform.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/transform.js");b["default"]=function(a,b){var c=new d.Transform;c.translate(a.canvas.width/2,a.canvas.height/2);var e=a.viewport.rotation;0!==e&&c.rotate(e*Math.PI/180);var f=a.viewport.scale,g=a.viewport.scale,h=a.viewport.displayedArea.brhc.x-(a.viewport.displayedArea.tlhc.x-1),i=a.viewport.displayedArea.brhc.y-(a.viewport.displayedArea.tlhc.y-1);if("NONE"===a.viewport.displayedArea.presentationSizeMode)a.image.rowPixelSpacing<a.image.columnPixelSpacing?f*=a.image.columnPixelSpacing/a.image.rowPixelSpacing:a.image.columnPixelSpacing<a.image.rowPixelSpacing&&(g*=a.image.rowPixelSpacing/a.image.columnPixelSpacing);else if(f=a.viewport.displayedArea.columnPixelSpacing,g=a.viewport.displayedArea.rowPixelSpacing,"SCALE TO FIT"===a.viewport.displayedArea.presentationSizeMode){var j=a.canvas.height/(i*g),k=a.canvas.width/(h*f);f=g=Math.min(k,j),a.viewport.displayedArea.rowPixelSpacing<a.viewport.displayedArea.columnPixelSpacing?f*=a.viewport.displayedArea.columnPixelSpacing/a.viewport.displayedArea.rowPixelSpacing:a.viewport.displayedArea.columnPixelSpacing<a.viewport.displayedArea.rowPixelSpacing&&(g*=a.viewport.displayedArea.rowPixelSpacing/a.viewport.displayedArea.columnPixelSpacing)}return c.scale(f,g),0!==e&&c.rotate(-e*Math.PI/180),c.translate(a.viewport.translation.x,a.viewport.translation.y),0!==e&&c.rotate(e*Math.PI/180),void 0!==b&&c.scale(b,b),a.viewport.hflip&&c.scale(-1,1),a.viewport.vflip&&c.scale(1,-1),c.translate(-h/2,-i/2),c}},"./internal/computeAutoVoi.js":function(a,b,c){"use strict";function d(a,b){if(!e(a)){var c=b.maxPixelValue*b.slope+b.intercept,d=b.minPixelValue*b.slope+b.intercept,f=c-d,g=(c+d)/2;void 0===a.voi?a.voi={windowWidth:f,windowCenter:g}:(a.voi.windowWidth=f,a.voi.windowCenter=g)}}function e(a){var b=a.voiLUT&&a.voiLUT.lut&&a.voiLUT.lut.length>0;return b||void 0!==a.voi.windowWidth&&void 0!==a.voi.windowCenter}c.r(b),c.d(b,"default",function(){return d})},"./internal/drawCompositeImage.js":function(a,b,c){"use strict";function d(a,b){return a.syncProps||e(a),b.syncProps||e(b),b.syncProps.originalScale/a.syncProps.originalScale}function e(a){var b=a.syncProps||{};b.originalScale=a.viewport.scale,a.syncProps=b}function f(a,b){a.forEach(function(a){if(a!==b&&a.viewport&&b.viewport){a.syncProps||e(a);var c=d(b,a);a.viewport.scale=b.viewport.scale*c,a.viewport.rotation=b.viewport.rotation,a.viewport.translation={x:b.viewport.translation.x/c,y:b.viewport.translation.y/c},a.viewport.hflip=b.viewport.hflip,a.viewport.vflip=b.viewport.vflip}})}function g(a,b,c){b.forEach(function(b,d){if(b.image){a.save(),b.canvas=a.canvas,Object(m["default"])(b,a);var e=b.viewport.colormap||b.options.colormap,f=b.viewport.labelmap,g=b.invalid||c;if(e&&""!==e&&f===!0)Object(l.addLabelMapLayer)(b,g);else if(e&&""!==e)Object(k.addPseudoColorLayer)(b,g);else if(b.image.color===!0)Object(j.addColorLayer)(b,g);else{var h=0===d;Object(i.addGrayscaleLayer)(b,g,h)}b.options&&b.options.opacity?a.globalAlpha=b.options.opacity:a.globalAlpha=1,b.options&&b.options.fillStyle&&(a.fillStyle=b.options.fillStyle),a.imageSmoothingEnabled=!b.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled;var n=b.viewport.displayedArea.tlhc.x-1,o=b.viewport.displayedArea.tlhc.y-1,p=b.viewport.displayedArea.brhc.x-n,q=b.viewport.displayedArea.brhc.y-o;a.drawImage(b.canvas,n,o,p,q,0,0,p,q),a.restore(),b.invalid=!1}})}c.r(b);var h=c("./layers.js"),i=c("./rendering/renderGrayscaleImage.js"),j=c("./rendering/renderColorImage.js"),k=c("./rendering/renderPseudoColorImage.js"),l=c("./rendering/renderLabelMapImage.js"),m=c("./setToPixelCoordinateSystem.js");b["default"]=function(a,b){var c=a.element,d=Object(h.getLayers)(c),i=Object(h.getActiveLayer)(c),j=Object(h.getVisibleLayers)(c),k=!a.lastSyncViewportsState&&a.syncViewports;a.lastSyncViewportsState=a.syncViewports,k&&d.forEach(function(a){a.viewport&&e(a)}),a.syncViewports===!0&&f(j,i);var l=a.canvas.getContext("2d");l.setTransform(1,0,0,1,0,0),l.fillStyle="black",l.fillRect(0,0,a.canvas.width,a.canvas.height),g(l,j,b)}},"./internal/drawImage.js":function(a,b,c){"use strict";c.r(b),b["default"]=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.needsRedraw=!0,b&&(a.invalid=!0)}},"./internal/drawImageSync.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/now.js"),e=c("./internal/drawCompositeImage.js"),f=c("./rendering/renderColorImage.js"),g=c("./rendering/renderGrayscaleImage.js"),h=c("./rendering/renderPseudoColorImage.js"),i=c("./rendering/renderLabelMapImage.js"),j=c("./triggerEvent.js"),k=c("./events.js");b["default"]=function(a,b){var c=a.image,l=a.element,m=a.layers||[];if(a.canvas&&(a.image||m.length)){var n=Object(d["default"])();if(c.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},m&&m.length)Object(e["default"])(a,b);else if(c){var o=c.render;o||(o=a.viewport.colormap&&""!==a.viewport.colormap&&a.image.labelmap===!0?i.renderLabelMapImage:a.viewport.colormap&&""!==a.viewport.colormap?h.renderPseudoColorImage:c.color?f.renderColorImage:g.renderGrayscaleImage),o(a,b)}var p=Object(d["default"])()-n,q={viewport:a.viewport,element:l,image:c,enabledElement:a,canvasContext:a.canvas.getContext("2d"),renderTimeInMs:p};c.stats.lastRenderTime=p,a.invalid=!1,a.needsRedraw=!1,Object(j["default"])(l,k["default"].IMAGE_RENDERED,q)}}},"./internal/generateColorLut.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/getVOILut.js");b["default"]=function(a,b,c,e,f){var g=a.maxPixelValue,h=a.minPixelValue,i=Math.min(h,0);if(void 0===a.cachedLut){var j=g-i+1;a.cachedLut={},a.cachedLut.lutArray=new Uint8ClampedArray(j)}var k=a.cachedLut.lutArray,l=Object(d["default"])(b,c,f);if(e===!0)for(var m=h;m<=g;m++)k[m+-i]=255-l(m);else for(var n=h;n<=g;n++)k[n+-i]=l(n);return k}},"./internal/generateLut.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/getModalityLUT.js"),e=c("./internal/getVOILut.js");b["default"]=function(a,b,c,f,g,h){var i=a.maxPixelValue,j=a.minPixelValue,k=Math.min(j,0);if(void 0===a.cachedLut){var l=i-k+1;a.cachedLut={},a.cachedLut.lutArray=new Uint8ClampedArray(l)}var m=a.cachedLut.lutArray,n=Object(d["default"])(a.slope,a.intercept,g),o=Object(e["default"])(b,c,h);if(f===!0)for(var p=j;p<=i;p++)m[p+-k]=255-o(n(p));else for(var q=j;q<=i;q++)m[q+-k]=o(n(q));return m}},"./internal/getCanvas.js":function(a,b,c){"use strict";function d(a){var b=document.createElement("canvas");return b.style.display="block",b.classList.add(f),a.appendChild(b),b}function e(a){var b="canvas.".concat(f);return a.querySelector(b)||d(a)}c.r(b),c.d(b,"default",function(){return e});var f="cornerstone-canvas"},"./internal/getDefaultViewport.js":function(a,b,c){"use strict";function d(){var a=e();return{scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:a}}function e(){return{tlhc:{x:1,y:1},brhc:{x:1,y:1},rowPixelSpacing:1,columnPixelSpacing:1,presentationSizeMode:"NONE"}}c.r(b);var f=c("./internal/getImageFitScale.js");b["default"]=function(a,b){if(void 0===a)throw new Error("getDefaultViewport: parameter canvas must not be undefined");if(void 0===b)return d();var c=Object(f["default"])(a,b,0).scaleFactor;return{scale:c,translation:{x:0,y:0},voi:{windowWidth:b.windowWidth,windowCenter:b.windowCenter},invert:b.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:b.modalityLUT,voiLUT:b.voiLUT,colormap:b.colormap,labelmap:Boolean(b.labelmap),displayedArea:{tlhc:{x:1,y:1},brhc:{x:b.columns,y:b.rows},rowPixelSpacing:void 0===b.rowPixelSpacing?1:b.rowPixelSpacing,columnPixelSpacing:void 0===b.columnPixelSpacing?1:b.columnPixelSpacing,presentationSizeMode:"NONE"}}}},"./internal/getImageFitScale.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/validator.js"),e=c("./internal/getImageSize.js");b["default"]=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(d.validateParameterUndefinedOrNull)(a,"getImageScale: parameter windowSize must not be undefined"),Object(d.validateParameterUndefinedOrNull)(b,"getImageScale: parameter image must not be undefined");var f=Object(e["default"])(b,c),g=b.rowPixelSpacing||1,h=b.columnPixelSpacing||1,i=1,j=1;g<h?j=h/g:i=g/h;var k=a.height/f.height/i,l=a.width/f.width/j;return{verticalScale:k,horizontalScale:l,scaleFactor:Math.min(l,k)}}},"./internal/getImageSize.js":function(a,b,c){"use strict";function d(a){return!(null===a||void 0===a||0===a||180===a)}c.r(b);var e=c("./internal/validator.js");b["default"]=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(e.validateParameterUndefinedOrNull)(a,"getImageSize: parameter image must not be undefined"),Object(e.validateParameterUndefinedOrNull)(a.width,"getImageSize: parameter image must have width"),Object(e.validateParameterUndefinedOrNull)(a.height,"getImageSize: parameter image must have height"),d(b)?{height:a.width,width:a.height}:{width:a.width,height:a.height}}},"./internal/getModalityLUT.js":function(a,b,c){"use strict";function d(a,b){return function(c){return c*a+b}}function e(a){var b=a.lut[0],c=a.lut[a.lut.length-1],d=a.firstValueMapped+a.lut.length;return function(e){return e<a.firstValueMapped?b:e>=d?c:a.lut[e]}}c.r(b),b["default"]=function(a,b,c){return c?e(c):d(a,b)}},"./internal/getTransform.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/calculateTransform.js");b["default"]=function(a){return Object(d["default"])(a)}},"./internal/getVOILut.js":function(a,b,c){"use strict";function d(a){return g(a)||f(a)||e()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function g(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function h(a,b){return function(c){return 255*((c-b)/a+.5)}}function i(a){var b=Math.max.apply(Math,d(a.lut)).toString(2).length,c=b-8,e=a.lut[0]>>c,f=a.lut[a.lut.length-1]>>c,g=a.firstValueMapped+a.lut.length-1;return function(b){return b<a.firstValueMapped?e:b>=g?f:a.lut[b-a.firstValueMapped]>>c}}c.r(b),b["default"]=function(a,b,c){return c?i(c):h(a,b)}},"./internal/guid.js":function(a,b,c){"use strict";function d(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}c.r(b),b["default"]=function(){return"".concat(d()+d(),"-").concat(d(),"-").concat(d(),"-").concat(d(),"-").concat(d()).concat(d()).concat(d())}},"./internal/index.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/drawImage.js"),e=c("./internal/generateLut.js"),f=c("./internal/getDefaultViewport.js"),g=c("./internal/requestAnimationFrame.js"),h=c("./internal/storedPixelDataToCanvasImageData.js"),i=c("./internal/storedPixelDataToCanvasImageDataRGBA.js"),j=c("./internal/storedColorPixelDataToCanvasImageData.js"),k=c("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),l=c("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),m=c("./internal/getTransform.js"),n=c("./internal/calculateTransform.js"),o=c("./internal/transform.js");b["default"]={drawImage:d["default"],generateLut:e["default"],getDefaultViewport:f["default"],requestAnimationFrame:g["default"],storedPixelDataToCanvasImageData:h["default"],storedPixelDataToCanvasImageDataRGBA:i["default"],storedPixelDataToCanvasImageDataColorLUT:k["default"],storedPixelDataToCanvasImageDataPseudocolorLUT:l["default"],storedColorPixelDataToCanvasImageData:j["default"],getTransform:m["default"],calculateTransform:n["default"],Transform:o.Transform}},"./internal/now.js":function(a,b,c){"use strict";c.r(b),b["default"]=function(){return window.performance?performance.now():Date.now()}},"./internal/requestAnimationFrame.js":function(a,b,c){"use strict";function d(a){window.setTimeout(a,1e3/60)}c.r(b),b["default"]=function(a){return window.requestAnimationFrame(a)||window.webkitRequestAnimationFrame(a)||window.mozRequestAnimationFrame(a)||window.oRequestAnimationFrame(a)||window.msRequestAnimationFrame(a)||d(a)}},"./internal/storedColorPixelDataToCanvasImageData.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/now.js");b["default"]=function(a,b,c){var e=Object(d["default"])(),f=a.getPixelData();a.stats.lastGetPixelDataTime=Object(d["default"])()-e;var g=a.minPixelValue,h=0,i=0,j=f.length;if(e=Object(d["default"])(),g<0)for(;i<j;)c[h++]=b[f[i++]+-g],c[h++]=b[f[i++]+-g],c[h]=b[f[i]+-g],i+=2,h+=2;else for(;i<j;)c[h++]=b[f[i++]],c[h++]=b[f[i++]],c[h]=b[f[i]],i+=2,h+=2;a.stats.lastStoredPixelDataToCanvasImageDataTime=Object(d["default"])()-e}},"./internal/storedPixelDataToCanvasImageData.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/now.js");b["default"]=function(a,b,c){var e=Object(d["default"])(),f=a.getPixelData();a.stats.lastGetPixelDataTime=Object(d["default"])()-e;var g=f.length,h=a.minPixelValue,i=3,j=0;if(e=Object(d["default"])(),f instanceof Int16Array)if(h<0)for(;j<g;)c[i]=b[f[j++]+-h],i+=4;else for(;j<g;)c[i]=b[f[j++]],i+=4;else if(f instanceof Uint16Array)for(;j<g;)c[i]=b[f[j++]],i+=4;else if(h<0)for(;j<g;)c[i]=b[f[j++]+-h],i+=4;else for(;j<g;)c[i]=b[f[j++]],i+=4;a.stats.lastStoredPixelDataToCanvasImageDataTime=Object(d["default"])()-e}},"./internal/storedPixelDataToCanvasImageDataColorLUT.js":function(a,b,c){"use strict";function d(a,b,c){var d=Object(f["default"])(),g=a.getPixelData();a.stats.lastGetPixelDataTime=Object(f["default"])()-d;var h,i,j=g.length,k=a.minPixelValue,l=0,m=0;if(d=Object(f["default"])(),i=b instanceof e["default"].LookupTable?b.Table:b,k<0)for(;m<j;)h=i[g[m++]+-k],c[l++]=h[0],c[l++]=h[1],c[l++]=h[2],c[l++]=h[3];else for(;m<j;)h=i[g[m++]],c[l++]=h[0],c[l++]=h[1],c[l++]=h[2],c[l++]=h[3];a.stats.lastStoredPixelDataToCanvasImageDataTime=Object(f["default"])()-d}c.r(b);var e=c("./colors/index.js"),f=c("./internal/now.js");b["default"]=d},"./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js":function(a,b,c){"use strict";function d(a,b,c,d){var g=Object(f["default"])(),h=a.getPixelData();a.stats.lastGetPixelDataTime=Object(f["default"])()-g;var i,j,k,l=h.length,m=a.minPixelValue,n=0,o=0;if(g=Object(f["default"])(),k=c instanceof e["default"].LookupTable?c.Table:c,m<0)for(;o<l;)i=b[h[o++]+-m],j=k[i],d[n++]=j[0],d[n++]=j[1],d[n++]=j[2],d[n++]=j[3];else for(;o<l;)i=b[h[o++]],j=k[i],d[n++]=j[0],d[n++]=j[1],d[n++]=j[2],d[n++]=j[3];a.stats.lastStoredPixelDataToCanvasImageDataTime=Object(f["default"])()-g}c.r(b);var e=c("./colors/index.js"),f=c("./internal/now.js");b["default"]=d},"./internal/storedPixelDataToCanvasImageDataRGBA.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/now.js");b["default"]=function(a,b,c){var e=Object(d["default"])(),f=a.getPixelData();a.stats.lastGetPixelDataTime=Object(d["default"])()-e;var g,h=f.length,i=a.minPixelValue,j=0,k=0;if(e=Object(d["default"])(),f instanceof Int16Array)if(i<0)for(;k<h;)g=b[f[k++]+-i],c[j++]=g,c[j++]=g,c[j++]=g,c[j++]=255;else for(;k<h;)g=b[f[k++]],c[j++]=g,c[j++]=g,c[j++]=g,c[j++]=255;else if(f instanceof Uint16Array)for(;k<h;)g=b[f[k++]],c[j++]=g,c[j++]=g,c[j++]=g,c[j++]=255;else if(i<0)for(;k<h;)g=b[f[k++]+-i],c[j++]=g,c[j++]=g,c[j++]=g,c[j++]=255;else for(;k<h;)g=b[f[k++]],c[j++]=g,c[j++]=g,c[j++]=g,c[j++]=255;a.stats.lastStoredPixelDataToCanvasImageDataTime=Object(d["default"])()-e}},"./internal/storedRGBAPixelDataToCanvasImageData.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/now.js");b["default"]=function(a,b,c){var e=Object(d["default"])(),f=a.getPixelData();a.stats.lastGetPixelDataTime=Object(d["default"])()-e;var g=a.minPixelValue,h=0,i=0,j=f.length;if(e=Object(d["default"])(),g<0)for(;i<j;)c[h++]=b[f[i++]+-g],c[h++]=b[f[i++]+-g],c[h++]=b[f[i++]+-g],c[h++]=f[i++];else for(;i<j;)c[h++]=b[f[i++]],c[h++]=b[f[i++]],c[h++]=b[f[i++]],c[h++]=f[i++];a.stats.lastStoredPixelDataToCanvasImageDataTime=Object(d["default"])()-e}},"./internal/transform.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}c.r(b),c.d(b,"Transform",function(){return g});var g=function(){function a(){d(this,a),this.reset()}return f(a,[{key:"reset",value:function(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function(){var b=new a;return b.m[0]=this.m[0],b.m[1]=this.m[1],b.m[2]=this.m[2],b.m[3]=this.m[3],b.m[4]=this.m[4],b.m[5]=this.m[5],b}},{key:"multiply",value:function(a){var b=this.m[0]*a.m[0]+this.m[2]*a.m[1],c=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],e=this.m[1]*a.m[2]+this.m[3]*a.m[3],f=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],g=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g}},{key:"invert",value:function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*a,c=-this.m[1]*a,d=-this.m[2]*a,e=this.m[0]*a,f=a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),g=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g}},{key:"rotate",value:function(a){var b=Math.cos(a),c=Math.sin(a),d=this.m[0]*b+this.m[2]*c,e=this.m[1]*b+this.m[3]*c,f=this.m[0]*-c+this.m[2]*b,g=this.m[1]*-c+this.m[3]*b;this.m[0]=d,this.m[1]=e,this.m[2]=f,this.m[3]=g}},{key:"translate",value:function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b,this.m[5]+=this.m[1]*a+this.m[3]*b}},{key:"scale",value:function(a,b){this.m[0]*=a,this.m[1]*=a,this.m[2]*=b,this.m[3]*=b}},{key:"transformPoint",value:function(a,b){var c=a,d=b;return a=c*this.m[0]+d*this.m[2]+this.m[4],b=c*this.m[1]+d*this.m[3]+this.m[5],{x:a,y:b}}}]),a}()},"./internal/tryEnableWebgl.js":function(a,b,c){"use strict";c.r(b);var d=c("./webgl/index.js");b["default"]=function(a){return d["default"].renderer.isWebGLAvailable()?(d["default"].renderer.initRenderer(),a.renderer="webgl",!0):(console.error("WebGL not available, falling back to Canvas renderer"),delete a.renderer,!1)}},"./internal/validator.js":function(a,b,c){"use strict";function d(a,b){if(void 0===a)throw new Error(b)}function e(a,b){if(void 0===a||null===a)throw new Error(b)}c.r(b),c.d(b,"validateParameterUndefined",function(){return d}),c.d(b,"validateParameterUndefinedOrNull",function(){return e})},"./invalidate.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./triggerEvent.js"),f=c("./events.js");b["default"]=function(a){var b=Object(d.getEnabledElement)(a);b.invalid=!0,b.needsRedraw=!0;var c={element:a};Object(e["default"])(a,f["default"].INVALIDATED,c)}},"./invalidateImageId.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/drawImage.js");b["default"]=function(a){var b=Object(d.getEnabledElementsByImageId)(a);b.forEach(function(a){Object(e["default"])(a,!0)})}},"./layers.js":function(a,b,c){"use strict";function d(a,b,c){var d=b.element,e={viewport:b.viewport,element:b.element,image:b.image,enabledElement:b,layerId:c};Object(s["default"])(d,a,e)}function e(a,b){if(a.layerId===b.layerId)throw new Error("rescaleImage: both arguments represent the same layer");var c=a.image,d=b.image;if(c.imageId&&d.imageId){var e=b.viewport.displayedArea.columnPixelSpacing*d.width/(a.viewport.displayedArea.columnPixelSpacing*c.width),f=b.viewport.scale/a.viewport.scale*e;b.viewport.scale=a.viewport.scale*f}}function f(a,b,c){var f,g=Object(o["default"])(),h=Object(p.getEnabledElement)(a),i=h.layers;b&&(f=Object(q["default"])(h.canvas,b),c&&c.viewport&&(f=Object.assign(f,c.viewport))),h.syncViewports!==!1&&(h.syncViewports=!0);var j={image:b,layerId:g,viewport:f,options:c||{},renderingTools:{}};return i.length&&b&&e(i[0],j),i.push(j),d(t["default"].LAYER_ADDED,h,g),1===i.length&&b&&k(a,g),g}function g(a,b){var c=Object(p.getEnabledElement)(a),e=c.layers,f=c.layers.findIndex(function(a){return a.layerId===b});f!==-1&&(e.splice(f,1),b===c.activeLayerId&&e.length&&k(a,e[0].layerId),d(t["default"].LAYER_REMOVED,c,b))}function h(a,b){var c=Object(p.getEnabledElement)(a);return c.layers.find(function(a){return a.layerId===b})}function i(a){var b=Object(p.getEnabledElement)(a);return b.layers}function j(a){var b=Object(p.getEnabledElement)(a);return b.layers.filter(function(a){return a.options&&a.options.visible!==!1&&0!==a.options.opacity})}function k(a,b){var c=Object(p.getEnabledElement)(a);if(c.activeLayerId!==b){var e=c.layers.findIndex(function(a){return a.layerId===b});if(e===-1)throw new Error("setActiveLayer: layer not found in layers array");var f=c.layers[e];if(!f.image)throw new Error("setActiveLayer: layer with undefined image cannot be set as active.");c.activeLayerId=b,c.image=f.image,c.viewport=f.viewport,Object(r["default"])(a),d(t["default"].ACTIVE_LAYER_CHANGED,c,b)}}function l(a,b,c){var d,f=Object(p.getEnabledElement)(a),g=f.layers[0];if(d=c?h(a,c):m(a),!d)throw new Error("setLayerImage: Layer not found");if(d.image=b,!b)return void(d.viewport=void 0);if(!d.viewport){var i=Object(q["default"])(f.canvas,b);d.options&&d.options.viewport&&(d.viewport=Object.assign(i,d.options.viewport)),g.layerId!==c&&e(g,d)}}function m(a){var b=Object(p.getEnabledElement)(a);return b.layers.find(function(a){return a.layerId===b.activeLayerId})}function n(a){var b=Object(p.getEnabledElement)(a);b.layers=[],delete b.activeLayerId,delete b.lastSyncViewportsState}c.r(b),c.d(b,"rescaleImage",function(){return e}),c.d(b,"addLayer",function(){return f}),c.d(b,"removeLayer",function(){return g}),c.d(b,"getLayer",function(){return h}),c.d(b,"getLayers",function(){return i}),c.d(b,"getVisibleLayers",function(){return j}),c.d(b,"setActiveLayer",function(){return k}),c.d(b,"setLayerImage",function(){return l}),c.d(b,"getActiveLayer",function(){return m}),c.d(b,"purgeLayers",function(){return n});var o=c("./internal/guid.js"),p=c("./enabledElements.js"),q=c("./internal/getDefaultViewport.js"),r=c("./updateImage.js"),s=c("./triggerEvent.js"),t=c("./events.js")},"./metaData.js":function(a,b,c){"use strict";function d(a){var b,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(b=0;b<g.length&&!(g[b].priority<=c);b++);g.splice(b,0,{priority:c,provider:a})}function e(a){for(var b=0;b<g.length;b++)if(g[b].provider===a){g.splice(b,1);break}}function f(a,b){for(var c=0;c<g.length;c++){var d=g[c].provider(a,b);if(void 0!==d)return d}}c.r(b),c.d(b,"addProvider",function(){return d}),c.d(b,"removeProvider",function(){return e});var g=[];b["default"]={addProvider:d,removeProvider:e,get:f}},"./pageToPixel.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/getTransform.js");b["default"]=function(a,b,c){var f=Object(d.getEnabledElement)(a);if(void 0===f.image)throw new Error("image has not been loaded yet");var g=a.getBoundingClientRect(),h=b-g.left-window.pageXOffset,i=c-g.top-window.pageYOffset,j={x:h,y:i},k=Object(e["default"])(f);return k.invert(),k.transformPoint(j.x,j.y)}},"./pixelDataToFalseColorData.js":function(a,b,c){"use strict";function d(a,b){if(a.color&&!a.falseColor)throw new Error("Color transforms are not implemented yet");var c,d,f=a.minPixelValue,g=0,h=0,i=a.width*a.height,j=a.origPixelData||a.getPixelData(),k=new Uint8Array(4*i);if(a.color=!0,a.falseColor=!0,a.origPixelData=j,b instanceof e["default"].LookupTable)for(b.build();h<i;)c=j[h++],d=b.mapValue(c),k[g++]=d[0],k[g++]=d[1],k[g++]=d[2],k[g++]=d[3];else if(f<0)for(;h<i;)c=j[h++],k[g++]=b[c+-f][0],k[g++]=b[c+-f][1],k[g++]=b[c+-f][2],k[g++]=b[c+-f][3];else for(;h<i;)c=j[h++],k[g++]=b[c][0],k[g++]=b[c][1],k[g++]=b[c][2],k[g++]=b[c][3];a.rgba=!0,a.cachedLut=void 0,a.render=void 0,a.slope=1,a.intercept=0,a.minPixelValue=0,a.maxPixelValue=255,a.windowWidth=255,a.windowCenter=128,a.getPixelData=function(){return k}}c.r(b),c.d(b,"default",function(){return d});var e=c("./colors/index.js")},"./pixelToCanvas.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/getTransform.js");b["default"]=function(a,b){var c=Object(d.getEnabledElement)(a),f=Object(e["default"])(c);return f.transformPoint(b.x,b.y)}},"./rendering/doesImageNeedToBeRendered.js":function(a,b,c){"use strict";c.r(b),b["default"]=function(a,b){var c=a.renderingTools.lastRenderedImageId,d=a.renderingTools.lastRenderedViewport;return b.imageId!==c||!d||d.windowCenter!==a.viewport.voi.windowCenter||d.windowWidth!==a.viewport.voi.windowWidth||d.invert!==a.viewport.invert||d.rotation!==a.viewport.rotation||d.hflip!==a.viewport.hflip||d.vflip!==a.viewport.vflip||d.modalityLUT!==a.viewport.modalityLUT||d.voiLUT!==a.viewport.voiLUT||d.colormap!==a.viewport.colormap}},"./rendering/getLut.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/computeAutoVoi.js"),e=c("./rendering/lutMatches.js"),f=c("./internal/generateLut.js");b["default"]=function(a,b,c){return void 0!==a.cachedLut&&a.cachedLut.windowCenter===b.voi.windowCenter&&a.cachedLut.windowWidth===b.voi.windowWidth&&Object(e["default"])(a.cachedLut.modalityLUT,b.modalityLUT)&&Object(e["default"])(a.cachedLut.voiLUT,b.voiLUT)&&a.cachedLut.invert===b.invert&&c!==!0?a.cachedLut.lutArray:(Object(d["default"])(b,a),Object(f["default"])(a,b.voi.windowWidth,b.voi.windowCenter,b.invert,b.modalityLUT,b.voiLUT),a.cachedLut.windowWidth=b.voi.windowWidth,a.cachedLut.windowCenter=b.voi.windowCenter,a.cachedLut.invert=b.invert,a.cachedLut.voiLUT=b.voiLUT,a.cachedLut.modalityLUT=b.modalityLUT,a.cachedLut.lutArray)}},"./rendering/index.js":function(a,b,c){"use strict";c.r(b);var d=c("./rendering/renderColorImage.js"),e=c("./rendering/renderGrayscaleImage.js"),f=c("./rendering/renderWebImage.js"),g=c("./rendering/renderPseudoColorImage.js"),h=c("./rendering/renderLabelMapImage.js"),i=c("./rendering/renderToCanvas.js");b["default"]={colorImage:d.renderColorImage,grayscaleImage:e.renderGrayscaleImage,webImage:f.renderWebImage,pseudoColorImage:g.renderPseudoColorImage,labelMapImage:h.renderLabelMapImage,toCanvas:i["default"]}},"./rendering/initializeRenderCanvas.js":function(a,b,c){"use strict";c.r(b),b["default"]=function(a,b){var c=a.renderingTools.renderCanvas;c.width=b.width,c.height=b.height;var d=c.getContext("2d");d.fillStyle="white",d.fillRect(0,0,c.width,c.height);var e=d.getImageData(0,0,b.width,b.height);a.renderingTools.renderCanvasContext=d,a.renderingTools.renderCanvasData=e}},"./rendering/lutMatches.js":function(a,b,c){"use strict";c.r(b),b["default"]=function(a,b){return!a&&!b||!(!a||!b)&&a.id===b.id}},"./rendering/renderColorImage.js":function(a,b,c){"use strict";function d(a,b){return void 0!==a.cachedLut&&a.cachedLut.windowCenter===b.voi.windowCenter&&a.cachedLut.windowWidth===b.voi.windowWidth&&a.cachedLut.invert===b.invert?a.cachedLut.lutArray:(Object(i["default"])(a,b.voi.windowWidth,b.voi.windowCenter,b.invert),a.cachedLut.windowWidth=b.voi.windowWidth,a.cachedLut.windowCenter=b.voi.windowCenter,a.cachedLut.invert=b.invert,a.cachedLut.lutArray)}function e(a,b,c){var e=a.renderingTools.lastRenderedIsColor===!0;a.renderingTools.renderCanvas&&e||(a.renderingTools.renderCanvas=document.createElement("canvas"));var f=a.renderingTools.renderCanvas;if(255===a.viewport.voi.windowWidth&&128===a.viewport.voi.windowCenter&&a.viewport.invert===!1&&b.getCanvas&&b.getCanvas())return b.getCanvas();if(Object(n["default"])(a,b)===!1&&c!==!0)return f;f.width===b.width&&f.height===b.height||Object(o["default"])(a,b);var g=Object(h["default"])(),i=d(b,a.viewport);b.stats=b.stats||{},b.stats.lastLutGenerateTime=Object(h["default"])()-g;var l=a.renderingTools.renderCanvasData,m=a.renderingTools.renderCanvasContext;return b.rgba?Object(k["default"])(b,i,l.data):Object(j["default"])(b,i,l.data),g=Object(h["default"])(),m.putImageData(l,0,0),b.stats.lastPutImageDataTime=Object(h["default"])()-g,f}function f(a,b){if(void 0===a)throw new Error("renderColorImage: enabledElement parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("renderColorImage: image must be loaded before it can be drawn");var d=a.canvas.getContext("2d");d.setTransform(1,0,0,1,0,0),d.fillStyle="black",d.fillRect(0,0,a.canvas.width,a.canvas.height),d.imageSmoothingEnabled=!a.viewport.pixelReplication,d.mozImageSmoothingEnabled=d.imageSmoothingEnabled,Object(l["default"])(a,d);var f;f=a.options&&a.options.renderer&&"webgl"===a.options.renderer.toLowerCase()?m["default"].renderer.render(a):e(a,c,b);var g=a.viewport.displayedArea.tlhc.x-1,h=a.viewport.displayedArea.tlhc.y-1,i=a.viewport.displayedArea.brhc.x-g,j=a.viewport.displayedArea.brhc.y-h;d.drawImage(f,g,h,i,j,0,0,i,j),a.renderingTools=Object(p["default"])(a)}function g(a,b){if(void 0===a)throw new Error("addColorLayer: layer parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("addColorLayer: image must be loaded before it can be drawn");c.rgba=!0,a.canvas=e(a,c,b);var d=a.canvas.getContext("2d");d.imageSmoothingEnabled=!a.viewport.pixelReplication,d.mozImageSmoothingEnabled=d.imageSmoothingEnabled,a.renderingTools=Object(p["default"])(a)}c.r(b),c.d(b,"renderColorImage",function(){return f}),c.d(b,"addColorLayer",function(){return g});var h=c("./internal/now.js"),i=c("./internal/generateColorLut.js"),j=c("./internal/storedColorPixelDataToCanvasImageData.js"),k=c("./internal/storedRGBAPixelDataToCanvasImageData.js"),l=c("./setToPixelCoordinateSystem.js"),m=c("./webgl/index.js"),n=c("./rendering/doesImageNeedToBeRendered.js"),o=c("./rendering/initializeRenderCanvas.js"),p=c("./rendering/saveLastRendered.js")},"./rendering/renderGrayscaleImage.js":function(a,b,c){"use strict";function d(a,b,c){var d=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],e=a.renderingTools.lastRenderedIsColor===!0;a.renderingTools.renderCanvas&&!e||(a.renderingTools.renderCanvas=document.createElement("canvas"),Object(n["default"])(a,b));var f=a.renderingTools.renderCanvas;if(Object(m["default"])(a,b)===!1&&c!==!0)return f;f.width===b.width&&f.height===b.height||Object(n["default"])(a,b);var i=Object(j["default"])(),k=Object(l["default"])(b,a.viewport,c);b.stats=b.stats||{},b.stats.lastLutGenerateTime=Object(j["default"])()-i;var o=a.renderingTools.renderCanvasData,p=a.renderingTools.renderCanvasContext;return d?Object(g["default"])(b,k,o.data):Object(h["default"])(b,k,o.data),i=Object(j["default"])(),p.putImageData(o,0,0),b.stats.lastPutImageDataTime=Object(j["default"])()-i,f}function e(a,b){if(void 0===a)throw new Error("drawImage: enabledElement parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("drawImage: image must be loaded before it can be drawn");var e=a.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),e.fillStyle="black",e.fillRect(0,0,a.canvas.width,a.canvas.height),e.imageSmoothingEnabled=!a.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled,Object(i["default"])(a,e);var f;f=a.options&&a.options.renderer&&"webgl"===a.options.renderer.toLowerCase()?k["default"].renderer.render(a):d(a,c,b);var g=a.viewport.displayedArea.tlhc.x-1,h=a.viewport.displayedArea.tlhc.y-1,j=a.viewport.displayedArea.brhc.x-g,l=a.viewport.displayedArea.brhc.y-h;
e.drawImage(f,g,h,j,l,0,0,j,l),a.renderingTools=Object(o["default"])(a)}function f(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===a)throw new Error("addGrayscaleLayer: layer parameter must not be undefined");var e=a.image;if(void 0===e)throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");a.canvas=d(a,e,b,c);var f=a.canvas.getContext("2d");f.imageSmoothingEnabled=!a.viewport.pixelReplication,f.mozImageSmoothingEnabled=f.imageSmoothingEnabled,a.renderingTools=Object(o["default"])(a)}c.r(b),c.d(b,"renderGrayscaleImage",function(){return e}),c.d(b,"addGrayscaleLayer",function(){return f});var g=c("./internal/storedPixelDataToCanvasImageData.js"),h=c("./internal/storedPixelDataToCanvasImageDataRGBA.js"),i=c("./setToPixelCoordinateSystem.js"),j=c("./internal/now.js"),k=c("./webgl/index.js"),l=c("./rendering/getLut.js"),m=c("./rendering/doesImageNeedToBeRendered.js"),n=c("./rendering/initializeRenderCanvas.js"),o=c("./rendering/saveLastRendered.js")},"./rendering/renderLabelMapImage.js":function(a,b,c){"use strict";function d(a,b,c){a.renderingTools.renderCanvas||(a.renderingTools.renderCanvas=document.createElement("canvas"));var d=a.renderingTools.renderCanvas,e=a.viewport.colormap||a.options.colormap;if(a.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),e&&"string"==typeof e&&(e=m["default"].getColormap(e)),!e)throw new Error("renderLabelMapImage: colormap not found.");var f=e.getId();if(Object(k["default"])(a,b)===!1&&c!==!0&&a.renderingTools.colormapId===f)return d;d.width===b.width&&d.height===b.height||Object(i["default"])(a,b);var g=Object(h["default"])();a.renderingTools.colorLut&&!c&&a.renderingTools.colormapId===f||(a.renderingTools.colorLut=e.createLookupTable(),a.renderingTools.colormapId=f),b.stats=b.stats||{},b.stats.lastLutGenerateTime=Object(h["default"])()-g;var j=a.renderingTools.colorLut,n=a.renderingTools.renderCanvasData,o=a.renderingTools.renderCanvasContext;return Object(l["default"])(b,j,n.data),g=Object(h["default"])(),o.putImageData(n,0,0),b.stats.lastPutImageDataTime=Object(h["default"])()-g,d}function e(a,b){if(void 0===a)throw new Error("renderLabelMapImage: enabledElement parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("renderLabelMapImage: image must be loaded before it can be drawn");var e=a.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),e.fillStyle="black",e.fillRect(0,0,a.canvas.width,a.canvas.height),e.imageSmoothingEnabled=!a.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled,Object(g["default"])(a,e);var f=d(a,c,b),h=a.viewport.displayedArea.tlhc.x-1,i=a.viewport.displayedArea.tlhc.y-1,k=a.viewport.displayedArea.brhc.x-h,l=a.viewport.displayedArea.brhc.y-i;e.drawImage(f,h,i,k,l,0,0,k,l),a.renderingTools=Object(j["default"])(a)}function f(a,b){if(void 0===a)throw new Error("addLabelMapLayer: layer parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("addLabelMapLayer: image must be loaded before it can be drawn");a.canvas=d(a,c,b);var e=a.canvas.getContext("2d");e.imageSmoothingEnabled=!a.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled,a.renderingTools=Object(j["default"])(a)}c.r(b),c.d(b,"renderLabelMapImage",function(){return e}),c.d(b,"addLabelMapLayer",function(){return f});var g=c("./setToPixelCoordinateSystem.js"),h=c("./internal/now.js"),i=c("./rendering/initializeRenderCanvas.js"),j=c("./rendering/saveLastRendered.js"),k=c("./rendering/doesImageNeedToBeRendered.js"),l=c("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),m=c("./colors/index.js")},"./rendering/renderPseudoColorImage.js":function(a,b,c){"use strict";function d(a,b,c){a.renderingTools.renderCanvas||(a.renderingTools.renderCanvas=document.createElement("canvas"));var d=a.renderingTools.renderCanvas,e=a.viewport.colormap||a.options.colormap;if(a.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),e&&"string"==typeof e&&(e=n["default"].getColormap(e)),!e)throw new Error("renderPseudoColorImage: colormap not found.");var f=e.getId();if(Object(l["default"])(a,b)===!1&&c!==!0&&a.renderingTools.colormapId===f)return d;d.width===b.width&&d.height===b.height||Object(i["default"])(a,b);var g=Object(h["default"])();a.renderingTools.colorLut&&!c&&a.renderingTools.colormapId===f||(e.setNumberOfColors(256),a.renderingTools.colorLut=e.createLookupTable(),a.renderingTools.colormapId=f);var k=Object(j["default"])(b,a.viewport,c);b.stats=b.stats||{},b.stats.lastLutGenerateTime=Object(h["default"])()-g;var o=a.renderingTools.colorLut,p=a.renderingTools.renderCanvasData,q=a.renderingTools.renderCanvasContext;return Object(m["default"])(b,k,o,p.data),g=Object(h["default"])(),q.putImageData(p,0,0),b.stats.lastPutImageDataTime=Object(h["default"])()-g,d}function e(a,b){if(void 0===a)throw new Error("drawImage: enabledElement parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("drawImage: image must be loaded before it can be drawn");var e=a.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),e.fillStyle="black",e.fillRect(0,0,a.canvas.width,a.canvas.height),e.imageSmoothingEnabled=!a.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled,Object(g["default"])(a,e);var f=d(a,c,b),h=a.viewport.displayedArea.tlhc.x-1,i=a.viewport.displayedArea.tlhc.y-1,j=a.viewport.displayedArea.brhc.x-h,l=a.viewport.displayedArea.brhc.y-i;e.drawImage(f,h,i,j,l,0,0,j,l),a.renderingTools=Object(k["default"])(a)}function f(a,b){if(void 0===a)throw new Error("addPseudoColorLayer: layer parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("addPseudoColorLayer: image must be loaded before it can be drawn");a.canvas=d(a,c,b);var e=a.canvas.getContext("2d");e.imageSmoothingEnabled=!a.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled,a.renderingTools=Object(k["default"])(a)}c.r(b),c.d(b,"renderPseudoColorImage",function(){return e}),c.d(b,"addPseudoColorLayer",function(){return f});var g=c("./setToPixelCoordinateSystem.js"),h=c("./internal/now.js"),i=c("./rendering/initializeRenderCanvas.js"),j=c("./rendering/getLut.js"),k=c("./rendering/saveLastRendered.js"),l=c("./rendering/doesImageNeedToBeRendered.js"),m=c("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),n=c("./colors/index.js")},"./rendering/renderToCanvas.js":function(a,b,c){"use strict";function d(a,b,c,d){return{element:a,canvas:a,image:b,invalid:!0,needsRedraw:!0,options:c,layers:[],data:{},renderingTools:{},viewport:d}}c.r(b);var e=c("./triggerEvent.js"),f=c("./events.js"),g=c("./internal/drawImageSync.js"),h=c("./internal/getDefaultViewport.js"),i=c("./internal/tryEnableWebgl.js");b["default"]=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===a)throw new Error("renderToCanvas: parameter canvas cannot be undefined");j&&j.renderer&&"webgl"===j.renderer.toLowerCase()&&Object(i["default"])(j);var k=Object(h["default"])(a,b);c&&Object.assign(k,c);var l=d(a,b,j,k),m={enabledElement:l,timestamp:Date.now()};Object(e["default"])(l.element,f["default"].PRE_RENDER,m),Object(g["default"])(l,l.invalid)}},"./rendering/renderWebImage.js":function(a,b,c){"use strict";function d(a,b){if(void 0===a)throw new Error("renderWebImage: enabledElement parameter must not be undefined");var c=a.image;if(void 0===c)throw new Error("renderWebImage: image must be loaded before it can be drawn");if(a.viewport.voi.windowWidth===a.image.windowWidth&&a.viewport.voi.windowCenter===a.image.windowCenter&&a.viewport.invert===!1){var d=a.canvas.getContext("2d");d.setTransform(1,0,0,1,0,0),d.fillStyle="black",d.fillRect(0,0,a.canvas.width,a.canvas.height),d.imageSmoothingEnabled=!a.viewport.pixelReplication,d.mozImageSmoothingEnabled=d.imageSmoothingEnabled,Object(e["default"])(a,d);var g=a.viewport.displayedArea.tlhc.x-1,h=a.viewport.displayedArea.tlhc.y-1,i=a.viewport.displayedArea.brhc.x-g,j=a.viewport.displayedArea.brhc.y-h;d.drawImage(c.getImage(),g,h,i,j,0,0,i,j)}else Object(f.renderColorImage)(a,b)}c.r(b),c.d(b,"renderWebImage",function(){return d});var e=c("./setToPixelCoordinateSystem.js"),f=c("./rendering/renderColorImage.js")},"./rendering/saveLastRendered.js":function(a,b,c){"use strict";c.r(b),b["default"]=function(a){var b=a.image.imageId,c=a.viewport,d=a.image.color;return a.renderingTools.lastRenderedImageId=b,a.renderingTools.lastRenderedIsColor=d,a.renderingTools.lastRenderedViewport={windowCenter:c.voi.windowCenter,windowWidth:c.voi.windowWidth,invert:c.invert,rotation:c.rotation,hflip:c.hflip,vflip:c.vflip,modalityLUT:c.modalityLUT,voiLUT:c.voiLUT,colormap:c.colormap},a.renderingTools}},"./reset.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/getDefaultViewport.js"),f=c("./updateImage.js");b["default"]=function(a){var b=Object(d.getEnabledElement)(a);b.viewport=Object(e["default"])(b.canvas,b.image),Object(f["default"])(a)}},"./resize.js":function(a,b,c){"use strict";function d(a,b){var c=parseInt($(a).width()-1),d=parseInt($(a).height()-1);b.width!==c&&(b.width=c,b.style.width="".concat(c,"px")),b.height!==d&&(b.height=d,b.style.height="".concat(d,"px"))}function e(a,b,c){var d=a.viewport.scale,e=Object(k["default"])(a.image,a.viewport.rotation),f=Math.round(e.width*d),g=Math.round(e.height*d),h=a.viewport.translation.x,i=a.viewport.translation.y;return f===b&&g<=c||f<=b&&g===c&&0===h&&0===i}function f(a,b,c){var d=a.viewport.scale,e=a.canvas.width,f=a.canvas.height,g=e/b,h=f/c,i=Math.sqrt(g*h);a.viewport.scale=i*d}c.r(b);var g=c("./enabledElements.js"),h=c("./fitToWindow.js"),i=c("./updateImage.js"),j=c("./triggerEvent.js"),k=c("./internal/getImageSize.js"),l=c("./events.js");b["default"]=function(a,b){var c=Object(g.getEnabledElement)(a),k=c.canvas.width,m=c.canvas.height;d(a,c.canvas);var n={element:a};Object(j["default"])(a,l["default"].ELEMENT_RESIZED,n),void 0!==c.image&&(b||e(c,k,m)?Object(h["default"])(a):(f(c,k,m),Object(i["default"])(a)))}},"./setToPixelCoordinateSystem.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/calculateTransform.js");b["default"]=function(a,b,c){if(void 0===a)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===b)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");var e=Object(d["default"])(a,c);b.setTransform(e.m[0],e.m[1],e.m[2],e.m[3],e.m[4],e.m[5])}},"./setViewport.js":function(a,b,c){"use strict";c.r(b);var d=c("./internal/getDefaultViewport.js"),e=c("./enabledElements.js"),f=c("./updateImage.js"),g=1e-6,h=1e-4;b["default"]=function(a,b){var c=Object(e.getEnabledElement)(a);if(void 0===c.viewport&&(c.viewport=Object(d["default"])(c.canvas)),b)for(var i in b)null!==b[i]&&(c.viewport[i]=b[i]);c.viewport.voi.windowWidth&&(c.viewport.voi.windowWidth=Math.max(b.voi.windowWidth,g)),c.viewport.scale&&(c.viewport.scale=Math.max(b.scale,h)),c.viewport.rotation%=360,c.viewport.rotation<0&&(c.viewport.rotation+=360),c.image&&Object(f["default"])(a)}},"./triggerEvent.js":function(a,b,c){"use strict";function d(a,b){var c,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?c=new CustomEvent(b,{detail:d,cancelable:!0}):(c=document.createEvent("CustomEvent"),c.initCustomEvent(b,!0,!0,d)),a.dispatchEvent(c)}c.r(b),c.d(b,"default",function(){return d})},"./updateImage.js":function(a,b,c){"use strict";c.r(b);var d=c("./enabledElements.js"),e=c("./internal/drawImage.js");b["default"]=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=Object(d.getEnabledElement)(a);if(void 0===c.image&&!c.layers.length)throw new Error("updateImage: image has not been loaded yet");Object(e["default"])(c,b)}},"./webgl/createProgramFromString.js":function(a,b,c){"use strict";function d(a,b,c){var d=a.createShader(c);a.shaderSource(d,b),a.compileShader(d);var e=a.getShaderParameter(d,a.COMPILE_STATUS);if(!e&&!a.isContextLost()){var f=a.getShaderInfoLog(d);console.error("Could not compile shader:\n".concat(f))}return d}function e(a,b,c){var d=a.createProgram();a.attachShader(d,b),a.attachShader(d,c),a.linkProgram(d);var e=a.getProgramParameter(d,a.LINK_STATUS);if(!e&&!a.isContextLost()){var f=a.getProgramInfoLog(d);console.error("WebGL program filed to link:\n".concat(f))}return d}c.r(b),b["default"]=function(a,b,c){var f=d(a,b,a.VERTEX_SHADER),g=d(a,c,a.FRAGMENT_SHADER);return e(a,f,g)}},"./webgl/index.js":function(a,b,c){"use strict";c.r(b);var d=c("./webgl/renderer.js"),e=c("./webgl/createProgramFromString.js"),f=c("./webgl/textureCache.js"),g={createProgramFromString:e["default"],renderer:{render:d.render,initRenderer:d.initRenderer,getRenderCanvas:d.getRenderCanvas,isWebGLAvailable:d.isWebGLAvailable},textureCache:f["default"]};Object.defineProperty(g,"isWebGLInitialized",{enumerable:!0,configurable:!1,get:function(){return d.isWebGLInitialized}}),b["default"]=g},"./webgl/renderer.js":function(a,b,c){"use strict";function d(){return z}function e(){for(var a in v.shaders){var b=v.shaders[a];b.attributes={},b.uniforms={},b.vert=w.vertexShader,b.program=Object(y["default"])(s,b.vert,b.frag),b.attributes.texCoordLocation=s.getAttribLocation(b.program,"a_texCoord"),s.enableVertexAttribArray(b.attributes.texCoordLocation),b.attributes.positionLocation=s.getAttribLocation(b.program,"a_position"),s.enableVertexAttribArray(b.attributes.positionLocation),b.uniforms.resolutionLocation=s.getUniformLocation(b.program,"u_resolution")}}function f(){A!==!0&&j(z)&&(o(),e(),A=!0)}function g(a,b,c){a.bufferData(a.ARRAY_BUFFER,new Float32Array([b,c,0,c,b,0,0,0]),a.STATIC_DRAW)}function h(a){a.preventDefault(),console.warn("WebGL Context Lost!")}function i(a){a.preventDefault(),A=!1,x["default"].purgeCache(),f()}function j(a){s=null;try{var b={preserveDrawingBuffer:!0};s=a.getContext("webgl",b)||a.getContext("experimental-webgl",b),a.removeEventListener("webglcontextlost",h,!1),a.addEventListener("webglcontextlost",h,!1),a.removeEventListener("webglcontextrestored",i,!1),a.addEventListener("webglcontextrestored",i,!1)}catch(c){throw new Error("Error creating WebGL context")}return s||(console.error("Unable to initialize WebGL. Your browser may not support it."),s=null),s}function k(a){if(a.color)return"rgb";var b=a.getPixelData();return b instanceof Int16Array?"int16":b instanceof Uint16Array?"uint16":b instanceof Int8Array?"int8":"uint8"}function l(a){var b=k(a);return v.shaders.hasOwnProperty(b)?v.shaders[b]:v.shaders.rgb}function m(a){var b={uint8:s.LUMINANCE,int8:s.LUMINANCE_ALPHA,uint16:s.LUMINANCE_ALPHA,int16:s.RGB,rgb:s.RGB},c={int8:1,uint16:2,int16:3,rgb:3},d=k(a),e=b[d],f=s.createTexture();s.bindTexture(s.TEXTURE_2D,f),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.pixelStorei(s.UNPACK_ALIGNMENT,1);var g=v.dataUtilities[d].storedPixelDataToImageData(a,a.width,a.height);s.texImage2D(s.TEXTURE_2D,0,e,a.width,a.height,0,e,s.UNSIGNED_BYTE,g);var h=a.width*a.height*c[d];return{texture:f,sizeInBytes:h}}function n(a){var b=x["default"].getImageTexture(a.imageId);return b||(b=m(a),x["default"].putImageTexture(a,b)),b.texture}function o(){u=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,u),s.bufferData(s.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),s.STATIC_DRAW),t=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,t),s.bufferData(s.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),s.STATIC_DRAW)}function p(a,b,c,d,e){s.clearColor(1,0,0,1),s.viewport(0,0,d,e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.useProgram(a.program),s.bindBuffer(s.ARRAY_BUFFER,t),s.vertexAttribPointer(a.attributes.texCoordLocation,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,u),s.vertexAttribPointer(a.attributes.positionLocation,2,s.FLOAT,!1,0,0);for(var f in b){var h=s.getUniformLocation(a.program,f);if(h){var i=b[f],j=i.type,k=i.value;"i"===j?s.uniform1i(h,k):"f"===j?s.uniform1f(h,k):"2f"===j&&s.uniform2f(h,k[0],k[1])}}g(s,d,e),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,c),s.drawArrays(s.TRIANGLE_STRIP,0,4)}function q(a){var b=a.image;z.width=b.width,z.height=b.height;var c=a.viewport,d=l(b),e=n(b),f={u_resolution:{type:"2f",value:[b.width,b.height]},wc:{type:"f",value:c.voi.windowCenter},ww:{type:"f",value:c.voi.windowWidth},slope:{type:"f",value:b.slope},intercept:{type:"f",value:b.intercept},minPixelValue:{type:"f",value:b.minPixelValue},invert:{type:"i",value:c.invert?1:0}};return p(d,f,e,b.width,b.height),z}function r(){var a={failIfMajorPerformanceCaveat:!0};try{var b=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(b.getContext("webgl",a)||b.getContext("experimental-webgl",a))}catch(c){return!1}}c.r(b),c.d(b,"isWebGLInitialized",function(){return A}),c.d(b,"getRenderCanvas",function(){return d}),c.d(b,"initRenderer",function(){return f}),c.d(b,"render",function(){return q}),c.d(b,"isWebGLAvailable",function(){return r});var s,t,u,v=c("./webgl/shaders/index.js"),w=c("./webgl/vertexShader.js"),x=c("./webgl/textureCache.js"),y=c("./webgl/createProgramFromString.js"),z=document.createElement("canvas"),A=!1},"./webgl/shaders/index.js":function(a,b,c){"use strict";c.r(b),c.d(b,"shaders",function(){return i}),c.d(b,"dataUtilities",function(){return j});var d=c("./webgl/shaders/int16.js"),e=c("./webgl/shaders/int8.js"),f=c("./webgl/shaders/rgb.js"),g=c("./webgl/shaders/uint16.js"),h=c("./webgl/shaders/uint8.js"),i={int16:d.int16Shader,int8:e.int8Shader,rgb:f.rgbShader,uint16:g.uint16Shader,uint8:h.uint8Shader},j={int16:d.int16DataUtilities,int8:e.int8DataUtilities,rgb:f.rgbDataUtilities,uint16:g.uint16DataUtilities,uint8:h.uint8DataUtilities}},"./webgl/shaders/int16.js":function(a,b,c){"use strict";function d(a){for(var b=a.getPixelData(),c=3,d=new Uint8Array(a.width*a.height*c),e=0,f=0;f<b.length;f++){var g=Math.abs(b[f]);d[e++]=255&g,d[e++]=g>>8,d[e++]=b[f]<0?0:1}return d}c.r(b),c.d(b,"int16DataUtilities",function(){return f}),c.d(b,"int16Shader",function(){return e});var e={},f={storedPixelDataToImageData:d};e.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/int8.js":function(a,b,c){"use strict";function d(a){for(var b=a.getPixelData(),c=2,d=new Uint8Array(a.width*a.height*c),e=0,f=0;f<b.length;f++)d[e++]=b[f],d[e++]=b[f]<0?0:1;return d}c.r(b),c.d(b,"int8DataUtilities",function(){return f}),c.d(b,"int8Shader",function(){return e});var e={},f={storedPixelDataToImageData:d};e.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/rgb.js":function(a,b,c){"use strict";function d(a){var b=a.minPixelValue,c=0,d=0,e=a.width*a.height*4,f=a.width*a.height*3,g=a.getPixelData(),h=new Uint8Array(f);if(b<0)for(;d<e;)h[c++]=g[d++]+-b,h[c++]=g[d++]+-b,h[c++]=g[d++]+-b,d+=1;else for(;d<e;)h[c++]=g[d++],h[c++]=g[d++],h[c++]=g[d++],d+=1;return h}c.r(b),c.d(b,"rgbDataUtilities",function(){return f}),c.d(b,"rgbShader",function(){return e});var e={},f={storedPixelDataToImageData:d};e.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}"},"./webgl/shaders/uint16.js":function(a,b,c){"use strict";function d(a){for(var b=a.getPixelData(),c=2,d=new Uint8Array(a.width*a.height*c),e=0,f=0;f<b.length;f++){var g=b[f];d[e++]=255&g,d[e++]=g>>8}return d}c.r(b),c.d(b,"uint16DataUtilities",function(){return f}),c.d(b,"uint16Shader",function(){return e});var e={},f={storedPixelDataToImageData:d};e.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/uint8.js":function(a,b,c){"use strict";function d(a){return a.getPixelData()}c.r(b),c.d(b,"uint8DataUtilities",function(){return f}),c.d(b,"uint8Shader",function(){return e});var e={},f={storedPixelDataToImageData:d};e.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/textureCache.js":function(a,b,c){"use strict";function d(){return{maximumSizeInBytes:o,cacheSizeInBytes:p,numberOfImagesCached:n.length}}function e(){function a(a,b){return a.timeStamp>b.timeStamp?-1:a.timeStamp<b.timeStamp?1:0}if(!(p<=o)){for(n.sort(a);p>o;){var b=n[n.length-1];p-=b.sizeInBytes,delete m[b.imageId],n.pop(),Object(l["default"])(k.events,k["default"].WEBGL_TEXTURE_REMOVED,{imageId:b.imageId})}var c=d();Object(l["default"])(k.events,k["default"].WEBGL_TEXTURE_CACHE_FULL,c)}}function f(a){if(void 0===a)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===a.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");o=a,e()}function g(a,b){var c=a.imageId;if(void 0===a)throw new Error("putImageTexture: image must not be undefined");if(void 0===c)throw new Error("putImageTexture: imageId must not be undefined");if(void 0===b)throw new Error("putImageTexture: imageTexture must not be undefined");if(Object.prototype.hasOwnProperty.call(m,c)===!0)throw new Error("putImageTexture: imageId already in cache");var d={imageId:c,imageTexture:b,timeStamp:new Date,sizeInBytes:b.sizeInBytes};if(m[c]=d,n.push(d),void 0===b.sizeInBytes)throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===b.sizeInBytes.toFixed)throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");p+=d.sizeInBytes,e()}function h(a){if(void 0===a)throw new Error("getImageTexture: imageId must not be undefined");var b=m[a];if(void 0!==b)return b.timeStamp=new Date,b.imageTexture}function i(a){if(void 0===a)throw new Error("removeImageTexture: imageId must not be undefined");var b=m[a];if(void 0===b)throw new Error("removeImageTexture: imageId must not be undefined");return n.splice(n.indexOf(b),1),p-=b.sizeInBytes,delete m[a],b.imageTexture}function j(){for(;n.length>0;){var a=n.pop();delete m[a.imageId]}p=0}c.r(b);var k=c("./events.js"),l=c("./triggerEvent.js"),m={},n=[],o=268435456,p=0;b["default"]={purgeCache:j,getImageTexture:h,putImageTexture:g,removeImageTexture:i,setMaximumSizeBytes:f}},"./webgl/vertexShader.js":function(a,b,c){"use strict";c.r(b),c.d(b,"vertexShader",function(){return d});var d="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}})});var handleRadiusComm=1;!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define("cornerstoneTools",[],b):"object"==typeof exports?exports.cornerstoneTools=b():a.cornerstoneTools=b()}(window,function(){return function(a){function b(a){delete installedChunks[a]}function c(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.charset="utf-8",c.src=n.p+""+a+"."+u+".hot-update.js",b.appendChild(c)}function d(a){return a=a||1e4,new Promise(function(b,c){if("undefined"==typeof XMLHttpRequest)return c(new Error("No browser support"));try{var d=new XMLHttpRequest,e=n.p+""+u+".hot-update.json";d.open("GET",e,!0),d.timeout=a,d.send(null)}catch(f){return c(f)}d.onreadystatechange=function(){if(4===d.readyState)if(0===d.status)c(new Error("Manifest request to "+e+" timed out."));else if(404===d.status)b();else if(200!==d.status&&304!==d.status)c(new Error("Manifest request to "+e+" failed."));else{try{var a=JSON.parse(d.responseText)}catch(f){return void c(f)}b(a)}}})}function e(a){var b=G[a];if(!b)return n;var c=function(c){return b.hot.active?(G[c]?G[c].parents.indexOf(a)===-1&&G[c].parents.push(a):(x=[a],p=c),b.children.indexOf(c)===-1&&b.children.push(c)):(console.warn("[HMR] unexpected require("+c+") from disposed module "+a),x=[]),n(c)},d=function(a){return{configurable:!0,enumerable:!0,get:function(){return n[a]},set:function(b){n[a]=b}}};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&"e"!==e&&Object.defineProperty(c,e,d(e));return c.e=function(a){function b(){C--,"prepare"===A&&(D[a]||k(a),0===C&&0===B&&l())}return"ready"===A&&g("prepare"),C++,n.e(a).then(b,function(a){throw b(),a})},c}function f(a){var b={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:p!==a,active:!0,accept:function(a,c){if("undefined"==typeof a)b._selfAccepted=!0;else if("function"==typeof a)b._selfAccepted=a;else if("object"==typeof a)for(var d=0;d<a.length;d++)b._acceptedDependencies[a[d]]=c||function(){};else b._acceptedDependencies[a]=c||function(){}},decline:function(a){if("undefined"==typeof a)b._selfDeclined=!0;else if("object"==typeof a)for(var c=0;c<a.length;c++)b._declinedDependencies[a[c]]=!0;else b._declinedDependencies[a]=!0},dispose:function(a){b._disposeHandlers.push(a)},addDisposeHandler:function(a){b._disposeHandlers.push(a)},removeDisposeHandler:function(a){var c=b._disposeHandlers.indexOf(a);c>=0&&b._disposeHandlers.splice(c,1)},check:i,apply:m,status:function(a){return a?void z.push(a):A},addStatusHandler:function(a){z.push(a)},removeStatusHandler:function(a){var b=z.indexOf(a);b>=0&&z.splice(b,1)},data:w[a]};return p=void 0,b}function g(a){A=a;for(var b=0;b<z.length;b++)z[b].call(null,a)}function h(a){var b=+a+""===a;return b?+a:a}function i(a){if("idle"!==A)throw new Error("check() is only allowed in idle status");return t=a,g("check"),d(v).then(function(a){if(!a)return g("idle"),null;E={},D={},F=a.c,s=a.h,g("prepare");var b=new Promise(function(a,b){q={resolve:a,reject:b}});r={};var c="cornerstoneTools";return k(c),"prepare"===A&&0===C&&0===B&&l(),b})}function j(a,b){if(F[a]&&E[a]){E[a]=!1;for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(r[c]=b[c]);0===--B&&0===C&&l()}}function k(a){F[a]?(E[a]=!0,B++,c(a)):D[a]=!0}function l(){g("ready");var a=q;if(q=null,a)if(t)Promise.resolve().then(function(){return m(t)}).then(function(b){a.resolve(b)},function(b){a.reject(b)});else{var b=[];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&b.push(h(c));a.resolve(b)}}function m(c){function d(a){for(var b=[a],c={},d=b.slice().map(function(a){return{chain:[a],id:a}});d.length>0;){var f=d.pop(),g=f.id,h=f.chain;if(k=G[g],k&&!k.hot._selfAccepted){if(k.hot._selfDeclined)return{type:"self-declined",chain:h,moduleId:g};if(k.hot._main)return{type:"unaccepted",chain:h,moduleId:g};for(var i=0;i<k.parents.length;i++){var j=k.parents[i],l=G[j];if(l){if(l.hot._declinedDependencies[g])return{type:"declined",chain:h.concat([j]),moduleId:g,parentId:j};b.indexOf(j)===-1&&(l.hot._acceptedDependencies[g]?(c[j]||(c[j]=[]),e(c[j],[g])):(delete c[j],b.push(j),d.push({chain:h.concat([j]),id:j})))}}}}return{type:"accepted",moduleId:a,outdatedModules:b,outdatedDependencies:c}}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];a.indexOf(d)===-1&&a.push(d)}}if("ready"!==A)throw new Error("apply() is only allowed in ready status");c=c||{};var f,i,j,k,l,m={},o=[],p={},q=function(){console.warn("[HMR] unexpected require("+v.moduleId+") to disposed module")};for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){l=h(t);var v;v=r[t]?d(l):{type:"disposed",moduleId:t};var y=!1,z=!1,B=!1,C="";switch(v.chain&&(C="\nUpdate propagation: "+v.chain.join(" -> ")),v.type){case"self-declined":c.onDeclined&&c.onDeclined(v),c.ignoreDeclined||(y=new Error("Aborted because of self decline: "+v.moduleId+C));break;case"declined":c.onDeclined&&c.onDeclined(v),c.ignoreDeclined||(y=new Error("Aborted because of declined dependency: "+v.moduleId+" in "+v.parentId+C));break;case"unaccepted":c.onUnaccepted&&c.onUnaccepted(v),c.ignoreUnaccepted||(y=new Error("Aborted because "+l+" is not accepted"+C));break;case"accepted":c.onAccepted&&c.onAccepted(v),z=!0;break;case"disposed":c.onDisposed&&c.onDisposed(v),B=!0;break;default:throw new Error("Unexception type "+v.type)}if(y)return g("abort"),Promise.reject(y);if(z){p[l]=r[l],e(o,v.outdatedModules);for(l in v.outdatedDependencies)Object.prototype.hasOwnProperty.call(v.outdatedDependencies,l)&&(m[l]||(m[l]=[]),e(m[l],v.outdatedDependencies[l]))}B&&(e(o,[v.moduleId]),p[l]=q)}var D=[];for(i=0;i<o.length;i++)l=o[i],G[l]&&G[l].hot._selfAccepted&&D.push({module:l,errorHandler:G[l].hot._selfAccepted});g("dispose"),Object.keys(F).forEach(function(a){F[a]===!1&&b(a)});for(var E,H=o.slice();H.length>0;)if(l=H.pop(),k=G[l]){var I={},J=k.hot._disposeHandlers;for(j=0;j<J.length;j++)(f=J[j])(I);for(w[l]=I,k.hot.active=!1,delete G[l],delete m[l],j=0;j<k.children.length;j++){var K=G[k.children[j]];K&&(E=K.parents.indexOf(l),E>=0&&K.parents.splice(E,1))}}var L,M;for(l in m)if(Object.prototype.hasOwnProperty.call(m,l)&&(k=G[l]))for(M=m[l],j=0;j<M.length;j++)L=M[j],E=k.children.indexOf(L),E>=0&&k.children.splice(E,1);g("apply"),u=s;for(l in p)Object.prototype.hasOwnProperty.call(p,l)&&(a[l]=p[l]);var N=null;for(l in m)if(Object.prototype.hasOwnProperty.call(m,l)&&(k=G[l])){M=m[l];var O=[];for(i=0;i<M.length;i++)if(L=M[i],f=k.hot._acceptedDependencies[L]){if(O.indexOf(f)!==-1)continue;O.push(f)}for(i=0;i<O.length;i++){f=O[i];try{f(M)}catch(P){c.onErrored&&c.onErrored({type:"accept-errored",moduleId:l,dependencyId:M[i],error:P}),c.ignoreErrored||N||(N=P)}}}for(i=0;i<D.length;i++){
var Q=D[i];l=Q.module,x=[l];try{n(l)}catch(P){if("function"==typeof Q.errorHandler)try{Q.errorHandler(P)}catch(R){c.onErrored&&c.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:R,originalError:P}),c.ignoreErrored||N||(N=R),N||(N=P)}else c.onErrored&&c.onErrored({type:"self-accept-errored",moduleId:l,error:P}),c.ignoreErrored||N||(N=P)}}return N?(g("fail"),Promise.reject(N)):(g("idle"),new Promise(function(a){a(o)}))}function n(b){if(G[b])return G[b].exports;var c=G[b]={i:b,l:!1,exports:{},hot:f(b),parents:(y=x,x=[],y),children:[]};return a[b].call(c.exports,c,c.exports,e(b)),c.l=!0,c.exports}var o=window.webpackHotUpdate_name_;window.webpackHotUpdate_name_=function(a,b){j(a,b),o&&o(a,b)};var p,q,r,s,t=!0,u="728563eb25d15a3968b8",v=1e4,w={},x=[],y=[],z=[],A="idle",B=0,C=0,D={},E={},F={},G={};return n.m=a,n.c=G,n.d=function(a,b,c){n.o(a,b)||Object.defineProperty(a,b,{configurable:!1,enumerable:!0,get:c})},n.r=function(a){Object.defineProperty(a,"__esModule",{value:!0})},n.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};return n.d(b,"a",b),b},n.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},n.p="",n.h=function(){return u},e("./index.js")(n.s="./index.js")}({"./events.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_REMOVED:"cornerstonemeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonestackscroll",LINE_SAMPLE_UPDATED:"cornerstonelinesampleupdated"};b["default"]=d},"./externalModules.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=window.cornerstone,e=window.cornerstoneMath,f=window.Hammer;b["default"]={set cornerstone(a){d=a},get cornerstone(){return d},set cornerstoneMath(a){e=a},get cornerstoneMath(){return e},set Hammer(a){f=a},get Hammer(){return f}}},"./imageTools/angleTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b={visible:!0,active:!0,color:void 0,handles:{start:{x:a.currentPoints.image.x-20,y:a.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0},start2:{x:a.currentPoints.image.x-20,y:a.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:a.currentPoints.image.x,y:a.currentPoints.image.y+20,highlight:!0,active:!1}}};return b}function f(a,b,c){return b.visible!==!1&&((0,x["default"])(a,b.handles.start,b.handles.end,c)<5||(0,x["default"])(a,b.handles.start2,b.handles.end2,c)<5)}function g(a){var b=a.detail,c=(0,v.getToolState)(a.currentTarget,z);if(void 0!==c)for(var d=(0,y.getNewContext)(b.canvasContext.canvas),e=A.getConfiguration(),f=i["default"].cornerstone,g=function(a){var g=c.data[a];return g.visible===!1?"continue":void(0,y.draw)(d,function(a){(0,y.setShadow)(a,e);var c=s["default"].getColorIfActive(g);(0,y.drawJoinedLines)(a,b.element,g.handles.end,[g.handles.start,g.handles.end2],{color:c}),(0,u["default"])(a,b,g.handles);var d=b.image.columnPixelSpacing||1,h=b.image.rowPixelSpacing||1,i=(Math.ceil(g.handles.start.x)-Math.ceil(g.handles.end.x))*d,j=(Math.ceil(g.handles.start.y)-Math.ceil(g.handles.end.y))*h,k=(Math.ceil(g.handles.start2.x)-Math.ceil(g.handles.end2.x))*d,l=(Math.ceil(g.handles.start2.y)-Math.ceil(g.handles.end2.y))*h,m=Math.acos(Math.abs((i*k+j*l)/(Math.sqrt(i*i+j*j)*Math.sqrt(k*k+l*l))));m*=180/Math.PI;var n=(0,q["default"])(m,2),p="00B0",r=n.toString()+String.fromCharCode(parseInt(p,16)),t=f.pixelToCanvas(b.element,g.handles.start2),v=f.pixelToCanvas(b.element,g.handles.end2),w=(t.x+v.x)/2,x=(t.y+v.y)/2;(0,o["default"])(a,r,w,x,c)})},h=0;h<c.data.length;h++){g(h)}}Object.defineProperty(b,"__esModule",{value:!0}),b.angleTouch=b.angle=void 0;var h=c("./externalModules.js"),i=d(h),j=c("./imageTools/mouseButtonTool.js"),k=d(j),l=c("./imageTools/touchTool.js"),m=d(l),n=c("./util/drawTextBox.js"),o=d(n),p=c("./util/roundToDecimal.js"),q=d(p),r=c("./stateManagement/toolColors.js"),s=d(r),t=c("./manipulators/drawHandles.js"),u=d(t),v=c("./stateManagement/toolState.js"),w=c("./util/lineSegDistance.js"),x=d(w),y=c("./util/drawing.js"),z="angle",A=(0,k["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:z}),B=(0,m["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:z});b.angle=A,b.angleTouch=B},"./imageTools/arrowAnnotate.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){a(prompt("Enter your annotation:"))}function f(a,b,c){c(prompt("Change your annotation:"))}function g(a){function b(a){null===a?(0,R.removeToolState)(c,Z,d):d.text=a,d.active=!1,e.updateImage(c);var b=o["default"].MEASUREMENT_MODIFIED,f={toolType:Z,element:c,measurementData:d};(0,Y["default"])(c,b,f),c.addEventListener(o["default"].MOUSE_MOVE,_.mouseMoveCallback),c.addEventListener(o["default"].MOUSE_DOWN,_.mouseDownCallback),c.addEventListener(o["default"].MOUSE_DOWN_ACTIVATE,_.mouseDownActivateCallback),c.addEventListener(o["default"].MOUSE_DOUBLE_CLICK,_.mouseDoubleClickCallback)}var c=a.element,d=h(a),e=q["default"].cornerstone;(0,R.addToolState)(c,Z,d),c.removeEventListener(o["default"].MOUSE_MOVE,_.mouseMoveCallback),c.removeEventListener(o["default"].MOUSE_DOWN,_.mouseDownCallback),c.removeEventListener(o["default"].MOUSE_DOWN_ACTIVATE,_.mouseDownActivateCallback),c.removeEventListener(o["default"].MOUSE_DOUBLE_CLICK,_.mouseDoubleClickCallback),e.updateImage(c),(0,G["default"])(a,Z,d,d.handles.end,function(){(0,K["default"])(a,d.handles)&&(0,R.removeToolState)(c,Z,d);var f=_.getConfiguration();void 0===d.text&&f.getTextCallback(b),e.updateImage(c)})}function h(a){var b={visible:!0,active:!0,color:void 0,handles:{start:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};return b}function i(a,b,c){return b.visible!==!1&&(0,U["default"])(a,b.handles.start,b.handles.end,c)<25}function j(a){function b(a){return a.text}function c(a){var b={x:(a.start.x+a.end.x)/2,y:(a.start.y+a.end.y)/2};return[a.start,b,a.end]}var d=a.detail,e=(0,R.getToolState)(a.currentTarget,Z);if(e)for(var f=d.enabledElement,g=q["default"].cornerstone,h=(0,V.getNewContext)(d.canvasContext.canvas),i=w["default"].getToolWidth(),j=_.getConfiguration(),k=function(a){var k=e.data[a];return k.visible===!1?"continue":void(0,V.draw)(h,function(a){(0,V.setShadow)(a,j);var e=A["default"].getColorIfActive(k),h=g.pixelToCanvas(d.element,k.handles.start),l=g.pixelToCanvas(d.element,k.handles.end);j.arrowFirst?(0,E["default"])(a,l,h,e,i):(0,E["default"])(a,h,l,e,i);var m={drawHandlesIfActive:j&&j.drawHandlesOnHover};j.drawHandles&&(0,C["default"])(a,d,k.handles,e,m);var n=b(k);if(n&&""!==n){var o=5,p=(0,W.textBoxWidth)(a,n,o),q=y["default"].getFontSize()+10,r=Math.max(p,q)/2+5;if(l.x<h.x&&(r=-r),!k.handles.textBox.hasMoved){var s=void 0;s=j.arrowFirst?{x:l.x-p/2+r,y:l.y-q/2}:{x:h.x-p/2-r,y:h.y-q/2};var t=g.internal.getTransform(f);t.invert();var u=t.transformPoint(s.x,s.y);k.handles.textBox.x=u.x,k.handles.textBox.y=u.y}(0,Q["default"])(a,d.element,k.handles.textBox,n,k.handles,c,e,i,0,!1)}})},l=0;l<e.data.length;l++){k(l)}}function k(a){function b(a){null===a?(0,R.removeToolState)(c,Z,d):d.text=a,d.active=!1,e.updateImage(c);var b=o["default"].MEASUREMENT_MODIFIED,f={toolType:Z,element:c,measurementData:d};(0,Y["default"])(c,b,f),c.addEventListener(o["default"].TOUCH_PRESS,aa.pressCallback),c.addEventListener(o["default"].TOUCH_START_ACTIVE,aa.touchDownActivateCallback),c.addEventListener(o["default"].TAP,aa.tapCallback)}var c=a.element,d=h(a),e=q["default"].cornerstone;(0,R.addToolState)(c,Z,d),c.removeEventListener(o["default"].TOUCH_PRESS,aa.pressCallback),c.removeEventListener(o["default"].TOUCH_START_ACTIVE,aa.touchDownActivateCallback),c.removeEventListener(o["default"].TAP,aa.tapCallback),e.updateImage(c),(0,I["default"])(a,Z,d,d.handles.end,function(){e.updateImage(c),(0,K["default"])(a,d.handles)&&(0,R.removeToolState)(c,Z,d);var f=_.getConfiguration();void 0===d.text&&f.getTextCallback(b)})}function l(a){function b(a,b,c){c===!0?(0,R.removeToolState)(d,Z,a):a.text=b,a.active=!1,e.updateImage(d)}var c=a.detail,d=c.element,e=q["default"].cornerstone,f=(0,S.getToolOptions)(Z,d),g=void 0;if((0,M["default"])(c.which,f.mouseButtonMask)){var h=_.getConfiguration(),j=c.currentPoints.canvas,k=(0,R.getToolState)(d,Z);if(k)for(var l=0;l<k.data.length;l++)if(g=k.data[l],i(d,g,j)||(0,O["default"])(g.handles.textBox,j))return g.active=!0,e.updateImage(d),h.changeTextCallback(g,c,b),a.stopImmediatePropagation(),!1}}function m(a){function b(a,b,c){console.log("pressCallback doneChangingTextCallback"),c===!0?(0,R.removeToolState)(d,Z,a):a.text=b,a.active=!1,e.updateImage(d),d.addEventListener(o["default"].TOUCH_START,aa.touchStartCallback),d.addEventListener(o["default"].TOUCH_START_ACTIVE,aa.touchDownActivateCallback),d.addEventListener(o["default"].TAP,aa.tapCallback)}var c=a.detail,d=c.element,e=q["default"].cornerstone,f=void 0,g=_.getConfiguration(),h=c.currentPoints.canvas,j=(0,R.getToolState)(d,Z);if(j){if(c.handlePressed)return d.removeEventListener(o["default"].TOUCH_START,aa.touchStartCallback),d.removeEventListener(o["default"].TOUCH_START_ACTIVE,aa.touchDownActivateCallback),d.removeEventListener(o["default"].TAP,aa.tapCallback),g.changeTextCallback(c.handlePressed,c,b),a.stopImmediatePropagation(),!1;for(var k=0;k<j.data.length;k++)if(f=j.data[k],i(d,f,h)||(0,O["default"])(f.handles.textBox,h))return f.active=!0,e.updateImage(d),d.removeEventListener(o["default"].TOUCH_START,aa.touchStartCallback),d.removeEventListener(o["default"].TOUCH_START_ACTIVE,aa.touchDownActivateCallback),d.removeEventListener(o["default"].TAP,aa.tapCallback),g.changeTextCallback(f,c,b),a.stopImmediatePropagation(),!1;a.preventDefault(),a.stopPropagation()}}Object.defineProperty(b,"__esModule",{value:!0}),b.arrowAnnotateTouch=b.arrowAnnotate=void 0;var n=c("./events.js"),o=d(n),p=c("./externalModules.js"),q=d(p),r=c("./imageTools/mouseButtonTool.js"),s=d(r),t=c("./imageTools/touchTool.js"),u=d(t),v=c("./stateManagement/toolStyle.js"),w=d(v),x=c("./stateManagement/textStyle.js"),y=d(x),z=c("./stateManagement/toolColors.js"),A=d(z),B=c("./manipulators/drawHandles.js"),C=d(B),D=c("./util/drawArrow.js"),E=d(D),F=c("./manipulators/moveNewHandle.js"),G=d(F),H=c("./manipulators/moveNewHandleTouch.js"),I=d(H),J=c("./manipulators/anyHandlesOutsideImage.js"),K=d(J),L=c("./util/isMouseButtonEnabled.js"),M=d(L),N=c("./util/pointInsideBoundingBox.js"),O=d(N),P=c("./util/drawLinkedTextBox.js"),Q=d(P),R=c("./stateManagement/toolState.js"),S=c("./toolOptions.js"),T=c("./util/lineSegDistance.js"),U=d(T),V=c("./util/drawing.js"),W=c("./util/drawTextBox.js"),X=c("./util/triggerEvent.js"),Y=d(X),Z="arrowAnnotate",$={getTextCallback:e,changeTextCallback:f,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},_=(0,s["default"])({addNewMeasurement:g,createNewMeasurement:h,onImageRendered:j,pointNearTool:i,toolType:Z,mouseDoubleClickCallback:l});_.setConfiguration($);var aa=(0,u["default"])({addNewMeasurement:k,createNewMeasurement:h,onImageRendered:j,pointNearTool:i,toolType:Z,pressCallback:m});b.arrowAnnotate=_,b.arrowAnnotateTouch=aa},"./imageTools/crosshairs.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail;a.stopImmediatePropagation();var c=(0,v.getToolState)(a.currentTarget,C);if(c){var d=s["default"].cornerstone,e=a.currentTarget,f=d.getEnabledElement(e),g=f.image.imageId,h=d.metaData.get("imagePlaneModule",g);if(h){var i=b.currentPoints.image,j=(0,y.imagePointToPatientPoint)(i,h),k=c.data[0].synchronizationContext,l=k.getSourceElements();l.forEach(function(a){if(a!==e){var b=Number.MAX_VALUE,c=-1,f=(0,v.getToolState)(a,"stack");if(void 0!==f){var g=f.data[0];if(g.imageIds.forEach(function(a,e){var f=d.metaData.get("imagePlaneModule",a);if(f&&f.imagePositionPatient&&f.rowCosines&&f.columnCosines){var g=(0,A["default"])(f.imagePositionPatient),h=(0,A["default"])(f.rowCosines),i=(0,A["default"])(f.columnCosines),k=i.clone().cross(h.clone()),l=Math.abs(k.clone().dot(g)-k.clone().dot(j));l<b&&(b=l,c=e)}}),c!==g.currentImageIdIndex&&c!==-1&&void 0!==g.imageIds[c]){var h=u["default"].getStartLoadHandler(),i=u["default"].getEndLoadHandler(),k=u["default"].getErrorLoadingHandler();h&&h(a);var l=void 0;l=g.preventCache===!0?d.loadImage(g.imageIds[c]):d.loadAndCacheImage(g.imageIds[c]),l.then(function(b){var e=d.getViewport(a);g.currentImageIdIndex=c,d.displayImage(a,b,e),i&&i(a,b)},function(b){var d=g.imageIds[c];k&&k(a,d,b)})}}}})}}}function f(a){var b=a.detail,c=b.element;c.removeEventListener(q["default"].MOUSE_DRAG,h),c.removeEventListener(q["default"].MOUSE_UP,f)}function g(a){var b=a.detail,c=b.element,d=(0,B.getToolOptions)(C,c);(0,x["default"])(b.which,d.mouseButtonMask)&&(c.addEventListener(q["default"].MOUSE_DRAG,h),c.addEventListener(q["default"].MOUSE_UP,f),e(a),a.preventDefault(),a.stopPropagation())}function h(a){e(a),a.preventDefault(),a.stopPropagation()}function i(a,b,c){(0,B.setToolOptions)(C,a,{mouseButtonMask:b}),(0,v.clearToolState)(a,C),(0,v.addToolState)(a,C,{synchronizationContext:c}),a.removeEventListener(q["default"].MOUSE_DOWN,g),a.addEventListener(q["default"].MOUSE_DOWN,g)}function j(a){a.removeEventListener(q["default"].MOUSE_DOWN,g)}function k(a){var b=a.detail,c=b.element;c.removeEventListener(q["default"].TOUCH_DRAG,m),c.removeEventListener(q["default"].TOUCH_DRAG_END,k)}function l(a){var b=a.detail,c=b.element;return c.addEventListener(q["default"].TOUCH_DRAG,m),c.addEventListener(q["default"].TOUCH_DRAG_END,k),e(a),!1}function m(a){e(a),a.preventDefault(),a.stopPropagation()}function n(a,b){(0,v.clearToolState)(a,C),(0,v.addToolState)(a,C,{synchronizationContext:b}),a.removeEventListener(q["default"].TOUCH_START,l),a.addEventListener(q["default"].TOUCH_START,l)}function o(a){a.removeEventListener(q["default"].TOUCH_START,l)}Object.defineProperty(b,"__esModule",{value:!0}),b.crosshairsTouch=b.crosshairs=void 0;var p=c("./events.js"),q=d(p),r=c("./externalModules.js"),s=d(r),t=c("./stateManagement/loadHandlerManager.js"),u=d(t),v=c("./stateManagement/toolState.js"),w=c("./util/isMouseButtonEnabled.js"),x=d(w),y=c("./util/pointProjector.js"),z=c("./util/convertToVector3.js"),A=d(z),B=c("./toolOptions.js"),C="crosshairs",D={activate:i,deactivate:j,enable:i,disable:j},E={activate:n,deactivate:o,enable:n,disable:o};b.crosshairs=D,b.crosshairsTouch=E},"./imageTools/displayTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){var b={};return{disable:function(b){b.removeEventListener(f["default"].cornerstone.EVENTS.IMAGE_RENDERED,a)},enable:function(b){b.removeEventListener(f["default"].cornerstone.EVENTS.IMAGE_RENDERED,a),b.addEventListener(f["default"].cornerstone.EVENTS.IMAGE_RENDERED,a),f["default"].cornerstone.updateImage(b)},getConfiguration:function(){return b},setConfiguration:function(a){b=a}}};var e=c("./externalModules.js"),f=d(e)},"./imageTools/doubleTapTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){return{activate:function(b){b.removeEventListener(f["default"].DOUBLE_TAP,a),b.addEventListener(f["default"].DOUBLE_TAP,a)},disable:function(b){b.removeEventListener(f["default"].DOUBLE_TAP,a)},enable:function(b){b.removeEventListener(f["default"].DOUBLE_TAP,a)},deactivate:function(b){b.removeEventListener(f["default"].DOUBLE_TAP,a)}}};var e=c("./events.js"),f=d(e)},"./imageTools/doubleTapZoom.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){h["default"].cornerstone.fitToWindow(a.element)}function f(a){var b=a.detail;k.strategy(b),a.preventDefault(),a.stopPropagation()}Object.defineProperty(b,"__esModule",{value:!0});var g=c("./externalModules.js"),h=d(g),i=c("./imageTools/doubleTapTool.js"),j=d(i),k=(0,j["default"])(f);k.strategies={"default":e},k.strategy=e,b["default"]=k},"./imageTools/dragProbe.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=p["default"].cornerstone,c=b.getEnabledElement(a.element),d=(0,H.getNewContext)(c.canvas),e=x["default"].getActiveColor(),f=v["default"].getFontSize(),g=K.getConfiguration(),h=Math.round(a.currentPoints.image.x),i=Math.round(a.currentPoints.image.y);h<0||i<0||h>=a.image.columns||i>=a.image.rows||(0,H.draw)(d,function(c){(0,H.setShadow)(c,g);var d=void 0,j=void 0,k=void 0;if(a.image.color)d=(0,B["default"])(a.element,h,i,1,1),j=h+", "+i,k="R: "+d[0]+" G: "+d[1]+" B: "+d[2]+" A: "+d[3];else{d=b.getStoredPixels(a.element,h,i,1,1);var l=d[0],m=l*a.image.slope+a.image.intercept,n=(0,D["default"])(a.image,l);j=h+", "+i,k="SP: "+l+" MO: "+parseFloat(m.toFixed(3)),n&&(k+=" SUV: "+parseFloat(n.toFixed(3)))}var o={x:a.currentPoints.image.x+3,y:a.currentPoints.image.y-3},p=b.pixelToCanvas(a.element,o);(0,z["default"])(c,k,p.x,p.y+f+5,e),(0,z["default"])(c,j,p.x,p.y,e)})}function f(a){var b=p["default"].cornerstone,c=a.element,d=b.getEnabledElement(c),e=d.image,f=(0,H.getNewContext)(d.canvas),g=x["default"].getActiveColor(),h=K.getConfiguration(),i=void 0;i=a.isTouchEvent===!0?b.pageToPixel(c,a.currentPoints.page.x,a.currentPoints.page.y-4*v["default"].getFontSize()):b.pageToPixel(c,a.currentPoints.page.x,a.currentPoints.page.y-v["default"].getFontSize()/2),i.x<0||i.y<0||i.x>=e.columns||i.y>=e.rows||(0,H.draw)(f,function(d){(0,H.setShadow)(d,h);var f=b.metaData.get("generalSeriesModule",e.imageId),j=void 0;f&&(j=f.modality);var k=void 0,l="";if(e.color)k=(0,B["default"])(c,i.x,i.y,1,1),l="R: "+k[0]+" G: "+k[1]+" B: "+k[2];else{k=b.getStoredPixels(c,i.x,i.y,1,1);var m=k[0],n=m*a.image.slope+a.image.intercept,o=parseFloat(n.toFixed(2));if("CT"===j)l+="HU: "+o;else if("PT"===j){l+=o;var p=(0,D["default"])(a.image,m);p&&(l+=" SUV: "+parseFloat(p.toFixed(2)))}else l+=o}var q=b.pixelToCanvas(c,i),r=void 0,s=handleRadiusComm,t=5,u=(0,y.textBoxWidth)(d,l,t);r=a.isTouchEvent===!0?{x:-u/2,y:-v["default"].getFontSize()-10-2*s}:{x:12,y:-(v["default"].getFontSize()+10)/2},(0,H.drawCircle)(d,c,q,s,{color:g},"canvas"),(0,z["default"])(d,l,q.x+r.x,q.y+r.y,g)})}function g(a){var b=a.detail,c=b.element;c.removeEventListener(p["default"].cornerstone.EVENTS.IMAGE_RENDERED,i),c.removeEventListener(n["default"].MOUSE_DRAG,j),c.removeEventListener(n["default"].MOUSE_UP,g),c.removeEventListener(n["default"].MOUSE_CLICK,g),p["default"].cornerstone.updateImage(b.element)}function h(a){var b=a.detail,c=b.element,d=(0,G.getToolOptions)(I,c);(0,F["default"])(b.which,d.mouseButtonMask)&&(c.addEventListener(p["default"].cornerstone.EVENTS.IMAGE_RENDERED,i),c.addEventListener(n["default"].MOUSE_DRAG,j),c.addEventListener(n["default"].MOUSE_UP,g),c.addEventListener(n["default"].MOUSE_CLICK,g),K.strategy(b),a.preventDefault(),a.stopPropagation())}function i(){J&&(K.strategy(J),J=null)}function j(a){var b=a.detail,c=b.element;J=b,p["default"].cornerstone.updateImage(c),a.preventDefault(),a.stopPropagation()}function k(a){var b=a.detail,c=b.element;c.addEventListener(p["default"].cornerstone.EVENTS.IMAGE_RENDERED,i)}function l(a){var b=a.detail,c=b.element;c.removeEventListener(p["default"].cornerstone.EVENTS.IMAGE_RENDERED,i),p["default"].cornerstone.updateImage(c)}Object.defineProperty(b,"__esModule",{value:!0}),b.dragProbeTouch=b.dragProbe=void 0;var m=c("./events.js"),n=d(m),o=c("./externalModules.js"),p=d(o),q=c("./imageTools/simpleMouseButtonTool.js"),r=d(q),s=c("./imageTools/touchDragTool.js"),t=d(s),u=c("./stateManagement/textStyle.js"),v=d(u),w=c("./stateManagement/toolColors.js"),x=d(w),y=c("./util/drawTextBox.js"),z=d(y),A=c("./util/getRGBPixels.js"),B=d(A),C=c("./util/calculateSUV.js"),D=d(C),E=c("./util/isMouseButtonEnabled.js"),F=d(E),G=c("./toolOptions.js"),H=c("./util/drawing.js"),I="dragProbe",J=void 0,K=(0,r["default"])(h,I);K.strategies={"default":e,minimal:f},K.strategy=e;var L={fireOnTouchStart:!0,touchStartCallback:k,touchEndCallback:l},M=(0,t["default"])(j,I,L);b.dragProbe=K,b.dragProbeTouch=M},"./imageTools/ellipticalRoi.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{start:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};return b}function f(a,b,c,d){if(b.visible===!1)return!1;var e=l["default"].cornerstone,f=e.pixelToCanvas(a,b.handles.start),g=e.pixelToCanvas(a,b.handles.end),h={left:Math.min(f.x,g.x)+d/2,top:Math.min(f.y,g.y)+d/2,width:Math.abs(f.x-g.x)-d,height:Math.abs(f.y-g.y)-d},i={left:Math.min(f.x,g.x)-d/2,top:Math.min(f.y,g.y)-d/2,width:Math.abs(f.x-g.x)+d,height:Math.abs(f.y-g.y)+d},j=(0,x["default"])(h,c),k=(0,x["default"])(i,c);return!(!k||j)}function g(a,b,c){return f(a,b,c,15)}function h(a,b,c){return f(a,b,c,25)}function i(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}function j(a){function b(a){var b=a.meanStdDev,c=a.meanStdDevSUV,d=a.area,e=[];if(b&&void 0!==b.mean){var f="";"CT"===o&&(f=" HU");var g="Mean: "+i(b.mean.toFixed(2))+f,h="StdDev: "+i(b.stdDev.toFixed(2))+f;if(c&&void 0!==c.mean){var j=" SUV: ";g+=j+i(c.mean.toFixed(2)),h+=j+i(c.stdDev.toFixed(2))}e.push(g),e.push(h)}if(d){var k=" mm"+String.fromCharCode(178);p&&q||(k=" pixels"+String.fromCharCode(178));var l="Area: "+i(d.toFixed(2))+k;e.push(l)}return e}function c(a){var b=Math.min(a.start.x,a.end.x),c=Math.min(a.start.y,a.end.y),d=Math.abs(a.start.x-a.end.x),e=Math.abs(a.start.y-a.end.y);return[{x:b+d/2,y:c},{x:b,y:c+e/2},{x:b+d/2,y:c+e},{x:b+d,y:c+e/2}]}var d=a.detail,e=(0,E.getToolState)(a.currentTarget,G);if(e){var f=l["default"].cornerstone,g=d.image,h=d.element,j=r["default"].getToolWidth(),k=H.getConfiguration(),m=f.metaData.get("generalSeriesModule",g.imageId),n=f.metaData.get("imagePlaneModule",g.imageId),o=void 0,p=void 0,q=void 0;n?(p=n.rowPixelSpacing||n.rowImagePixelSpacing,q=n.columnPixelSpacing||n.colImagePixelSpacing):(p=g.rowPixelSpacing,q=g.columnPixelSpacing),m&&(o=m.modality);for(var s=(0,F.getNewContext)(d.canvasContext.canvas),u=function(a){var i=e.data[a];return i.visible===!1?"continue":void(0,F.draw)(s,function(a){(0,F.setShadow)(a,k);var e=t["default"].getColorIfActive(i);if((0,F.drawEllipse)(a,h,i.handles.start,i.handles.end,{color:e}),k&&k.drawHandlesOnHover)if(i.active===!0)(0,v["default"])(a,d,i.handles,e);else{var l={drawHandlesIfActive:!0};(0,v["default"])(a,d,i.handles,e,l)}else(0,v["default"])(a,d,i.handles,e);var m=void 0,n=void 0,r=void 0;if(i.invalidated===!1)n=i.meanStdDev,r=i.meanStdDevSUV,m=i.area;else{var s={left:Math.round(Math.min(i.handles.start.x,i.handles.end.x)),top:Math.round(Math.min(i.handles.start.y,i.handles.end.y)),width:Math.round(Math.abs(i.handles.start.x-i.handles.end.x)),height:Math.round(Math.abs(i.handles.start.y-i.handles.end.y))};if(!g.color){var u=f.getPixels(h,s.left,s.top,s.width,s.height);n=(0,z["default"])(u,s),"PT"===o&&(r={mean:(0,B["default"])(g,(n.mean-g.intercept)/g.slope),stdDev:(0,B["default"])(g,(n.stdDev-g.intercept)/g.slope)}),n&&!isNaN(n.mean)&&(i.meanStdDev=n,i.meanStdDevSUV=r)}m=Math.PI*(s.width*(q||1)/2)*(s.height*(p||1)/2),isNaN(m)||(i.area=m),i.invalidated=!1}i.handles.textBox.hasMoved||(i.handles.textBox.x=Math.max(i.handles.start.x,i.handles.end.x),i.handles.textBox.y=(i.handles.start.y+i.handles.end.y)/2);var w=b(i);(0,D["default"])(a,h,i.handles.textBox,w,i.handles,c,e,j,0,!0)})},w=0;w<e.data.length;w++){u(w)}}}Object.defineProperty(b,"__esModule",{value:!0}),b.ellipticalRoiTouch=b.ellipticalRoi=void 0;var k=c("./externalModules.js"),l=d(k),m=c("./imageTools/mouseButtonTool.js"),n=d(m),o=c("./imageTools/touchTool.js"),p=d(o),q=c("./stateManagement/toolStyle.js"),r=d(q),s=c("./stateManagement/toolColors.js"),t=d(s),u=c("./manipulators/drawHandles.js"),v=d(u),w=c("./util/pointInEllipse.js"),x=d(w),y=c("./util/calculateEllipseStatistics.js"),z=d(y),A=c("./util/calculateSUV.js"),B=d(A),C=c("./util/drawLinkedTextBox.js"),D=d(C),E=c("./stateManagement/toolState.js"),F=c("./util/drawing.js"),G="ellipticalRoi",H=(0,n["default"])({createNewMeasurement:e,onImageRendered:j,pointNearTool:g,toolType:G}),I=(0,p["default"])({createNewMeasurement:e,onImageRendered:j,pointNearTool:h,toolType:G});b.ellipticalRoi=H,b.ellipticalRoiTouch=I},"./imageTools/eraser.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function f(){t.supportedTools={},Object.keys(k).forEach(function(a){var b=k[a];"function"==typeof b.pointNearTool&&(t.supportedTools[a]=b)})}function g(a){var b=a.detail.currentPoints.canvas,c=a.detail.element,d=!1,e=!1;Object.entries(t.supportedTools).forEach(function(a){var f=i(a,2),g=f[0],h=f[1],j=k.getToolState(c,g);j&&j.data.forEach(function(a){!d&&h.pointNearTool(c,a,b)&&(k.removeToolState(c,g,a),d=!0,e=!0)})}),e&&m["default"].cornerstone.updateImage(c)}function h(a){var b=a.detail.currentPoints.canvas,c=a.detail.element,d=!1,e=!1;Object.entries(t.supportedTools).forEach(function(a){var f=i(a,2),g=f[0],h=f[1],j=k.getToolState(c,g);j&&j.data.forEach(function(a){a.active&&(a.active=!1,d=!0),!e&&h.pointNearTool(c,a,b)&&(a.active=!0,d=!0,e=!0)})}),d&&m["default"].cornerstone.updateImage(c)}Object.defineProperty(b,"__esModule",{value:!0}),b.eraserTouch=b.eraser=void 0;var i=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),j=c("./index.js"),k=e(j),l=c("./externalModules.js"),m=d(l),n=c("./events.js"),o=d(n),p=c("./toolOptions.js"),q=c("./imageTools/simpleTouchTool.js"),r=d(q),s="eraser",t={supportedTools:{}},u={activate:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c.mouseButtonMask=b,(0,p.setToolOptions)(s,a,c),a.removeEventListener(o["default"].MOUSE_DOWN_ACTIVATE,g),a.removeEventListener(o["default"].MOUSE_MOVE,h),a.addEventListener(o["default"].MOUSE_DOWN_ACTIVATE,g),a.addEventListener(o["default"].MOUSE_MOVE,h),f()},disable:function(a){a.removeEventListener(o["default"].MOUSE_DOWN_ACTIVATE,g),a.removeEventListener(o["default"].MOUSE_MOVE,h)},enable:function(a){a.removeEventListener(o["default"].MOUSE_DOWN_ACTIVATE,g),a.removeEventListener(o["default"].MOUSE_MOVE,h)},deactivate:function(a){a.removeEventListener(o["default"].MOUSE_DOWN_ACTIVATE,g),a.removeEventListener(o["default"].MOUSE_MOVE,h)},getConfiguration:function(){return t},setConfiguration:function(a){t=a}},v=(0,r["default"])(g,s);b.eraser=u,b.eraserTouch=v},"./imageTools/freehand.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function f(){var a={visible:!0,active:!0,invalidated:!0,color:void 0,handles:[],textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}};return a}function g(a,b,c){var d=h(a,b,c);return null!==d}function h(a,b,c){var d=Ca.getConfiguration();if(void 0===b.handles)return null;if(b.visible===!1)return null;for(var e=0;e<b.handles.length;e++){var f=R["default"].cornerstone.pixelToCanvas(a,b.handles[e]);if(R["default"].cornerstoneMath.point.distance(f,c)<d.spacing)return e}return b.textBox&&(0,_["default"])(b.textBox,c)?b.textBox:null}function i(a){var b=a.element,c=a.currentPoints.canvas,d=(0,ia.getToolState)(b,Aa);if(d)for(var e=void 0,f=0;f<d.data.length;f++)if(e=h(b,d.data[f],c),null!==e)return{handleNearby:e,toolIndex:f}}function j(a){var b=a.detail,c=b.element,d=Ca.getConfiguration(),e=(0,ja.getToolOptions)(Aa,c);(0,fa["default"])(b.which,e.mouseButtonMask)&&(b.event.shiftKey&&(d.activePencilMode=!0),k(b),m(b),a.preventDefault(),a.stopPropagation())}function k(a){var b=a.element;b.addEventListener(P["default"].MOUSE_MOVE,q);var c=f(),d=Ca.getConfiguration();d.mouseLocation.handles.start.x=a.currentPoints.image.x,d.mouseLocation.handles.start.y=a.currentPoints.image.y,(0,ia.addToolState)(a.element,Aa,c);var e=(0,ia.getToolState)(a.element,Aa);d.currentTool=e.data.length-1}function l(a,b){for(var c=Ca.getConfiguration(),d=c.mouseLocation.handles.start,e=0;e<b.length;e++)if(R["default"].cornerstoneMath.point.distance(b[e],d)<c.spacing)return;m(a)}function m(a){var b=(0,ia.getToolState)(a.element,Aa);if(void 0!==b){var c=Ca.getConfiguration(),d=b.data[c.currentTool];if(!d.handles.invalidHandlePlacement){var e=new ya.FreehandHandleData(a.currentPoints.image);d.handles.length&&d.handles[c.currentHandle-1].lines.push(a.currentPoints.image),d.handles.push(e),c.currentHandle+=1,R["default"].cornerstone.updateImage(a.element)}}}function n(a,b){var c=(0,ia.getToolState)(a.element,Aa);if(c){var d=Ca.getConfiguration(),e=c.data[d.currentTool];e.active=!1,e.highlight=!1,e.handles.invalidHandlePlacement=!1,void 0!==b&&e.handles[d.currentHandle-1].lines.push(e.handles[0]),d.modifying&&(d.modifying=!1,e.invalidated=!0),d.currentHandle=0,d.currentTool=-1,d.activePencilMode=!1,e.canComplete=!1,R["default"].cornerstone.updateImage(a.element)}}function o(a,b,c){var d=a.detail,e=Ca.getConfiguration(),f=d.element,g=b.data[c],i=d.currentPoints.canvas,j=h(f,g,i);if(!xa["default"].end(g.handles)&&g.canComplete){var k=e.currentHandle;n(d,k)}else null===j&&m(d);a.preventDefault(),a.stopPropagation()}function p(a){var b=a.detail,c=b.element,d=(0,ja.getToolOptions)(Aa,c);if((0,fa["default"])(b.which,d.mouseButtonMask)){var e=Ca.getConfiguration(),f=e.currentTool;if(f<0)y(a);else{var g=(0,ia.getToolState)(b.element,Aa);f>=0&&g.data[f].active&&o(a,g,f)}}}function q(a){var b=a.detail,c=(0,ia.getToolState)(b.element,Aa);if(c){var d=Ca.getConfiguration(),e=d.currentTool;if(e<0){var f=C(b,c);if(!f)return}else r(b,c);R["default"].cornerstone.updateImage(b.element)}}function r(a,b){var c=Ca.getConfiguration(),d=c.currentTool,e=a.element,f=b.data[d],g=a.currentPoints.canvas;
if(D(a),s(f),c.activePencilMode)l(a,f.handles);else{var i=h(e,f,g);null!==i&&!i.hasBoundingBox&&i<f.handles.length-1&&(c.mouseLocation.handles.start.x=f.handles[i].x,c.mouseLocation.handles.start.y=f.handles[i].y)}}function s(a){var b=Ca.getConfiguration();if(a.handles.length<2)return!0;var c=void 0;c=b.activePencilMode?t(a):u(a),a.handles.invalidHandlePlacement=c}function t(a){var b=Ca.getConfiguration(),c=b.mouseLocation.handles.start,d=a.handles,e=xa["default"].newHandle(c,d);return e===!1&&(e=v(a,c)),e}function u(a){var b=Ca.getConfiguration(),c=b.mouseLocation.handles.start,d=a.handles,e=!1;a.canComplete=!1;var f=R["default"].cornerstoneMath.point.distance(d[0],c)<b.spacing;return f&&!xa["default"].end(d)?(a.canComplete=!0,e=!1):e=xa["default"].newHandle(c,d),e}function v(a,b){var c=Ca.getConfiguration(),d=a.handles;if(R["default"].cornerstoneMath.point.distance(d[0],b)<c.spacing)return a.canComplete=!0,!1;a.canComplete=!1;for(var e=1;e<d.length-1;e++)if(R["default"].cornerstoneMath.point.distance(d[e],b)<c.spacing)return!0;return!1}function w(a){var b=a.detail,c=(0,ia.getToolState)(b.element,Aa);if(c){var d=Ca.getConfiguration(),e=c.data[d.currentTool],f=d.currentHandle;D(b),d.currentTool>=0&&(0,na["default"])(f,e),R["default"].cornerstone.updateImage(b.element)}}function x(a){var b=a.detail,c=b.element,d=(0,ia.getToolState)(b.element,Aa);if(c.removeEventListener(P["default"].MOUSE_UP,x),c.removeEventListener(P["default"].MOUSE_DRAG,w),c.removeEventListener(P["default"].MOUSE_CLICK,x),c.addEventListener(P["default"].MOUSE_MOVE,q),void 0!==d){var e=(0,pa["default"])(a,d);"handle"===e&&n(b),a.preventDefault(),a.stopPropagation(),R["default"].cornerstone.updateImage(b.element)}}function y(a){var b=a.detail,c=i(b);b.event.ctrlKey?(0,ra["default"])(a,c):void 0!==c&&z(a,c)}function z(a,b){var c=a.detail,d=c.element,e=(0,ia.getToolState)(c.element,Aa),f=b.handleNearby;f.hasBoundingBox?A(d,b):void 0!==f&&B(d,b,e),a.preventDefault(),a.stopPropagation()}function A(a,b){var c=Ca.getConfiguration(),d=b.handleNearby,e=b.toolIndex;a.addEventListener(P["default"].MOUSE_UP,x),a.addEventListener(P["default"].MOUSE_DRAG,w),c.movingTextBox=!0,c.currentHandle=d,c.currentTool=e}function B(a,b,c){var d=Ca.getConfiguration(),e=b.handleNearby,f=b.toolIndex;a.removeEventListener(P["default"].MOUSE_MOVE,q),d.dragOrigin={x:c.data[f].handles[e].x,y:c.data[f].handles[e].y},a.addEventListener(P["default"].MOUSE_UP,x),a.addEventListener(P["default"].MOUSE_CLICK,x),a.addEventListener(P["default"].MOUSE_DRAG,w),d.modifying=!0,d.currentHandle=e,d.currentTool=f}function C(a,b){for(var c=!1,d=0;d<b.data.length;d++){var e=a.element,f=b.data[d],h=a.currentPoints.canvas;(0,Z["default"])(e,f.handles,h)===!0&&(c=!0),(g(e,f,h)&&!f.active||!g(e,f,h)&&f.active)&&(f.active=!f.active,c=!0),f.textBox===!0&&(0,_["default"])(f.textBox,h)&&(f.active=!f.active,f.highlight=!f.highlight,c=!0)}return c}function D(a){var b=Ca.getConfiguration();b.mouseLocation.handles.start.x=a.currentPoints.image.x,b.mouseLocation.handles.start.y=a.currentPoints.image.y,(0,ka.clipToBox)(b.mouseLocation.handles.start,a.image)}function E(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}function F(a){function b(a){var b=a.meanStdDev,c=a.meanStdDevSUV,d=a.area,e=[];if(b&&void 0!==b.mean){var f="";"CT"===l&&(f=" HU");var g="Mean: "+E(b.mean.toFixed(2))+f,i="StdDev: "+E(b.stdDev.toFixed(2))+f;if(c&&void 0!==c.mean){var j=" SUV: ";g+=j+E(c.mean.toFixed(2)),i+=j+E(c.stdDev.toFixed(2))}e.push(g),e.push(i)}if(d){var k=" mm"+String.fromCharCode(178);h.rowPixelSpacing&&h.columnPixelSpacing||(k=" pixels"+String.fromCharCode(178));var m="Area: "+E(d.toFixed(2))+k;e.push(m)}return e}function c(a){return a}var d=a.detail,f=(0,ia.getToolState)(a.currentTarget,Aa);if(void 0!==f){var g=R["default"].cornerstone,h=d.image,i=d.element,j=Ca.getConfiguration(),k=g.metaData.get("generalSeriesModule",h.imageId),l=void 0;k&&(l=k.modality);for(var m=(0,za.getNewContext)(d.canvasContext.canvas),n=T["default"].getToolWidth(),o=function(a){var k=f.data[a];return k.visible===!1?"continue":void(0,za.draw)(m,function(a){var f=V["default"].getColorIfActive(k),m=void 0;if(k.active?k.handles.invalidHandlePlacement?(f=j.invalidColor,m=j.invalidColor):(f=V["default"].getColorIfActive(k),m=V["default"].getFillColor()):m=V["default"].getToolColor(),k.handles.length)for(var o=0;o<k.handles.length;o++){var p=[].concat(e(k.handles[o].lines));o!==k.handles.length-1||k.polyBoundingBox||p.push(j.mouseLocation.handles.start),(0,za.drawJoinedLines)(a,d.element,k.handles[o],p,{color:f})}var q={fill:m};(j.alwaysShowHandles||j.keyDown.ctrl||k.active&&k.polyBoundingBox)&&(q.handleRadius=j.activeHandleRadius,(0,X["default"])(a,d,k.handles,f,q)),k.canComplete&&(q.handleRadius=j.completeHandleRadius,(0,X["default"])(a,d,[k.handles[0]],f,q)),k.active&&!k.polyBoundingBox&&(q.handleRadius=j.activeHandleRadius,(0,X["default"])(a,d,j.mouseLocation.handles,f,q),(0,X["default"])(a,d,[k.handles[0]],f,q));var r=void 0,s=void 0,t=void 0;if(k.invalidated===!1)s=k.meanStdDev,t=k.meanStdDevSUV,r=k.area;else if(!k.active){for(var u={left:k.handles[0].x,right:k.handles[0].x,bottom:k.handles[0].y,top:k.handles[0].x},v=0;v<k.handles.length;v++)u.left=Math.min(u.left,k.handles[v].x),u.right=Math.max(u.right,k.handles[v].x),u.bottom=Math.min(u.bottom,k.handles[v].y),u.top=Math.max(u.top,k.handles[v].y);var w={left:u.left,top:u.bottom,width:Math.abs(u.right-u.left),height:Math.abs(u.top-u.bottom)};if(k.polyBoundingBox=w,!h.color){var x=g.getPixels(i,w.left,w.top,w.width,w.height);s=(0,va["default"])(x,w,k.handles),"PT"===l&&(t={mean:(0,ba["default"])(h,(s.mean-h.intercept)/h.slope),stdDev:(0,ba["default"])(h,(s.stdDev-h.intercept)/h.slope)}),s&&!isNaN(s.mean)&&(k.meanStdDev=s,k.meanStdDevSUV=t)}var y=h.columnPixelSpacing||1,z=h.rowPixelSpacing||1,A=y*z;r=(0,ta["default"])(k.handles,A),isNaN(r)||(k.area=r),k.invalidated=!1}if(k.polyBoundingBox&&!k.textBox.freehand){k.textBox.hasMoved||(k.textBox.x=k.polyBoundingBox.left+k.polyBoundingBox.width,k.textBox.y=k.polyBoundingBox.top+k.polyBoundingBox.height/2);var B=b(k);(0,ha["default"])(a,i,k.textBox,B,k.handles,c,f,n,0,!0)}})},p=0;p<f.data.length;p++){o(p)}}}function G(a){L(a),K(a),a.addEventListener(R["default"].cornerstone.EVENTS.IMAGE_RENDERED,F),R["default"].cornerstone.updateImage(a)}function H(a){L(a),K(a),R["default"].cornerstone.updateImage(a)}function I(a,b){(0,ja.setToolOptions)(Aa,a,{mouseButtonMask:b}),K(a),a.addEventListener(R["default"].cornerstone.EVENTS.IMAGE_RENDERED,F),a.addEventListener(P["default"].MOUSE_MOVE,q),a.addEventListener(P["default"].MOUSE_DOWN,p),a.addEventListener(P["default"].MOUSE_DOWN_ACTIVATE,j),a.addEventListener(P["default"].KEY_DOWN,la.keyDownCallback),a.addEventListener(P["default"].KEY_UP,la.keyUpCallback),R["default"].cornerstone.updateImage(a)}function J(a,b){(0,ja.setToolOptions)(Aa,a,{mouseButtonMask:b});var c=P["default"].TOOL_DEACTIVATED,d={mouseButtonMask:b,toolType:Aa,type:c};(0,da["default"])(a,c,d),L(a),K(a),a.addEventListener(R["default"].cornerstone.EVENTS.IMAGE_RENDERED,F),a.addEventListener(P["default"].MOUSE_MOVE,q),a.addEventListener(P["default"].MOUSE_DOWN,p),a.addEventListener(P["default"].KEY_DOWN,la.keyDownCallback),a.addEventListener(P["default"].KEY_UP,la.keyUpCallback),R["default"].cornerstone.updateImage(a)}function K(a){a.removeEventListener(P["default"].MOUSE_DOWN,p),a.removeEventListener(P["default"].MOUSE_DOWN_ACTIVATE,j),a.removeEventListener(P["default"].MOUSE_DRAG,w),a.removeEventListener(P["default"].MOUSE_UP,x),a.removeEventListener(P["default"].MOUSE_MOVE,q),a.removeEventListener(R["default"].cornerstone.EVENTS.IMAGE_RENDERED,F),a.removeEventListener(P["default"].KEY_DOWN,la.keyDownCallback),a.removeEventListener(P["default"].KEY_UP,la.keyUpCallback)}function L(a){var b=Ca.getConfiguration();if(b.currentTool>=0){var c=b.currentHandle;n(a,c)}}function M(){return Ba}function N(a){Ba=a}Object.defineProperty(b,"__esModule",{value:!0}),b.freehand=void 0;var O=c("./events.js"),P=d(O),Q=c("./externalModules.js"),R=d(Q),S=c("./stateManagement/toolStyle.js"),T=d(S),U=c("./stateManagement/toolColors.js"),V=d(U),W=c("./manipulators/drawHandles.js"),X=d(W),Y=c("./manipulators/handleActivator.js"),Z=d(Y),$=c("./util/pointInsideBoundingBox.js"),_=d($),aa=c("./util/calculateSUV.js"),ba=d(aa),ca=c("./util/triggerEvent.js"),da=d(ca),ea=c("./util/isMouseButtonEnabled.js"),fa=d(ea),ga=c("./util/drawLinkedTextBox.js"),ha=d(ga),ia=c("./stateManagement/toolState.js"),ja=c("./toolOptions.js"),ka=c("./util/clip.js"),la=c("./util/freehand/keysHeld.js"),ma=c("./util/freehand/dragObject.js"),na=d(ma),oa=c("./util/freehand/dropObject.js"),pa=d(oa),qa=c("./util/freehand/insertOrDelete.js"),ra=d(qa),sa=c("./util/freehand/freeHandArea.js"),ta=d(sa),ua=c("./util/freehand/calculateFreehandStatistics.js"),va=d(ua),wa=c("./util/freehand/freeHandIntersect.js"),xa=d(wa),ya=c("./util/freehand/FreehandHandleData.js"),za=c("./util/drawing.js"),Aa="freehand",Ba={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},keyDown:{shift:!1,ctrl:!1,alt:!1},activePencilMode:!1,spacing:5,activeHandleRadius:3,completeHandleRadius:6,alwaysShowHandles:!1,invalidColor:"crimson",modifying:!1,movingTextBox:!1,currentHandle:0,currentTool:-1},Ca={enable:G,disable:H,activate:I,deactivate:J,getConfiguration:M,setConfiguration:N,pointNearTool:g};b.freehand=Ca},"./imageTools/freehandSculpter.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.element,d=(0,J.getToolOptions)(P,c),e=S.getConfiguration(),g=!1;return(0,H["default"])(b.which,d.mouseButtonMask)?(b.event.ctrlKey?(f(b),g=!0):null!==e.currentTool&&(h(b),g=!0),void(g&&A["default"].cornerstone.updateImage(b.element))):(a.stopPropagation(),void a.preventDefault())}function f(a){var b=S.getConfiguration(),c=a.element,d=new M.FreehandLineFinder(a),e=d.findTool();b.currentTool=e,g(c,e)}function g(a,b){for(var c=(0,I.getToolState)(a,Q),d=!1,e=0;e<c.data.length;e++)e===b?c.data[e].active=!0:c.data[e].active=!1;return d}function h(a){var b=S.getConfiguration(),c=a.element;i(a),b.active=!0,o(a),c.addEventListener(y["default"].MOUSE_UP,k),c.addEventListener(y["default"].MOUSE_CLICK,k),c.addEventListener(y["default"].MOUSE_DRAG,j)}function i(a){for(var b=S.getConfiguration(),c=b.currentTool,d=(0,I.getToolState)(a.element,Q),e=d.data[c].handles,f=a.currentPoints.image,g=a.currentPoints.canvas,h=1/0,i=1/0,j=0;j<e.length;j++){var k=e[j],l=A["default"].cornerstoneMath.point.distance(k,f);if(l<h){h=l;var m=A["default"].cornerstone.pixelToCanvas(a.element,e[j]);i=A["default"].cornerstoneMath.point.distance(m,g)}}b.toolSizeImage=h,b.toolSizeCanvas=i}function j(a){var b=a.detail,c=(0,I.getToolState)(b.element,Q);if(c){var d=S.getConfiguration(),e=c.data[d.currentTool].handles;o(b),O.sculpt(b,e),A["default"].cornerstone.updateImage(b.element)}}function k(a){var b=a.detail,c=b.element,d=S.getConfiguration();c.removeEventListener(y["default"].MOUSE_UP,k),c.removeEventListener(y["default"].MOUSE_DRAG,j),c.removeEventListener(y["default"].MOUSE_CLICK,k),d.active=!1,a.preventDefault(),a.stopPropagation(),n(b)}function l(a){var b=a.detail,c=b.element;m(c)}function m(a){var b=S.getConfiguration(),c=(0,I.getToolState)(a,Q);if(b.currentTool=null,c)for(var d=0;d<c.data.length;d++)c.data[d].active=!1;A["default"].cornerstone.updateImage(a)}function n(a){var b=S.getConfiguration(),c=a.element,d=(0,I.getToolState)(c,Q),e=d.data[b.currentTool];e.invalidated=!0,A["default"].cornerstone.updateImage(c)}function o(a){var b=S.getConfiguration();b.mouseLocation.handles.start.x=a.currentPoints.image.x,b.mouseLocation.handles.start.y=a.currentPoints.image.y,(0,K.clipToBox)(b.mouseLocation.handles.start,a.image)}function p(a){var b=a.detail,c=b.canvasContext.canvas.getContext("2d"),d=S.getConfiguration();if(d.active){var e={fill:null,handleRadius:d.toolSizeCanvas};(0,F["default"])(c,b,d.mouseLocation.handles,d.color,e)}}function q(a){r(a)}function r(a){m(a),u(a)}function s(a,b){(0,J.setToolOptions)(P,a,{mouseButtonMask:b}),B.freehand.enable(a),u(a),a.addEventListener(A["default"].cornerstone.EVENTS.IMAGE_RENDERED,p),a.addEventListener(y["default"].MOUSE_DOWN,e),a.addEventListener(y["default"].KEY_DOWN,L.keyDownCallback),a.addEventListener(y["default"].KEY_UP,L.keyUpCallback),a.addEventListener(A["default"].cornerstone.EVENTS.NEW_IMAGE,l),a.focus(),A["default"].cornerstone.updateImage(a)}function t(a){r(a)}function u(a){a.removeEventListener(A["default"].cornerstone.EVENTS.IMAGE_RENDERED,p),a.removeEventListener(y["default"].MOUSE_DOWN,e),a.removeEventListener(y["default"].MOUSE_DRAG,j),a.removeEventListener(y["default"].MOUSE_UP,k),a.removeEventListener(y["default"].KEY_DOWN,L.keyDownCallback),a.removeEventListener(y["default"].KEY_UP,L.keyUpCallback),a.removeEventListener(A["default"].cornerstone.EVENTS.NEW_IMAGE,l)}function v(){return R}function w(a){R=a}Object.defineProperty(b,"__esModule",{value:!0}),b.freehandSculpter=void 0;var x=c("./events.js"),y=d(x),z=c("./externalModules.js"),A=d(z),B=c("./imageTools/freehand.js"),C=c("./stateManagement/toolColors.js"),D=d(C),E=c("./manipulators/drawHandles.js"),F=d(E),G=c("./util/isMouseButtonEnabled.js"),H=d(G),I=c("./stateManagement/toolState.js"),J=c("./toolOptions.js"),K=c("./util/clip.js"),L=c("./util/freehand/keysHeld.js"),M=c("./util/freehand/FreehandLineFinder.js"),N=c("./util/freehand/Sculpter.js"),O=new N.Sculpter,P="freehandSculpter",Q="freehand",R={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},keyDown:{shift:!1,ctrl:!1,alt:!1},active:!1,minSpacing:5,maxSpacing:20,toolSizeImage:null,toolSizeCanvas:null,currentTool:null,color:D["default"].getActiveColor()},S={enable:q,disable:r,activate:s,deactivate:t,getConfiguration:v,setConfiguration:w};b.freehandSculpter=S},"./imageTools/highlight.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=(0,s.getToolState)(a.event.currentTarget,u);if(!(b&&b.data&&b.data.length>0)){var c={visible:!0,active:!0,color:void 0,handles:{start:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0}}};return c}}function f(a,b,c){var d=j["default"].cornerstone,e=d.pixelToCanvas(a,b.handles.start),f=d.pixelToCanvas(a,b.handles.end),g={left:Math.min(e.x,f.x),top:Math.min(e.y,f.y),width:Math.abs(e.x-f.x),height:Math.abs(e.y-f.y)},h=!1;return c.x>=g.left&&c.x<=g.left+g.width&&c.y>=g.top&&c.y<=g.top+g.height&&(h=!0),h}function g(a,b,c){if(b.visible===!1)return!1;var d=j["default"].cornerstone,e=d.pixelToCanvas(a,b.handles.start),f=d.pixelToCanvas(a,b.handles.end),g={left:Math.min(e.x,f.x),top:Math.min(e.y,f.y),width:Math.abs(e.x-f.x),height:Math.abs(e.y-f.y)},h=j["default"].cornerstoneMath.rect.distanceToPoint(g,c);return h<5}function h(a){var b=a.detail,c=(0,s.getToolState)(a.currentTarget,u);if(void 0!==c){var d=(0,t.getNewContext)(b.canvasContext.canvas),e=c.data[0];e.visible!==!1&&e&&(0,t.draw)(d,function(a){var c={color:"transparent",fillStyle:"rgba(0,0,0,0.7)"};(0,t.fillOutsideRect)(a,b.element,e.handles.start,e.handles.end,c);var d=p["default"].getColorIfActive(e);c={color:d,lineDash:[4]},(0,t.drawRect)(a,b.element,e.handles.start,e.handles.end,c),(0,r["default"])(a,b,e.handles,d)})}}Object.defineProperty(b,"__esModule",{value:!0}),b.highlightTouch=b.highlight=void 0;var i=c("./externalModules.js"),j=d(i),k=c("./imageTools/mouseButtonRectangleTool.js"),l=d(k),m=c("./imageTools/touchTool.js"),n=d(m),o=c("./stateManagement/toolColors.js"),p=d(o),q=c("./manipulators/drawHandles.js"),r=d(q),s=c("./stateManagement/toolState.js"),t=c("./util/drawing.js"),u="highlight",v=!0,w=(0,l["default"])({createNewMeasurement:e,onImageRendered:h,pointNearTool:g,pointInsideRect:f,toolType:u},v),x=(0,n["default"])({createNewMeasurement:e,onImageRendered:h,pointNearTool:g,pointInsideRect:f,toolType:u},v);b.highlight=w,b.highlightTouch=x},"./imageTools/imageStats.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.image,d=c.stats,e=(0,j.getNewContext)(b.canvasContext.canvas),f=[];Object.keys(d).forEach(function(a){var b=a+" : "+d[a];f.push(b)}),(0,i["default"])(e,f,0,0,"orange"),f.forEach(function(a){console.log(a)})}Object.defineProperty(b,"__esModule",{value:!0});var f=c("./imageTools/displayTool.js"),g=d(f),h=c("./util/drawTextBox.js"),i=d(h),j=c("./util/drawing.js"),k=(0,g["default"])(e);b["default"]=k},"./imageTools/keyboardTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){var b={};return{activate:function(b){b.removeEventListener(f["default"].KEY_DOWN,a),b.addEventListener(f["default"].KEY_DOWN,a)},disable:function(b){b.removeEventListener(f["default"].KEY_DOWN,a)},enable:function(b){b.removeEventListener(f["default"].KEY_DOWN,a)},deactivate:function(b){b.removeEventListener(f["default"].KEY_DOWN,a)},getConfiguration:function(){return b},setConfiguration:function(a){b=a}}};var e=c("./events.js"),f=d(e)},"./imageTools/length.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b={visible:!0,active:!0,color:void 0,handles:{start:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};return b}function f(a,b,c){return b.visible!==!1&&(0,x["default"])(a,b.handles.start,b.handles.end,c)<25}function g(a){function b(a,b,c){var d=" mm";return b&&c||(d=" pixels"),""+a.length.toFixed(2)+d}function c(a){var b={x:(a.start.x+a.end.x)/2,y:(a.start.y+a.end.y)/2};return[a.start,b,a.end]}var d=a.detail,e=(0,v.getToolState)(a.currentTarget,z);if(e){var f=i["default"].cornerstone,g=(0,y.getNewContext)(d.canvasContext.canvas),h=d.image,j=d.element,k=q["default"].getToolWidth(),l=A.getConfiguration(),m=f.metaData.get("imagePlaneModule",h.imageId),n=void 0,p=void 0;m?(n=m.rowPixelSpacing||m.rowImagePixelSpacing,p=m.columnPixelSpacing||m.colImagePixelSpacing):(n=h.rowPixelSpacing,p=h.columnPixelSpacing);for(var r=function(a){var f=e.data[a];return f.visible===!1?"continue":void(0,y.draw)(g,function(a){(0,y.setShadow)(a,l);var e=s["default"].getColorIfActive(f);(0,y.drawLine)(a,j,f.handles.start,f.handles.end,{color:e});var g={drawHandlesIfActive:l&&l.drawHandlesOnHover};(0,u["default"])(a,d,f.handles,e,g);var h=(f.handles.end.x-f.handles.start.x)*(p||1),i=(f.handles.end.y-f.handles.start.y)*(n||1),m=Math.sqrt(h*h+i*i);if(f.length=m,!f.handles.textBox.hasMoved){var q={x:Math.max(f.handles.start.x,f.handles.end.x)};q.x===f.handles.start.x?q.y=f.handles.start.y:q.y=f.handles.end.y,f.handles.textBox.x=q.x,f.handles.textBox.y=q.y}var r=10,t=b(f,n,p);(0,o["default"])(a,j,f.handles.textBox,t,f.handles,c,e,k,r,!0)})},t=0;t<e.data.length;t++){r(t)}}}Object.defineProperty(b,"__esModule",{value:!0}),b.lengthTouch=b.length=void 0;var h=c("./externalModules.js"),i=d(h),j=c("./imageTools/mouseButtonTool.js"),k=d(j),l=c("./imageTools/touchTool.js"),m=d(l),n=c("./util/drawLinkedTextBox.js"),o=d(n),p=c("./stateManagement/toolStyle.js"),q=d(p),r=c("./stateManagement/toolColors.js"),s=d(r),t=c("./manipulators/drawHandles.js"),u=d(t),v=c("./stateManagement/toolState.js"),w=c("./util/lineSegDistance.js"),x=d(w),y=c("./util/drawing.js"),z="length",A=(0,k["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:z}),B=(0,m["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:z});b.length=A,b.lengthTouch=B},"./imageTools/magnify.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.element;c.removeEventListener(x["default"].MOUSE_DRAG,j),c.removeEventListener(x["default"].MOUSE_UP,e),c.removeEventListener(x["default"].MOUSE_CLICK,e),f(b)}function f(a){var b=a.element;b.querySelector(".magnifyTool").style.display="none",document.body.style.cursor="default",o()}function g(a){var b=a.detail,c=b.element,d=(0,D.getToolOptions)(G,c);(a.isTouchEvent||(0,C["default"])(b.which,d.mouseButtonMask))&&(c.addEventListener(x["default"].MOUSE_DRAG,j),c.addEventListener(x["default"].TOUCH_DRAG,j),c.addEventListener(x["default"].MOUSE_UP,e),c.addEventListener(x["default"].TOUCH_END,e),c.addEventListener(x["default"].MOUSE_CLICK,e),c.addEventListener(z["default"].cornerstone.EVENTS.NEW_IMAGE,h),n(b),window.requestAnimationFrame(function(){return k(b)}),a.preventDefault(),a.stopPropagation())}function h(a){var b=a.detail;b.currentPoints=J,k(b)}function i(a){var b=a.detail,c=b.element;c.removeEventListener(x["default"].TOUCH_DRAG_END,i),c.removeEventListener(x["default"].TOUCH_END,i),c.removeEventListener(z["default"].cornerstone.EVENTS.NEW_IMAGE,h),f(b)}function j(a){var b=a.detail,c=b.element;k(b),b.isTouchEvent===!0&&(c.addEventListener(x["default"].TOUCH_DRAG_END,i),c.addEventListener(x["default"].TOUCH_END,i)),a.preventDefault(),a.stopPropagation()}function k(a){var b=a.element,c=b.querySelector(".magnifyTool");if(c||l(a.element),void 0!==K){var d=M.getConfiguration(),e=d.magnifySize,f=d.magnificationLevel,g=b.querySelector("canvas:not(.magnifyTool)"),h=(0,F.getNewContext)(c),i=e,j=z["default"].cornerstone.pixelToCanvas(a.element,a.currentPoints.image);(0,E.clipToBox)(j,g),h.clearRect(0,0,e,e);var k={left:0,top:0,width:e,height:e};(0,F.fillBox)(h,k,"transparent");var m={x:j.x*f-.5*i,y:j.y*f-.5*i};"Safari"===I&&(m.x=Math.max(m.x,0),m.y=Math.max(m.y,0)),m.x=Math.min(m.x,K.width),m.y=Math.min(m.y,K.height),h.drawImage(K,m.x,m.y,i,i,0,0,i,i),c.style.top=j.y-.5*e+"px",c.style.left=j.x-.5*e+"px",a.isTouchEvent&&(c.style.top=j.y-.5*e-120+"px"),c.style.display="block",document.body.style.cursor="none"}}function l(a){if(null===a.querySelector(".magnifyTool")){var b=document.createElement("canvas");b.classList.add("magnifyTool");var c=M.getConfiguration();b.width=c.magnifySize,b.height=c.magnifySize,b.style.position="absolute",b.style.display="none",a.appendChild(b)}}function m(a){var b=a.querySelector(".magnifyTool");b&&a.removeChild(b)}function n(a){o();var b=a.enabledElement;void 0===b&&(b=z["default"].cornerstone.getEnabledElement(a.element));var c=M.getConfiguration(),d=c.magnificationLevel,e=b.canvas,f=b.image;L=document.createElement("div"),L.width=e.width*d,L.height=e.height*d,z["default"].cornerstone.enable(L,b.options);var g=z["default"].cornerstone.getEnabledElement(L),h=z["default"].cornerstone.getViewport(b.element);K=g.canvas,K.width=e.width*d,K.height=e.height*d,g.viewport=Object.assign({},h),h.scale*=d,z["default"].cornerstone.displayImage(L,f),z["default"].cornerstone.setViewport(L,h)}function o(){void 0!==L&&(z["default"].cornerstone.disable(L),L=void 0,K=void 0)}function p(a){a.removeEventListener(x["default"].MOUSE_DOWN,g),m(a)}function q(a){var b=M.getConfiguration(b);if(!I){var c=(0,A.getBrowserInfo)(),d=c.split(" ");I=d[0]}l(a)}function r(a,b){(0,D.setToolOptions)(G,a,{mouseButtonMask:b}),a.removeEventListener(x["default"].MOUSE_DOWN,g),a.addEventListener(x["default"].MOUSE_DOWN,g),l(a)}function s(){return H}function t(a){H=a}function u(a){a.removeEventListener(x["default"].TOUCH_START,g),a.addEventListener(x["default"].TOUCH_START,g)}function v(a){a.removeEventListener(x["default"].TOUCH_START,g)}Object.defineProperty(b,"__esModule",{value:!0}),b.magnifyTouchDrag=b.magnify=void 0;var w=c("./events.js"),x=d(w),y=c("./externalModules.js"),z=d(y),A=c("./util/getMaxSimultaneousRequests.js"),B=c("./util/isMouseButtonEnabled.js"),C=d(B),D=c("./toolOptions.js"),E=c("./util/clip.js"),F=c("./util/drawing.js"),G="magnify",H={magnifySize:300,magnificationLevel:5},I=void 0,J=void 0,K=void 0,L=void 0,M={enable:q,activate:r,deactivate:p,disable:p,getConfiguration:s,setConfiguration:t},N={activate:u,deactivate:v,enable:u,disable:v};b.magnify=M,b.magnifyTouchDrag=N},"./imageTools/mouseButtonRectangleTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){function c(c){var d=c.element,g=a.createNewMeasurement(c);g&&((0,w.addToolState)(c.element,q,g),d.removeEventListener(f["default"].MOUSE_MOVE,e),(0,p["default"])(c,q,g,g.handles.end,function(){g.active=!1,(0,t["default"])(c,g.handles)&&(0,w.removeToolState)(c.element,q,g),d.addEventListener(f["default"].MOUSE_MOVE,e)},b))}function d(a){var b=a.detail,d=b.element,e=(0,x.getToolOptions)(q,d);if((0,v["default"])(b.which,e.mouseButtonMask))return c(b),!1}function e(b){var c=b.detail;j["default"].setCoords(c);var d=(0,w.getToolState)(c.element,q);if(void 0!==d){for(var e=!1,f=c.currentPoints.canvas,g=0;g<d.data.length;g++){var i=d.data[g];(0,n["default"])(c.element,i.handles,f)===!0&&(e=!0),(a.pointInsideRect(c.element,i,f)&&!i.active||!a.pointInsideRect(c.element,i,f)&&i.active)&&(i.active=!i.active,e=!0)}e===!0&&h["default"].cornerstone.updateImage(c.element)}}function g(c){function d(){k.active=!1,(0,t["default"])(g,k.handles)&&(0,w.removeToolState)(g.element,q,k),j.updateImage(g.element),i.addEventListener(f["default"].MOUSE_MOVE,e)}var g=c.detail,i=g.element,j=h["default"].cornerstone,k=void 0,m=(0,x.getToolOptions)(q,i);if((0,v["default"])(g.which,m.mouseButtonMask)){var n=g.startPoints.canvas,o=(0,w.getToolState)(c.currentTarget,q),s=void 0,u=25;if(void 0!==o)for(s=0;s<o.data.length;s++){k=o.data[s];var y=(0,l["default"])(g.element,k.handles,n,u);if(void 0!==y)return i.removeEventListener(f["default"].MOUSE_MOVE,e),k.active=!0,(0,p["default"])(g,q,k,y,d,b),c.stopImmediatePropagation(),!1}var z={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:b};if(void 0!==o&&void 0!==a.pointInsideRect)for(s=0;s<o.data.length;s++)if(k=o.data[s],a.pointInsideRect(g.element,k,n))return i.removeEventListener(f["default"].MOUSE_MOVE,e),(0,r["default"])(c,k,o,q,z,d),i.addEventListener(f["default"].MOUSE_MOVE,e),c.stopImmediatePropagation(),!1}}function i(b){b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,e),b.removeEventListener(f["default"].MOUSE_DOWN,g),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,d),h["default"].cornerstone.updateImage(b)}function k(b){b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,e),b.removeEventListener(f["default"].MOUSE_DOWN,g),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,d),b.addEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),h["default"].cornerstone.updateImage(b)}function m(b,c){(0,x.setToolOptions)(q,b,{mouseButtonMask:c}),b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,e),b.removeEventListener(f["default"].MOUSE_DOWN,g),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,d),b.addEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.addEventListener(f["default"].MOUSE_MOVE,e),b.addEventListener(f["default"].MOUSE_DOWN,g),b.addEventListener(f["default"].MOUSE_DOWN_ACTIVATE,d),h["default"].cornerstone.updateImage(b)}function o(b,c){(0,x.setToolOptions)(q,b,{mouseButtonMask:c}),b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,e),b.removeEventListener(f["default"].MOUSE_DOWN,g),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,d),b.addEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.addEventListener(f["default"].MOUSE_MOVE,e),b.addEventListener(f["default"].MOUSE_DOWN,g),h["default"].cornerstone.updateImage(b)}var q=a.toolType,s={enable:k,disable:i,activate:m,deactivate:o};return s};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./stateManagement/toolCoordinates.js"),j=d(i),k=c("./manipulators/getHandleNearImagePoint.js"),l=d(k),m=c("./manipulators/handleActivator.js"),n=d(m),o=c("./manipulators/moveHandle.js"),p=d(o),q=c("./manipulators/moveAllHandles.js"),r=d(q),s=c("./manipulators/anyHandlesOutsideImage.js"),t=d(s),u=c("./util/isMouseButtonEnabled.js"),v=d(u),w=c("./stateManagement/toolState.js"),x=c("./toolOptions.js")},"./imageTools/mouseButtonTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){function b(b){var c=b.detail,d=c.element,f=(0,B.getToolOptions)(u,d);(0,x["default"])(c.which,f.mouseButtonMask)&&(a.addNewMeasurement?a.addNewMeasurement(c):e(c),b.preventDefault(),b.stopPropagation())}function c(b){var c=b.detail;j["default"].setCoords(c);var d=(0,y.getToolState)(c.element,u);if(d){for(var e=!1,f=0;f<d.data.length;f++){var g=c.currentPoints.canvas,i=d.data[f];(0,n["default"])(c.element,i.handles,g)===!0&&(e=!0),(a.pointNearTool(c.element,i,g)&&!i.active||!a.pointNearTool(c.element,i,g)&&i.active)&&(i.active=!i.active,e=!0)}e===!0&&h["default"].cornerstone.updateImage(c.element)}}function d(b){function c(){e.invalidated=!0,(0,v["default"])(d,e.handles)&&(0,y.removeToolState)(g,u,e),h["default"].cornerstone.updateImage(g),g.addEventListener(f["default"].MOUSE_MOVE,w)}var d=b.detail,e=void 0,g=d.element,i=(0,B.getToolOptions)(u,g);if((0,x["default"])(d.which,i.mouseButtonMask)){var j=d.startPoints.canvas,k=(0,y.getToolState)(b.currentTarget,u);if(k){var m=void 0,n=void 0;for(n=!(!a.options||void 0===a.options.preventHandleOutsideImage)&&a.options.preventHandleOutsideImage,m=0;m<k.data.length;m++){e=k.data[m];var o=6,q=(0,l["default"])(g,e.handles,j,o);if(q)return g.removeEventListener(f["default"].MOUSE_MOVE,w),e.active=!0,(0,p["default"])(d,u,e,q,c,n),b.stopImmediatePropagation(),b.stopPropagation(),void b.preventDefault()}if(a.pointNearTool){var r=a.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(m=0;m<k.data.length;m++)if(e=k.data[m],e.active=!1,a.pointNearTool(g,e,j))return e.active=!0,g.removeEventListener(f["default"].MOUSE_MOVE,w),(0,t["default"])(b,e,k,u,r,c),b.stopImmediatePropagation(),b.stopPropagation(),void b.preventDefault()}}}}function e(b){var c=h["default"].cornerstone,d=b.element,e=a.createNewMeasurement(b);if(e){(0,y.addToolState)(b.element,u,e),d.removeEventListener(f["default"].MOUSE_MOVE,w),d.removeEventListener(f["default"].MOUSE_DOWN,z),d.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,C),D&&d.removeEventListener(f["default"].MOUSE_DOUBLE_CLICK,D),c.updateImage(d);var g=void 0;g=1===Object.keys(e.handles).length?p["default"]:r["default"];var i=void 0;i=!(!a.options||void 0===a.options.preventHandleOutsideImage)&&a.options.preventHandleOutsideImage,g(b,u,e,e.handles.end,function(){e.active=!1,e.invalidated=!0,(0,v["default"])(b,e.handles)&&(0,y.removeToolState)(d,u,e),d.addEventListener(f["default"].MOUSE_MOVE,w),d.addEventListener(f["default"].MOUSE_DOWN,z),d.addEventListener(f["default"].MOUSE_DOWN_ACTIVATE,C),D&&d.addEventListener(f["default"].MOUSE_DOUBLE_CLICK,D),c.updateImage(d)},i)}}function g(b){b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,w),b.removeEventListener(f["default"].MOUSE_DOWN,z),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,C),D&&b.removeEventListener(f["default"].MOUSE_DOUBLE_CLICK,D),h["default"].cornerstone.updateImage(b)}function i(b){b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,w),b.removeEventListener(f["default"].MOUSE_DOWN,z),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,C),D&&b.removeEventListener(f["default"].MOUSE_DOUBLE_CLICK,D),b.addEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),
h["default"].cornerstone.updateImage(b)}function k(b,c){(0,B.setToolOptions)(u,b,{mouseButtonMask:c}),b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,w),b.removeEventListener(f["default"].MOUSE_DOWN,z),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,C),b.addEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.addEventListener(f["default"].MOUSE_MOVE,w),b.addEventListener(f["default"].MOUSE_DOWN,z),b.addEventListener(f["default"].MOUSE_DOWN_ACTIVATE,C),D&&(b.removeEventListener(f["default"].MOUSE_DOUBLE_CLICK,D),b.addEventListener(f["default"].MOUSE_DOUBLE_CLICK,D)),h["default"].cornerstone.updateImage(b)}function m(b,c){(0,B.setToolOptions)(u,b,{mouseButtonMask:c});var d=f["default"].TOOL_DEACTIVATED,e={mouseButtonMask:c,toolType:u,type:d};(0,A["default"])(b,d,e),b.removeEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(f["default"].MOUSE_MOVE,w),b.removeEventListener(f["default"].MOUSE_DOWN,z),b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,C),b.addEventListener(h["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.addEventListener(f["default"].MOUSE_MOVE,w),b.addEventListener(f["default"].MOUSE_DOWN,z),D&&(b.removeEventListener(f["default"].MOUSE_DOUBLE_CLICK,D),b.addEventListener(f["default"].MOUSE_DOUBLE_CLICK,D)),a.deactivate&&a.deactivate(b,c),h["default"].cornerstone.updateImage(b)}function o(){return s}function q(a){s=a}var s={},u=a.toolType,w=a.mouseMoveCallback||c,z=a.mouseDownCallback||d,C=a.mouseDownActivateCallback||b,D=a.mouseDoubleClickCallback,E={enable:i,disable:g,activate:k,deactivate:m,getConfiguration:o,setConfiguration:q,mouseDownCallback:d,mouseMoveCallback:c,mouseDownActivateCallback:b};return a.pointNearTool&&(E.pointNearTool=a.pointNearTool),D&&(E.mouseDoubleClickCallback=D),a.addNewMeasurement&&(E.addNewMeasurement=a.addNewMeasurement),E};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./stateManagement/toolCoordinates.js"),j=d(i),k=c("./manipulators/getHandleNearImagePoint.js"),l=d(k),m=c("./manipulators/handleActivator.js"),n=d(m),o=c("./manipulators/moveHandle.js"),p=d(o),q=c("./manipulators/moveNewHandle.js"),r=d(q),s=c("./manipulators/moveAllHandles.js"),t=d(s),u=c("./manipulators/anyHandlesOutsideImage.js"),v=d(u),w=c("./util/isMouseButtonEnabled.js"),x=d(w),y=c("./stateManagement/toolState.js"),z=c("./util/triggerEvent.js"),A=d(z),B=c("./toolOptions.js")},"./imageTools/mouseWheelTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){return{activate:function(b){b.removeEventListener(f["default"].MOUSE_WHEEL,a),b.addEventListener(f["default"].MOUSE_WHEEL,a)},disable:function(b){b.removeEventListener(f["default"].MOUSE_WHEEL,a)},enable:function(b){b.removeEventListener(f["default"].MOUSE_WHEEL,a)},deactivate:function(b){b.removeEventListener(f["default"].MOUSE_WHEEL,a)}}};var e=c("./events.js"),f=d(e)},"./imageTools/multiTouchDragTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c={},d=[f["default"].MULTI_TOUCH_DRAG];return b&&b.fireOnTouchStart===!0&&d.push(f["default"].MULTI_TOUCH_START),{activate:function(c){d.forEach(function(b){c.removeEventListener(b,a),c.addEventListener(b,a)}),b&&b.activateCallback&&b.activateCallback(c)},disable:function(c){d.forEach(function(b){c.removeEventListener(b,a)}),b&&b.disableCallback&&b.disableCallback(c)},enable:function(c){d.forEach(function(b){c.removeEventListener(b,a)}),b&&b.enableCallback&&b.enableCallback(c)},deactivate:function(c){d.forEach(function(b){c.removeEventListener(b,a)}),b&&b.deactivateCallback&&b.deactivateCallback(c)},getConfiguration:function(){return c},setConfiguration:function(a){c=a}}};var e=c("./events.js"),f=d(e)},"./imageTools/orientationMarkers.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=i["default"].cornerstone,c=b.getEnabledElement(a),d=b.metaData.get("imagePlaneModule",c.image.imageId);if(d&&d.rowCosines&&d.columnCosines){var e=k["default"].getOrientationString(d.rowCosines),f=k["default"].getOrientationString(d.columnCosines),g=k["default"].invertOrientationString(e),h=k["default"].invertOrientationString(f);return{top:h,bottom:f,left:g,right:e}}}function f(a){var b=i["default"].cornerstone,c=b.getEnabledElement(a),d=void 0;d={x:c.image.width/2,y:5};var e=b.pixelToCanvas(a,d);d={x:c.image.width/2,y:c.image.height-5};var f=b.pixelToCanvas(a,d);d={x:5,y:c.image.height/2};var g=b.pixelToCanvas(a,d);d={x:c.image.width-10,y:c.image.height/2};var h=b.pixelToCanvas(a,d);return{top:e,bottom:f,left:g,right:h}}function g(a){var b=a.detail,c=b.element,d=e(c);if(d){var g=f(c,d),h=(0,r.getNewContext)(b.canvasContext.canvas),i=o["default"].getToolColor(),j={top:(0,p.textBoxWidth)(h,d.top,0),left:(0,p.textBoxWidth)(h,d.left,0),right:(0,p.textBoxWidth)(h,d.right,0),bottom:(0,p.textBoxWidth)(h,d.bottom,0)};(0,q["default"])(h,d.top,g.top.x-j.top/2,g.top.y,i),(0,q["default"])(h,d.left,g.left.x-j.left/2,g.left.y,i);var k=s.getConfiguration();k&&k.drawAllMarkers&&((0,q["default"])(h,d.right,g.right.x-j.right/2,g.right.y,i),(0,q["default"])(h,d.bottom,g.bottom.x-j.bottom/2,g.bottom.y,i))}}Object.defineProperty(b,"__esModule",{value:!0});var h=c("./externalModules.js"),i=d(h),j=c("./orientation/index.js"),k=d(j),l=c("./imageTools/displayTool.js"),m=d(l),n=c("./stateManagement/toolColors.js"),o=d(n),p=c("./util/drawTextBox.js"),q=d(p),r=c("./util/drawing.js"),s=(0,m["default"])(g);b["default"]=s},"./imageTools/pan.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.element;c.removeEventListener(i["default"].MOUSE_DRAG,g),c.removeEventListener(i["default"].MOUSE_UP,e),c.removeEventListener(i["default"].MOUSE_CLICK,e)}function f(a){var b=a.detail,c=b.element,d=(0,r.getToolOptions)(s,c);(0,q["default"])(b.which,d.mouseButtonMask)&&(c.addEventListener(i["default"].MOUSE_DRAG,g),c.addEventListener(i["default"].MOUSE_UP,e),c.addEventListener(i["default"].MOUSE_CLICK,e),a.preventDefault(),a.stopPropagation())}function g(a){var b=a.detail,c=b.viewport.scale,d=b.viewport.scale,e=b.image.columnPixelSpacing||1,f=b.image.rowPixelSpacing||1;f<e?c*=e/f:e<f&&(d*=f/e),b.viewport.translation.x+=b.deltaPoints.page.x/c,b.viewport.translation.y+=b.deltaPoints.page.y/d,k["default"].cornerstone.setViewport(b.element,b.viewport),a.preventDefault(),a.stopPropagation()}Object.defineProperty(b,"__esModule",{value:!0}),b.panTouchDrag=b.pan=void 0;var h=c("./events.js"),i=d(h),j=c("./externalModules.js"),k=d(j),l=c("./imageTools/simpleMouseButtonTool.js"),m=d(l),n=c("./imageTools/touchDragTool.js"),o=d(n),p=c("./util/isMouseButtonEnabled.js"),q=d(p),r=c("./toolOptions.js"),s="pan",t=(0,m["default"])(f,s),u=(0,o["default"])(g,s);b.pan=t,b.panTouchDrag=u},"./imageTools/panMultiTouch.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=k.getConfiguration();c&&c.testPointers(b)&&(b.viewport.translation.x+=b.deltaPoints.page.x/b.viewport.scale,b.viewport.translation.y+=b.deltaPoints.page.y/b.viewport.scale,g["default"].cornerstone.setViewport(b.element,b.viewport),a.preventDefault(),a.stopPropagation())}Object.defineProperty(b,"__esModule",{value:!0});var f=c("./externalModules.js"),g=d(f),h=c("./imageTools/multiTouchDragTool.js"),i=d(h),j={testPointers:function(a){return a.numPointers>=2}},k=(0,i["default"])(e);k.setConfiguration(j),b["default"]=k},"./imageTools/probe.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b={visible:!0,active:!0,color:void 0,handles:{end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0}}};return b}function f(a,b,c){if(b.visible===!1)return!1;var d=i["default"].cornerstone.pixelToCanvas(a,b.handles.end);return i["default"].cornerstoneMath.point.distance(d,c)<5}function g(a){var b=a.detail,c=(0,z.getToolState)(a.currentTarget,B);if(c)for(var d=i["default"].cornerstone,e=(0,A.getNewContext)(b.canvasContext.canvas),f=q["default"].getFontSize(),g=function(a){var g=c.data[a];return g.visible===!1?"continue":void(0,A.draw)(e,function(a){var c=o["default"].getColorIfActive(g);(0,s["default"])(a,b,g.handles,c);var e=Math.round(g.handles.end.x),h=Math.round(g.handles.end.y),i=void 0,j=void 0,k=void 0;if(e>=0&&h>=0&&e<b.image.columns&&h<b.image.rows){if(b.image.color)j=e+", "+h,i=(0,w["default"])(b.element,e,h,1,1),k="R: "+i[0]+" G: "+i[1]+" B: "+i[2];else{i=d.getStoredPixels(b.element,e,h,1,1);var l=i[0],m=l*b.image.slope+b.image.intercept,n=(0,y["default"])(b.image,l);j=e+", "+h,k="SP: "+l+" MO: "+parseFloat(m.toFixed(3)),n&&(k+=" SUV: "+parseFloat(n.toFixed(3)))}var p={x:g.handles.end.x+3,y:g.handles.end.y-3},q=d.pixelToCanvas(b.element,p);(0,u["default"])(a,k,q.x,q.y+f+5,c),(0,u["default"])(a,j,q.x,q.y,c)}})},h=0;h<c.data.length;h++){g(h)}}Object.defineProperty(b,"__esModule",{value:!0}),b.probeTouch=b.probe=void 0;var h=c("./externalModules.js"),i=d(h),j=c("./imageTools/mouseButtonTool.js"),k=d(j),l=c("./imageTools/touchTool.js"),m=d(l),n=c("./stateManagement/toolColors.js"),o=d(n),p=c("./stateManagement/textStyle.js"),q=d(p),r=c("./manipulators/drawHandles.js"),s=d(r),t=c("./util/drawTextBox.js"),u=d(t),v=c("./util/getRGBPixels.js"),w=d(v),x=c("./util/calculateSUV.js"),y=d(x),z=c("./stateManagement/toolState.js"),A=c("./util/drawing.js"),B="probe",C=(0,k["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:B}),D=(0,m["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:B});b.probe=C,b.probeTouch=D},"./imageTools/rectangleRoi.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{start:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};return b}function f(a,b,c){if(b.visible===!1)return!1;var d=k["default"].cornerstone,e=d.pixelToCanvas(a,b.handles.start),f=d.pixelToCanvas(a,b.handles.end),g={left:Math.min(e.x,f.x),top:Math.min(e.y,f.y),width:Math.abs(e.x-f.x),height:Math.abs(e.y-f.y)},h=k["default"].cornerstoneMath.rect.distanceToPoint(g,c);return h<5}function g(a,b){for(var c=0,d=0,e=0,f=0,g=b.top;g<b.top+b.height;g++)for(var h=b.left;h<b.left+b.width;h++)c+=a[f],d+=a[f]*a[f],e++,f++;if(0===e)return{count:e,mean:0,variance:0,stdDev:0};var i=c/e,j=d/e-i*i;return{count:e,mean:i,variance:j,stdDev:Math.sqrt(j)}}function h(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}function i(a){function b(a){var b=a.meanStdDev,c=a.meanStdDevSUV,d=a.area,e=[];if(b&&b.mean){var f="";"CT"===p&&(f=" HU");var g="Mean: "+h(b.mean.toFixed(2))+f,i="StdDev: "+h(b.stdDev.toFixed(2))+f;if(c&&void 0!==c.mean){var j=" SUV: ";g+=j+h(c.mean.toFixed(2)),i+=j+h(c.stdDev.toFixed(2))}e.push(g),e.push(i)}if(d){var k=" mm"+String.fromCharCode(178);r&&t||(k=" pixels"+String.fromCharCode(178));var l="Area: "+h(d.toFixed(2))+k;e.push(l)}return e}function c(a){var b=Math.min(a.start.x,a.end.x),c=Math.min(a.start.y,a.end.y),d=Math.abs(a.start.x-a.end.x),e=Math.abs(a.start.y-a.end.y);return[{x:b+d/2,y:c},{x:b,y:c+e/2},{x:b+d/2,y:c+e},{x:b+d,y:c+e/2}]}var d=a.detail,e=(0,x.getToolState)(a.currentTarget,B);if(e){var f=k["default"].cornerstone,i=d.image,j=d.element,l=q["default"].getToolWidth(),m=C.getConfiguration(),n=f.metaData.get("generalSeriesModule",i.imageId),o=f.metaData.get("imagePlaneModule",i.imageId),p=void 0,r=void 0,t=void 0;o?(r=o.rowPixelSpacing||o.rowImagePixelSpacing,t=o.columnPixelSpacing||o.colImagePixelSpacing):(r=i.rowPixelSpacing,t=i.columnPixelSpacing),n&&(p=n.modality);for(var v=(0,A.getNewContext)(d.canvasContext.canvas),y=function(a){var h=e.data[a];return h.visible===!1?"continue":void(0,A.draw)(v,function(a){(0,A.setShadow)(a,m);var e=s["default"].getColorIfActive(h);if((0,A.drawRect)(a,j,h.handles.start,h.handles.end,{color:e}),m&&m.drawHandlesOnHover)if(h.active===!0)(0,u["default"])(a,d,h.handles,e);else{var k={drawHandlesIfActive:!0};(0,u["default"])(a,d,h.handles,e,k)}else(0,u["default"])(a,d,h.handles,e);var n=void 0,o=void 0,q=void 0;if(h.invalidated===!1)o=h.meanStdDev,q=h.meanStdDevSUV,n=h.area;else{var v={left:Math.min(h.handles.start.x,h.handles.end.x),top:Math.min(h.handles.start.y,h.handles.end.y),width:Math.abs(h.handles.start.x-h.handles.end.x),height:Math.abs(h.handles.start.y-h.handles.end.y)};if(!i.color){var x=f.getPixels(j,v.left,v.top,v.width,v.height);o=g(x,v),"PT"===p&&(q={mean:(0,w["default"])(i,(o.mean-i.intercept)/i.slope),stdDev:(0,w["default"])(i,(o.stdDev-i.intercept)/i.slope)}),o&&!isNaN(o.mean)&&(h.meanStdDev=o,h.meanStdDevSUV=q)}n=v.width*(t||1)*(v.height*(r||1)),isNaN(n)||(h.area=n),h.invalidated=!1}var y=b(h);h.handles.textBox.hasMoved||(h.handles.textBox.x=Math.max(h.handles.start.x,h.handles.end.x),h.handles.textBox.y=(h.handles.start.y+h.handles.end.y)/2),(0,z["default"])(a,j,h.handles.textBox,y,h.handles,c,e,l,0,!0)})},D=0;D<e.data.length;D++){y(D)}}}Object.defineProperty(b,"__esModule",{value:!0}),b.rectangleRoiTouch=b.rectangleRoi=void 0;var j=c("./externalModules.js"),k=d(j),l=c("./imageTools/mouseButtonTool.js"),m=d(l),n=c("./imageTools/touchTool.js"),o=d(n),p=c("./stateManagement/toolStyle.js"),q=d(p),r=c("./stateManagement/toolColors.js"),s=d(r),t=c("./manipulators/drawHandles.js"),u=d(t),v=c("./util/calculateSUV.js"),w=d(v),x=c("./stateManagement/toolState.js"),y=c("./util/drawLinkedTextBox.js"),z=d(y),A=c("./util/drawing.js"),B="rectangleRoi",C=(0,m["default"])({createNewMeasurement:e,onImageRendered:i,pointNearTool:f,toolType:B}),D=(0,o["default"])({createNewMeasurement:e,onImageRendered:i,pointNearTool:f,toolType:B});b.rectangleRoi=C,b.rectangleRoiTouch=D},"./imageTools/rotate.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=a.element.getBoundingClientRect(a.element),e=a.element.clientWidth,f=a.element.clientHeight,g=a.viewport.scale,h=a.viewport.translation,i={x:d.left+e/2+h.x*g,y:d.top+f/2+h.y*g},j={x:a.currentPoints.client.x,y:a.currentPoints.client.y},k=i,l=b,m=j,o=Math.sqrt(Math.pow(k.x-l.x,2)+Math.pow(k.y-l.y,2)),p=Math.sqrt(Math.pow(k.x-m.x,2)+Math.pow(k.y-m.y,2)),q=Math.sqrt(Math.pow(l.x-m.x,2)+Math.pow(l.y-m.y,2)),r=180*Math.acos((Math.pow(o,2)+Math.pow(p,2)-Math.pow(q,2))/(2*o*p))/Math.PI,s=(l.x-k.x)*(m.y-k.y)-(l.y-k.y)*(m.x-k.x);s<0&&(r=-r),a.viewport.rotation=c+r,n["default"].cornerstone.setViewport(a.element,a.viewport)}function f(a){a.viewport.rotation+=a.deltaPoints.page.x/a.viewport.scale,n["default"].cornerstone.setViewport(a.element,a.viewport)}function g(a){a.viewport.rotation+=a.deltaPoints.page.y/a.viewport.scale,n["default"].cornerstone.setViewport(a.element,a.viewport)}function h(a){var b=a.detail,c=b.element,d=(0,u.getToolOptions)(v,c),e={x:b.currentPoints.client.x,y:b.currentPoints.client.y},f=b.viewport.rotation;if((0,t["default"])(b.which,d.mouseButtonMask)){var g=j.bind({},e,f),h=function i(a){var b=a.detail,c=b.element;c.removeEventListener(l["default"].MOUSE_DRAG,g),c.removeEventListener(l["default"].MOUSE_UP,i),c.removeEventListener(l["default"].MOUSE_CLICK,i)};c.addEventListener(l["default"].MOUSE_DRAG,g),c.addEventListener(l["default"].MOUSE_UP,h),c.addEventListener(l["default"].MOUSE_CLICK,h),a.preventDefault(),a.stopPropagation()}}function i(a){var b=a.detail,c=b.element,d={x:b.currentPoints.client.x,y:b.currentPoints.client.y},e=b.viewport.rotation,f=j.bind({},d,e),g=function h(a){var b=a.detail,c=b.element;c.removeEventListener(l["default"].TOUCH_DRAG,f),c.removeEventListener(l["default"].TOUCH_END,h)};c.addEventListener(l["default"].TOUCH_DRAG,f),c.addEventListener(l["default"].TOUCH_END,g),a.preventDefault(),a.stopPropagation()}function j(a,b,c){var d=c.detail;w.strategy(d,a,b),n["default"].cornerstone.setViewport(d.element,d.viewport),c.preventDefault(),c.stopPropagation()}Object.defineProperty(b,"__esModule",{value:!0}),b.rotateTouchDrag=b.rotate=void 0;var k=c("./events.js"),l=d(k),m=c("./externalModules.js"),n=d(m),o=c("./imageTools/simpleMouseButtonTool.js"),p=d(o),q=c("./imageTools/simpleTouchTool.js"),r=d(q),s=c("./util/isMouseButtonEnabled.js"),t=d(s),u=c("./toolOptions.js"),v="rotate",w=(0,p["default"])(h,v);w.strategies={"default":e,horizontal:f,vertical:g},w.strategy=e;var x=(0,r["default"])(i,v);b.rotate=w,b.rotateTouchDrag=x},"./imageTools/rotateTouch.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail;return b.viewport.rotation+=b.rotation,k["default"].cornerstone.setViewport(b.element,b.viewport),!1}function f(a){a.removeEventListener(i["default"].TOUCH_ROTATE,e)}function g(a){a.removeEventListener(i["default"].TOUCH_ROTATE,e),a.addEventListener(i["default"].TOUCH_ROTATE,e)}Object.defineProperty(b,"__esModule",{value:!0});var h=c("./events.js"),i=d(h),j=c("./externalModules.js"),k=d(j),l={activate:g,disable:f};b["default"]=l},"./imageTools/saveAs.js":function(a,b,c){"use strict";function d(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",d=a.querySelector("canvas");if(d.msToBlob){var e=d.msToBlob();return window.navigator.msSaveBlob(e,b)}var f=document.createElement("a");if(f.download=b,f.href=d.toDataURL(c,1),document.createEvent){var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),f.dispatchEvent(g)}else f.fireEvent&&f.fireEvent("onclick")}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d},"./imageTools/scaleOverlayTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){for(var b=0,c=[];a.verticalLine.start.y+b*a.verticalMinorTick<=a.vscaleBounds.bottomRight.y;){var d={x:a.verticalLine.start.x,y:a.verticalLine.start.y+b*a.verticalMinorTick},e={x:0,y:a.verticalLine.start.y+b*a.verticalMinorTick};b%5===0?e.x=a.verticalLine.start.x-a.majorTickLength:e.x=a.verticalLine.start.x-a.minorTickLength,c.push({start:d,end:e}),b++}return c}function f(a){for(var b=0,c=[];a.horizontalLine.start.x+b*a.horizontalMinorTick<=a.hscaleBounds.bottomRight.x;){var d={x:a.horizontalLine.start.x+b*a.horizontalMinorTick,y:a.horizontalLine.start.y},e={x:a.horizontalLine.start.x+b*a.horizontalMinorTick,y:0};b%5===0?e.y=a.horizontalLine.start.y-a.majorTickLength:e.y=a.horizontalLine.start.y-a.minorTickLength,c.push({start:d,end:e}),b++}return c}function g(a,b,c,d,e){var f={left:0,top:0,width:b.width,height:b.height},g=d*Math.min(1e3,b.width),h=e*Math.min(1e3,b.height);return f={left:f.left+g,top:f.top+h,width:f.width-2*g,height:f.height-2*h},{topLeft:{x:f.left,y:f.top},bottomRight:{x:f.left+f.width,y:f.top+f.height}}}function h(a){var b=a.detail,c=(0,n.getNewContext)(b.canvasContext.canvas),d=b.image,h=b.viewport,i=m["default"].cornerstone,j=i.metaData.get("imagePlaneModule",d.imageId),k=void 0,l=void 0;if(j?(k=j.rowPixelSpacing||j.rowImagePixelSpacing,l=j.columnPixelSpacing||j.colImagePixelSpacing):(k=d.rowPixelSpacing,l=d.columnPixelSpacing),k&&l){var o={width:c.canvas.width,height:c.canvas.height},q={width:d.width,height:d.height},r=10/k*h.scale,s=10/l*h.scale,t=g(b,o,q,.25,.05),u=g(b,o,q,.05,.15);if(o.width&&o.height&&q.width&&q.height&&t&&u){var v=p.getConfiguration(),w=Object.assign({},{hscaleBounds:t,vscaleBounds:u,verticalMinorTick:r,horizontalMinorTick:s,minorTickLength:8,majorTickLength:12,verticalLine:{start:{x:u.bottomRight.x,y:u.topLeft.y},end:{x:u.bottomRight.x,y:u.bottomRight.y}},horizontalLine:{start:{x:t.topLeft.x,y:t.bottomRight.y},end:{x:t.bottomRight.x,y:t.bottomRight.y}}},v),x=w.color,y=w.lineWidth,z={color:x,lineWidth:y},A=e(w),B=f(w);(0,n.draw)(c,function(a){a.shadowColor=w.shadowColor,a.shadowBlur=w.shadowBlur,(0,n.drawLine)(a,void 0,w.verticalLine.start,w.verticalLine.end,z,"canvas"),(0,n.drawLine)(a,void 0,w.horizontalLine.start,w.horizontalLine.end,z,"canvas"),(0,n.drawLines)(a,void 0,A,z,"canvas"),(0,n.drawLines)(a,void 0,B,z,"canvas")})}}}function i(a){a.removeEventListener(m["default"].cornerstone.EVENTS.IMAGE_RENDERED,h),m["default"].cornerstone.updateImage(a)}Object.defineProperty(b,"__esModule",{value:!0});var j=c("./imageTools/displayTool.js"),k=d(j),l=c("./externalModules.js"),m=d(l),n=c("./util/drawing.js"),o={color:"white",lineWidth:1,shadowColor:"black",shadowBlur:4},p=(0,k["default"])(h);p.setConfiguration(o),p.disable=i,b["default"]=p},"./imageTools/seedAnnotate.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){a(prompt("Enter your annotation:"))}function f(a,b,c){c(prompt("Change your annotation:"))}function g(a){function b(a){null===a?(0,N.removeToolState)(d,R,f):f.text=a,f.active=!1,c.updateImage(d)}var c=q["default"].cornerstone,d=a.element,e=T.getConfiguration(),f=h(a);(0,N.addToolState)(d,R,f),c.updateImage(d),(0,E["default"])(a,R,f,f.handles.end,function(){(0,C["default"])(a,f.handles)&&(0,N.removeToolState)(d,R,f),void 0===f.text&&e.getTextCallback(b),c.updateImage(d)})}function h(a){var b={visible:!0,active:!0,color:void 0,handles:{end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};return b}function i(a,b,c){if(b.visible===!1)return!1;if(b.handles.end){var d=q["default"].cornerstone.pixelToCanvas(a,b.handles.end),e=q["default"].cornerstoneMath.point.distance(d,c);return e<25}}function j(a){function b(a){var b="";return b=k.showCoordinates?a.text+" x: "+Math.round(a.handles.end.x)+" y: "+Math.round(a.handles.end.y):a.text}function c(a){return[a.end]}var d=a.detail,e=(0,N.getToolState)(a.currentTarget,R);if(e)for(var f=q["default"].cornerstone,g=d.enabledElement,h=(0,P.getNewContext)(d.canvasContext.canvas),i=d.canvasContext.canvas.width,j=y["default"].getToolWidth(),k=T.getConfiguration(),l=function(a){var l=e.data[a];return l.visible===!1?"continue":void(0,P.draw)(h,function(a){(0,P.setShadow)(a,k);var e=A["default"].getColorIfActive(l),h=f.pixelToCanvas(d.element,l.handles.end),m=handleRadiusComm;(0,P.drawCircle)(a,d.element,l.handles.end,m,{color:e});var n={drawHandlesIfActive:k&&k.drawHandlesOnHover};if(k.drawHandles&&(0,G["default"])(a,d,h,e,n),l.text&&""!==l.text){var o=b(l),p=5,q=(0,Q.textBoxWidth)(a,o,p),r=w["default"].getFontSize()+10,s=Math.max(q,r)/2+5;h.x>i/2&&(s=-s);var t=void 0;if(!l.handles.textBox.hasMoved){t={x:h.x-q/2+s,y:h.y-r/2};var u=f.internal.getTransform(g);u.invert();var v=u.transformPoint(t.x,t.y);l.handles.textBox.x=v.x,l.handles.textBox.y=v.y}(0,M["default"])(a,d.element,l.handles.textBox,o,l.handles,c,e,j,0,!1)}})},m=0;m<e.data.length;m++){l(m)}}function k(a){function b(a){null===a?(0,N.removeToolState)(d,R,f):f.text=a,f.active=!1,c.updateImage(d)}var c=q["default"].cornerstone,d=a.element,e=T.getConfiguration(),f=h(a);(0,N.addToolState)(d,R,f),c.updateImage(d),(0,E["default"])(a,R,f,f.handles.end,function(){(0,C["default"])(a,f.handles)&&(0,N.removeToolState)(d,R,f),void 0===f.text&&e.getTextCallback(b),c.updateImage(d)})}function l(a){function b(a,b,c){c===!0?(0,N.removeToolState)(e,R,a):a.text=b,a.active=!1,d.updateImage(e)}var c=a.detail,d=q["default"].cornerstone,e=c.element,f=void 0,g=(0,O.getToolOptions)(R,e);if((0,I["default"])(c.which,g.mouseButtonMask)){var h=T.getConfiguration(),j=c.currentPoints.canvas,k=(0,N.getToolState)(e,R);if(k){for(var l=0;l<k.data.length;l++)if(f=k.data[l],i(e,f,j)||(0,K["default"])(f.handles.textBox,j))return f.active=!0,d.updateImage(e),h.changeTextCallback(f,c,b),a.stopImmediatePropagation(),!1;a.preventDefault(),a.stopPropagation()}}}function m(a){function b(a,b,c){console.log("pressCallback doneChangingTextCallback"),c===!0?(0,N.removeToolState)(e,R,a):a.text=b,a.active=!1,d.updateImage(e),e.addEventListener(o["default"].TOUCH_START,U.touchStartCallback),e.addEventListener(o["default"].TOUCH_START_ACTIVE,U.touchDownActivateCallback),e.addEventListener(o["default"].TAP,U.tapCallback)}var c=a.detail,d=q["default"].cornerstone,e=c.element,f=void 0,g=T.getConfiguration(),h=c.currentPoints.canvas,j=(0,N.getToolState)(e,R);if(!j)return!1;if(c.handlePressed)return e.removeEventListener(o["default"].TOUCH_START,U.touchStartCallback),e.removeEventListener(o["default"].TOUCH_START_ACTIVE,U.touchDownActivateCallback),e.removeEventListener(o["default"].TAP,U.tapCallback),g.changeTextCallback(c.handlePressed,c,b),a.stopImmediatePropagation(),!1;for(var k=0;k<j.data.length;k++)if(f=j.data[k],i(e,f,h)||(0,K["default"])(f.handles.textBox,h))return f.active=!0,d.updateImage(e),e.removeEventListener(o["default"].TOUCH_START,U.touchStartCallback),e.removeEventListener(o["default"].TOUCH_START_ACTIVE,U.touchDownActivateCallback),e.removeEventListener(o["default"].TAP,U.tapCallback),g.changeTextCallback(f,c,b),a.stopImmediatePropagation(),!1;a.preventDefault(),a.stopPropagation()}Object.defineProperty(b,"__esModule",{value:!0}),b.seedAnnotateTouch=b.seedAnnotate=void 0;var n=c("./events.js"),o=d(n),p=c("./externalModules.js"),q=d(p),r=c("./imageTools/mouseButtonTool.js"),s=d(r),t=c("./imageTools/touchTool.js"),u=d(t),v=c("./stateManagement/textStyle.js"),w=d(v),x=c("./stateManagement/toolStyle.js"),y=d(x),z=c("./stateManagement/toolColors.js"),A=d(z),B=c("./manipulators/anyHandlesOutsideImage.js"),C=d(B),D=c("./manipulators/moveHandle.js"),E=d(D),F=c("./manipulators/drawHandles.js"),G=d(F),H=c("./util/isMouseButtonEnabled.js"),I=d(H),J=c("./util/pointInsideBoundingBox.js"),K=d(J),L=c("./util/drawLinkedTextBox.js"),M=d(L),N=c("./stateManagement/toolState.js"),O=c("./toolOptions.js"),P=c("./util/drawing.js"),Q=c("./util/drawTextBox.js"),R="seedAnnotate",S={getTextCallback:e,changeTextCallback:f,drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0},T=(0,s["default"])({addNewMeasurement:g,createNewMeasurement:h,onImageRendered:j,pointNearTool:i,toolType:R,mouseDoubleClickCallback:l});T.setConfiguration(S);var U=(0,u["default"])({addNewMeasurement:k,createNewMeasurement:h,onImageRendered:j,pointNearTool:i,toolType:R,pressCallback:m});b.seedAnnotate=T,b.seedAnnotateTouch=U},"./imageTools/simpleAngle.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b={visible:!0,active:!0,color:void 0,handles:{start:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},middle:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0},end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};return b}function f(a,b,c){return b.visible!==!1&&((0,J["default"])(a,b.handles.start,b.handles.middle,c)<25||(0,J["default"])(a,b.handles.middle,b.handles.end,c)<25)}function g(a){return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))}function h(a){function b(a,b,c){var d=b&&c?"":" (isotropic)",e="00B0";return a.rAngle.toString()+String.fromCharCode(parseInt(e,16))+d}function c(a){return[a.start,a.middle,a.end]}var d=a.detail,e=(0,K.getToolState)(a.currentTarget,N);if(e)for(var f=n["default"].cornerstone,h=d.enabledElement,i=(0,L.getNewContext)(d.canvasContext.canvas),j=v["default"].getToolWidth(),k=O.getConfiguration(),l=function(a){var l=e.data[a];return l.visible===!1?"continue":void(0,L.draw)(i,function(a){(0,L.setShadow)(a,k);var e=x["default"].getColorIfActive(l),i=f.pixelToCanvas(d.element,l.handles.start),m=f.pixelToCanvas(d.element,l.handles.middle);(0,L.drawJoinedLines)(a,d.element,l.handles.start,[l.handles.middle,l.handles.end],{color:e});var n={drawHandlesIfActive:k&&k.drawHandlesOnHover};(0,F["default"])(a,d,l.handles,e,n);var o=d.image.columnPixelSpacing||1,p=d.image.rowPixelSpacing||1,q={x:(Math.ceil(l.handles.middle.x)-Math.ceil(l.handles.start.x))*o,y:(Math.ceil(l.handles.middle.y)-Math.ceil(l.handles.start.y))*p},s={x:(Math.ceil(l.handles.end.x)-Math.ceil(l.handles.middle.x))*o,y:(Math.ceil(l.handles.end.y)-Math.ceil(l.handles.middle.y))*p},u={x:(Math.ceil(l.handles.end.x)-Math.ceil(l.handles.start.x))*o,y:(Math.ceil(l.handles.end.y)-Math.ceil(l.handles.start.y))*p},v=g(q),w=g(s),y=g(u),z=Math.acos((Math.pow(v,2)+Math.pow(w,2)-Math.pow(y,2))/(2*v*w));if(z*=180/Math.PI,l.rAngle=(0,r["default"])(z,2),l.rAngle){var A=b(l,d.image.rowPixelSpacing,d.image.columnPixelSpacing),B=15,C=void 0;if(!l.handles.textBox.hasMoved){C={x:m.x,y:m.y};var D=5,E=(0,M.textBoxWidth)(a,A,D);m.x<i.x?C.x-=B+E:C.x+=B;var G=f.internal.getTransform(h);G.invert();var H=G.transformPoint(C.x,C.y);l.handles.textBox.x=H.x,l.handles.textBox.y=H.y}(0,t["default"])(a,d.element,l.handles.textBox,A,l.handles,c,e,j,0,!0)}})},m=0;m<e.data.length;m++){l(m)}}function i(a){var b=n["default"].cornerstone,c=e(a),d=a.element;(0,K.addToolState)(d,N,c),d.removeEventListener(l["default"].MOUSE_MOVE,O.mouseMoveCallback),d.removeEventListener(l["default"].MOUSE_DRAG,O.mouseMoveCallback),d.removeEventListener(l["default"].MOUSE_DOWN,O.mouseDownCallback),d.removeEventListener(l["default"].MOUSE_DOWN_ACTIVATE,O.mouseDownActivateCallback),b.updateImage(d),(0,B["default"])(a,N,c,c.handles.middle,function(){return c.active=!1,(0,z["default"])(a,c.handles)?((0,K.removeToolState)(d,N,c),d.addEventListener(l["default"].MOUSE_MOVE,O.mouseMoveCallback),d.addEventListener(l["default"].MOUSE_DRAG,O.mouseMoveCallback),d.addEventListener(l["default"].MOUSE_DOWN,O.mouseDownCallback),d.addEventListener(l["default"].MOUSE_DOWN_ACTIVATE,O.mouseDownActivateCallback),void b.updateImage(d)):(c.handles.end.active=!0,b.updateImage(d),void(0,B["default"])(a,N,c,c.handles.end,function(){c.active=!1,(0,z["default"])(a,c.handles)&&(0,K.removeToolState)(d,N,c),d.addEventListener(l["default"].MOUSE_MOVE,O.mouseMoveCallback),d.addEventListener(l["default"].MOUSE_DRAG,O.mouseMoveCallback),d.addEventListener(l["default"].MOUSE_DOWN,O.mouseDownCallback),d.addEventListener(l["default"].MOUSE_DOWN_ACTIVATE,O.mouseDownActivateCallback),b.updateImage(d)}))})}function j(a){var b=n["default"].cornerstone,c=e(a),d=a.element;(0,K.addToolState)(d,N,c),d.removeEventListener(l["default"].TOUCH_DRAG,P.touchMoveCallback),d.removeEventListener(l["default"].TOUCH_START_ACTIVE,P.touchDownActivateCallback),d.removeEventListener(l["default"].TOUCH_START,P.touchStartCallback),d.removeEventListener(l["default"].TAP,P.tapCallback),b.updateImage(d),(0,D["default"])(a,N,c,c.handles.middle,function(){return(0,z["default"])(a,c.handles)?((0,K.removeToolState)(d,N,c),d.addEventListener(l["default"].TOUCH_DRAG,P.touchMoveCallback),d.addEventListener(l["default"].TOUCH_START,P.touchStartCallback),d.addEventListener(l["default"].TOUCH_START_ACTIVE,P.touchDownActivateCallback),d.addEventListener(l["default"].TAP,P.tapCallback),void b.updateImage(d)):void(0,D["default"])(a,N,c,c.handles.end,function(){(0,z["default"])(a,c.handles)&&((0,K.removeToolState)(d,N,c),b.updateImage(d)),d.addEventListener(l["default"].TOUCH_DRAG,P.touchMoveCallback),d.addEventListener(l["default"].TOUCH_START,P.touchStartCallback),d.addEventListener(l["default"].TOUCH_START_ACTIVE,P.touchDownActivateCallback),d.addEventListener(l["default"].TAP,P.tapCallback)})})}Object.defineProperty(b,"__esModule",{value:!0}),b.simpleAngleTouch=b.simpleAngle=void 0;var k=c("./events.js"),l=d(k),m=c("./externalModules.js"),n=d(m),o=c("./imageTools/mouseButtonTool.js"),p=d(o),q=c("./util/roundToDecimal.js"),r=d(q),s=c("./util/drawLinkedTextBox.js"),t=d(s),u=c("./stateManagement/toolStyle.js"),v=d(u),w=c("./stateManagement/toolColors.js"),x=d(w),y=c("./manipulators/anyHandlesOutsideImage.js"),z=d(y),A=c("./manipulators/moveNewHandle.js"),B=d(A),C=c("./manipulators/moveNewHandleTouch.js"),D=d(C),E=c("./manipulators/drawHandles.js"),F=d(E),G=c("./imageTools/touchTool.js"),H=d(G),I=c("./util/lineSegDistance.js"),J=d(I),K=c("./stateManagement/toolState.js"),L=c("./util/drawing.js"),M=c("./util/drawTextBox.js"),N="simpleAngle",O=(0,
p["default"])({createNewMeasurement:e,addNewMeasurement:i,onImageRendered:h,pointNearTool:f,toolType:N}),P=(0,H["default"])({createNewMeasurement:e,addNewMeasurement:j,onImageRendered:h,pointNearTool:f,toolType:N});b.simpleAngle=O,b.simpleAngleTouch=P},"./imageTools/simpleMouseButtonTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){if(!b)throw new Error("simpleMouseButtonTool: toolType is required");var c={};return{activate:function(c,d){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.mouseButtonMask=d,(0,g.setToolOptions)(b,c,e),c.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,a),c.addEventListener(f["default"].MOUSE_DOWN_ACTIVATE,a)},disable:function(b){b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,a)},enable:function(b){b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,a)},deactivate:function(b){b.removeEventListener(f["default"].MOUSE_DOWN_ACTIVATE,a)},getConfiguration:function(){return c},setConfiguration:function(a){c=a}}};var e=c("./events.js"),f=d(e),g=c("./toolOptions.js")},"./imageTools/simpleTouchTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){if(!b)throw new Error("simpleTouchTool: toolType is required");var c={};return{activate:function(c){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,g.setToolOptions)(b,c,d),c.removeEventListener(f["default"].TOUCH_START,a),c.addEventListener(f["default"].TOUCH_START,a)},disable:function(b){b.removeEventListener(f["default"].TOUCH_START,a)},enable:function(b){b.removeEventListener(f["default"].TOUCH_START,a)},deactivate:function(b){b.removeEventListener(f["default"].TOUCH_START,a)},getConfiguration:function(){return c},setConfiguration:function(a){c=a}}};var e=c("./events.js"),f=d(e),g=c("./toolOptions.js")},"./imageTools/textMarker.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=D.getConfiguration();if(b.current){var c={visible:!0,active:!0,text:b.current,color:void 0,handles:{end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},d={left:0,top:0,width:a.image.width,height:a.image.height};if(m["default"].cornerstoneMath.point.insideRect(c.handles.end,d)){var e=b.markers.indexOf(b.current);return b.ascending?(e+=1,e>=b.markers.length&&(b.loop?e-=b.markers.length:e=-1)):(e-=1,e<0&&(b.loop?e+=b.markers.length:e=-1)),b.current=b.markers[e],c}}}function f(a,b,c){if(b.visible===!1)return!1;if(b.handles.end.boundingBox){var d=m["default"].cornerstoneMath.rect.distanceToPoint(b.handles.end.boundingBox,c),e=(0,s["default"])(b.handles.end,c);return d<10||e}}function g(a){var b=a.detail,c=(0,z.getToolState)(b.element,C);if(c)for(var d=(0,B.getNewContext)(b.canvasContext.canvas),e=D.getConfiguration(),f=function(a){var f=c.data[a];if(f.visible===!1)return"continue";var g=u["default"].getColorIfActive(f);(0,B.draw)(d,function(a){(0,B.setShadow)(a,e);var c=5;f.textWidth=(0,x.textBoxWidth)(a,f.text,c);var d=m["default"].cornerstone.pixelToCanvas(b.element,f.handles.end),h={centering:{x:!0,y:!0}};f.handles.end.boundingBox=(0,y["default"])(a,f.text,d.x,d.y-10,g,h)})},g=0;g<c.data.length;g++){f(g)}}function h(a){function b(a,b,c){c===!0?(0,z.removeToolState)(e,C,a):a.text=b,a.active=!1,d.updateImage(e),e.addEventListener(k["default"].MOUSE_MOVE,D.mouseMoveCallback),e.addEventListener(k["default"].MOUSE_DOWN,D.mouseDownCallback),e.addEventListener(k["default"].MOUSE_DOWN_ACTIVATE,D.mouseDownActivateCallback),e.addEventListener(k["default"].MOUSE_DOUBLE_CLICK,D.mouseDoubleClickCallback)}var c=a.detail,d=m["default"].cornerstone,e=c.element,g=void 0,h=(0,A.getToolOptions)(C,e);if((0,w["default"])(c.which,h.mouseButtonMask)){var i=D.getConfiguration(),j=c.currentPoints.canvas,l=(0,z.getToolState)(e,C);if(l){for(var n=0;n<l.data.length;n++)if(g=l.data[n],f(e,g,j))return g.active=!0,d.updateImage(e),e.removeEventListener(k["default"].MOUSE_MOVE,D.mouseMoveCallback),e.removeEventListener(k["default"].MOUSE_DOWN,D.mouseDownCallback),e.removeEventListener(k["default"].MOUSE_DOWN_ACTIVATE,D.mouseDownActivateCallback),e.removeEventListener(k["default"].MOUSE_DOUBLE_CLICK,D.mouseDoubleClickCallback),i.changeTextCallback(g,c,b),a.stopImmediatePropagation(),a.preventDefault(),void a.stopPropagation();a.preventDefault(),a.stopPropagation()}}}function i(a){function b(a,b,c){c===!0?(0,z.removeToolState)(e,C,a):a.text=b,a.active=!1,d.updateImage(e),e.addEventListener(k["default"].TOUCH_DRAG,E.touchMoveCallback),e.addEventListener(k["default"].TOUCH_START_ACTIVE,E.touchDownActivateCallback),e.addEventListener(k["default"].TOUCH_START,E.touchStartCallback),e.addEventListener(k["default"].TAP,E.tapCallback),e.addEventListener(k["default"].TOUCH_PRESS,E.pressCallback)}var c=a.detail,d=m["default"].cornerstone,e=c.element,g=void 0,h=D.getConfiguration(),i=c.currentPoints.canvas,j=(0,z.getToolState)(e,C);if(!j)return!1;if(c.handlePressed)return c.handlePressed.active=!0,d.updateImage(e),e.removeEventListener(k["default"].TOUCH_DRAG,E.touchMoveCallback),e.removeEventListener(k["default"].TOUCH_START_ACTIVE,E.touchDownActivateCallback),e.removeEventListener(k["default"].TOUCH_START,E.touchStartCallback),e.removeEventListener(k["default"].TAP,E.tapCallback),e.removeEventListener(k["default"].TOUCH_PRESS,E.pressCallback),h.changeTextCallback(c.handlePressed,c,b),a.stopImmediatePropagation(),a.preventDefault(),void a.stopPropagation();for(var l=0;l<j.data.length;l++)if(g=j.data[l],f(e,g,i))return g.active=!0,d.updateImage(e),e.removeEventListener(k["default"].TOUCH_DRAG,E.touchMoveCallback),e.removeEventListener(k["default"].TOUCH_START_ACTIVE,E.touchDownActivateCallback),e.removeEventListener(k["default"].TOUCH_START,E.touchStartCallback),e.removeEventListener(k["default"].TAP,E.tapCallback),e.removeEventListener(k["default"].TOUCH_PRESS,E.pressCallback),h.changeTextCallback(g,c,b),a.stopImmediatePropagation(),a.preventDefault(),void a.stopPropagation();a.preventDefault(),a.stopPropagation()}Object.defineProperty(b,"__esModule",{value:!0}),b.textMarkerTouch=b.textMarker=void 0;var j=c("./events.js"),k=d(j),l=c("./externalModules.js"),m=d(l),n=c("./imageTools/mouseButtonTool.js"),o=d(n),p=c("./imageTools/touchTool.js"),q=d(p),r=c("./util/pointInsideBoundingBox.js"),s=d(r),t=c("./stateManagement/toolColors.js"),u=d(t),v=c("./util/isMouseButtonEnabled.js"),w=d(v),x=c("./util/drawTextBox.js"),y=d(x),z=c("./stateManagement/toolState.js"),A=c("./toolOptions.js"),B=c("./util/drawing.js"),C="textMarker",D=(0,o["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:C,mouseDoubleClickCallback:h}),E=(0,q["default"])({createNewMeasurement:e,onImageRendered:g,pointNearTool:f,toolType:C,pressCallback:i});b.textMarker=D,b.textMarkerTouch=E},"./imageTools/touchDragTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){var d=[f["default"].TOUCH_DRAG];return c&&c.fireOnTouchStart===!0&&d.push(f["default"].TOUCH_START),{activate:function(e){c&&c.eventData&&(0,g.setToolOptions)(b,e,c.eventData),d.forEach(function(b){e.removeEventListener(b,a),e.addEventListener(b,a)}),c&&c.activateCallback&&c.activateCallback(e),c&&c.touchStartCallback&&e.addEventListener(f["default"].TOUCH_START,c.touchStartCallback),c&&c.touchEndCallback&&e.addEventListener(f["default"].TOUCH_END,c.touchEndCallback)},disable:function(b){d.forEach(function(c){b.removeEventListener(c,a)}),c&&c.disableCallback&&c.disableCallback(b),c&&c.touchStartCallback&&b.removeEventListener(f["default"].TOUCH_START,c.touchStartCallback),c&&c.touchEndCallback&&b.removeEventListener(f["default"].TOUCH_END,c.touchEndCallback)},enable:function(b){d.forEach(function(c){b.removeEventListener(c,a)}),c&&c.enableCallback&&c.enableCallback(b),c&&c.touchStartCallback&&b.removeEventListener(f["default"].TOUCH_START,c.touchStartCallback),c&&c.touchEndCallback&&b.removeEventListener(f["default"].TOUCH_END,c.touchEndCallback)},deactivate:function(b){d.forEach(function(c){b.removeEventListener(c,a)}),c&&c.deactivateCallback&&c.deactivateCallback(b),c&&c.touchStartCallback&&b.removeEventListener(f["default"].TOUCH_START,c.touchStartCallback),c&&c.touchEndCallback&&b.removeEventListener(f["default"].TOUCH_END,c.touchEndCallback)}}};var e=c("./events.js"),f=d(e),g=c("./toolOptions.js")},"./imageTools/touchPinchTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){return{activate:function(b){b.removeEventListener(f["default"].TOUCH_PINCH,a),b.addEventListener(f["default"].TOUCH_PINCH,a)},disable:function(b){b.removeEventListener(f["default"].TOUCH_PINCH,a)},enable:function(b){b.removeEventListener(f["default"].TOUCH_PINCH,a)},deactivate:function(b){b.removeEventListener(f["default"].TOUCH_PINCH,a)}}};var e=c("./events.js"),f=d(e)},"./imageTools/touchTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){Object.keys(a).forEach(function(b){var c=a[b];c.active=!1})}function f(a){if(a)for(var b=0;b<a.data.length;b++){var c=a.data[b];c.active=!1,c.handles&&e(c.handles)}}function g(a){function b(b){var f=k["default"].cornerstone,g=b.element,h=a.createNewMeasurement(b);if(h){if((0,v.addToolState)(g,a.toolType,h),1===Object.keys(h.handles).length&&b.type===i["default"].TAP)return h.active=!1,h.handles.end.active=!1,h.handles.end.highlight=!1,h.invalidated=!0,(0,m["default"])(b,h.handles)&&(0,v.removeToolState)(g,a.toolType,h),void f.updateImage(g);g.removeEventListener(i["default"].TOUCH_START_ACTIVE,a.touchDownActivateCallback||c),g.removeEventListener(i["default"].TAP,a.tapCallback||d),g.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),f.updateImage(g),(0,s["default"])(b,a.toolType,h,h.handles.end,function(){h.active=!1,h.invalidated=!0,(0,m["default"])(b,h.handles)&&(0,v.removeToolState)(g,a.toolType,h),g.addEventListener(i["default"].TOUCH_START_ACTIVE,a.touchDownActivateCallback||c),g.addEventListener(i["default"].TAP,a.tapCallback||d),g.addEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),f.updateImage(g)})}}function c(c){var d=c.detail;a.addNewMeasurement?a.addNewMeasurement(d):b(d),c.stopImmediatePropagation(),c.preventDefault()}function d(b){function g(){f(p),(0,m["default"])(h,r.handles)&&(0,v.removeToolState)(l,a.toolType,r),j.updateImage(l),l.addEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),l.addEventListener(i["default"].TAP,a.tapCallback||d)}var h=b.detail,j=k["default"].cornerstone,l=h.element,n=h.currentPoints.canvas,p=(0,v.getToolState)(b.currentTarget,a.toolType),r=void 0,s=void 0;if(f(p),p)for(s=0;s<p.data.length;s++){r=p.data[s];var t=25,w=(0,o["default"])(l,r.handles,n,t);if(w)return l.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),l.removeEventListener(i["default"].TAP,a.tapCallback||d),r.active=!0,w.active=!0,j.updateImage(l),(0,q["default"])(b,a.toolType,r,w,g),b.stopImmediatePropagation(),void b.preventDefault()}if(p&&a.pointNearTool)for(s=0;s<p.data.length;s++)if(r=p.data[s],a.pointNearTool(l,r,n))return l.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),l.removeEventListener(i["default"].TAP,a.tapCallback||d),r.active=!0,j.updateImage(l),(0,u["default"])(b,r,p,a.toolType,!0,g),b.stopImmediatePropagation(),void b.preventDefault();return a.touchDownActivateCallback?a.touchDownActivateCallback(b):c(b),!1}function e(b){function c(b,c){l.active=!1,l.invalidated=!0,(0,m["default"])(f,l.handles)&&(0,v.removeToolState)(f.element,a.toolType,l),g.updateImage(f.element),h.addEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),h.addEventListener(i["default"].TAP,a.tapCallback||d),a.pressCallback&&h.addEventListener(i["default"].TOUCH_PRESS,a.pressCallback),b&&b.type===i["default"].TOUCH_PRESS&&(0,x["default"])(h,b.type,c)}var f=b.detail,g=k["default"].cornerstone,h=f.element,j=f.startPoints.canvas,l=void 0,n=(0,v.getToolState)(b.currentTarget,a.toolType),p=void 0,r=28;if(n){for(p=0;p<n.data.length;p++){l=n.data[p];var s=(0,o["default"])(f.element,l.handles,j,r);if(s)return h.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),h.removeEventListener(i["default"].TAP,a.tapCallback||d),a.pressCallback&&h.removeEventListener(i["default"].TOUCH_PRESS,a.pressCallback),l.active=!0,(0,q["default"])(b,a.toolType,l,s,c),b.stopImmediatePropagation(),b.preventDefault(),void b.stopPropagation()}if(a.pointNearTool)for(p=0;p<n.data.length;p++)if(l=n.data[p],a.pointNearTool(f.element,l,j))return h.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),h.removeEventListener(i["default"].TAP,a.tapCallback||d),a.pressCallback&&h.removeEventListener(i["default"].TOUCH_PRESS,a.pressCallback),(0,u["default"])(b,l,n,a.toolType,!0,c),b.stopImmediatePropagation(),b.preventDefault(),void b.stopPropagation()}}function g(b){b.removeEventListener(k["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),b.removeEventListener(i["default"].TOUCH_START_ACTIVE,a.touchDownActivateCallback||c),b.removeEventListener(i["default"].TAP,a.tapCallback||d),a.doubleTapCallback&&b.removeEventListener(i["default"].DOUBLE_TAP,a.doubleTapCallback),a.pressCallback&&b.removeEventListener(i["default"].TOUCH_PRESS,a.pressCallback),k["default"].cornerstone.updateImage(b)}function h(b){b.removeEventListener(k["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),b.removeEventListener(i["default"].TOUCH_START_ACTIVE,a.touchDownActivateCallback||c),b.removeEventListener(i["default"].TAP,a.tapCallback||d),b.addEventListener(k["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),a.doubleTapCallback&&b.removeEventListener(i["default"].DOUBLE_TAP,a.doubleTapCallback),a.pressCallback&&b.removeEventListener(i["default"].TOUCH_PRESS,a.pressCallback),k["default"].cornerstone.updateImage(b)}function j(b){b.removeEventListener(k["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),b.removeEventListener(i["default"].TOUCH_START_ACTIVE,a.touchDownActivateCallback||c),b.removeEventListener(i["default"].TAP,a.tapCallback||d),b.addEventListener(k["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.addEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),b.addEventListener(i["default"].TOUCH_START_ACTIVE,a.touchDownActivateCallback||c),b.addEventListener(i["default"].TAP,a.tapCallback||d),a.doubleTapCallback&&(b.removeEventListener(i["default"].DOUBLE_TAP,a.doubleTapCallback),b.addEventListener(i["default"].DOUBLE_TAP,a.doubleTapCallback)),a.pressCallback&&(b.removeEventListener(i["default"].TOUCH_PRESS,a.pressCallback),b.addEventListener(i["default"].TOUCH_PRESS,a.pressCallback)),k["default"].cornerstone.updateImage(b)}function l(b){var f=i["default"].TOOL_DEACTIVATED,g={toolType:a.toolType,type:f};(0,x["default"])(b,f,g),b.removeEventListener(k["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.removeEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),b.removeEventListener(i["default"].TOUCH_START_ACTIVE,a.touchDownActivateCallback||c),b.removeEventListener(i["default"].TAP,a.tapCallback||d),b.addEventListener(k["default"].cornerstone.EVENTS.IMAGE_RENDERED,a.onImageRendered),b.addEventListener(i["default"].TOUCH_START,a.touchStartCallback||e),a.doubleTapCallback&&b.removeEventListener(i["default"].DOUBLE_TAP,a.doubleTapCallback),a.pressCallback&&b.removeEventListener(i["default"].TOUCH_PRESS,a.pressCallback),k["default"].cornerstone.updateImage(b)}var n={enable:h,disable:g,activate:j,deactivate:l,touchStartCallback:a.touchStartCallback||e,touchDownActivateCallback:a.touchDownActivateCallback||c,tapCallback:a.tapCallback||d};return a.pointNearTool&&(n.pointNearTool=a.pointNearTool),a.doubleTapCallback&&(n.doubleTapCallback=a.doubleTapCallback),a.pressCallback&&(n.pressCallback=a.pressCallback),a.addNewMeasurement&&(n.addNewMeasurement=a.addNewMeasurement),n}Object.defineProperty(b,"__esModule",{value:!0});var h=c("./events.js"),i=d(h),j=c("./externalModules.js"),k=d(j),l=c("./manipulators/anyHandlesOutsideImage.js"),m=d(l),n=c("./manipulators/getHandleNearImagePoint.js"),o=d(n),p=c("./manipulators/touchMoveHandle.js"),q=d(p),r=c("./manipulators/moveNewHandleTouch.js"),s=d(r),t=c("./manipulators/touchMoveAllHandles.js"),u=d(t),v=c("./stateManagement/toolState.js"),w=c("./util/triggerEvent.js"),x=d(w);b["default"]=g},"./imageTools/wwwc.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.element;c.removeEventListener(k["default"].MOUSE_DRAG,h),c.removeEventListener(k["default"].MOUSE_UP,e),c.removeEventListener(k["default"].MOUSE_CLICK,e)}function f(a){var b=a.detail,c=b.element,d=(0,t.getToolOptions)(u,c);(0,s["default"])(b.which,d.mouseButtonMask)&&(c.addEventListener(k["default"].MOUSE_DRAG,h),c.addEventListener(k["default"].MOUSE_UP,e),c.addEventListener(k["default"].MOUSE_CLICK,e),a.preventDefault(),a.stopPropagation())}function g(a){var b=a.image.maxPixelValue*a.image.slope+a.image.intercept,c=a.image.minPixelValue*a.image.slope+a.image.intercept,d=b-c,e=d/1024,f=a.deltaPoints.page.x*e,g=a.deltaPoints.page.y*e;a.viewport.voi.windowWidth+=f,a.viewport.voi.windowCenter+=g}function h(a){var b=a.detail;v.strategy(b),m["default"].cornerstone.setViewport(b.element,b.viewport)}function i(a){var b=a.detail;a.stopImmediatePropagation();var c=b,d=c.image.maxPixelValue*c.image.slope+c.image.intercept,e=c.image.minPixelValue*c.image.slope+c.image.intercept,f=d-e,g=f/1024,h=c.deltaPoints.page.x*g,i=c.deltaPoints.page.y*g,j=v.getConfiguration();j.orientation?0===j.orientation?(c.viewport.voi.windowWidth+=h,c.viewport.voi.windowCenter+=i):(c.viewport.voi.windowWidth+=i,c.viewport.voi.windowCenter+=h):(c.viewport.voi.windowWidth+=h,c.viewport.voi.windowCenter+=i),m["default"].cornerstone.setViewport(c.element,c.viewport)}Object.defineProperty(b,"__esModule",{value:!0}),b.wwwcTouchDrag=b.wwwc=void 0;var j=c("./events.js"),k=d(j),l=c("./externalModules.js"),m=d(l),n=c("./imageTools/simpleMouseButtonTool.js"),o=d(n),p=c("./imageTools/touchDragTool.js"),q=d(p),r=c("./util/isMouseButtonEnabled.js"),s=d(r),t=c("./toolOptions.js"),u="wwwc",v=(0,o["default"])(f,u);v.strategies={"default":g},v.strategy=g;var w=(0,q["default"])(i);b.wwwc=v,b.wwwcTouchDrag=w},"./imageTools/wwwcRegion.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=a.length;if(d<2)return{min:b,max:c,mean:(b+c)/2};for(var e=c,f=b,g=0,h=0;h<d;h++){var i=a[h];e=Math.min(e,i),f=Math.max(f,i),g+=i}return{min:e,max:f,mean:g/d}}function f(a){var b=a.detail,c=b.element,d=(0,z.getToolState)(c,I);d&&d.data&&(d.data=[]),c.removeEventListener(u["default"].MOUSE_MOVE,l),c.removeEventListener(u["default"].MOUSE_DRAG,l),c.removeEventListener(u["default"].MOUSE_UP,g),c.removeEventListener(u["default"].MOUSE_CLICK,g),c.addEventListener(u["default"].MOUSE_DOWN,j)}function g(a){var b=a.detail,c=b.element;c.removeEventListener(u["default"].MOUSE_MOVE,l),c.removeEventListener(u["default"].MOUSE_DRAG,l),c.removeEventListener(u["default"].MOUSE_UP,g),c.removeEventListener(u["default"].MOUSE_CLICK,g),c.addEventListener(u["default"].MOUSE_DOWN,j);var d=(0,z.getToolState)(b.element,I);d&&d.data&&d.data.length&&(d.data[0].endPoint={x:b.currentPoints.image.x,y:b.currentPoints.image.y},h(b))}function h(a){var b=w["default"].cornerstone,c=(0,z.getToolState)(a.element,I);if(c&&c.data&&c.data.length){var d=c.data[0].startPoint,f=c.data[0].endPoint,g=Math.abs(d.x-f.x),h=Math.abs(d.y-f.y),i=Math.min(d.x,f.x),j=Math.min(d.y,f.y);i=(0,G["default"])(i,0,a.image.width),j=(0,G["default"])(j,0,a.image.height),g=Math.floor(Math.min(g,Math.abs(a.image.width-i))),h=Math.floor(Math.min(h,Math.abs(a.image.height-j)));var k=(0,B["default"])(a.element,i,j,g,h),l=e(k,a.image.minPixelValue,a.image.maxPixelValue),m=K.getConfiguration(),n=b.getViewport(a.element);void 0===m.minWindowWidth&&(m.minWindowWidth=10),n.voi.windowWidth=Math.max(Math.abs(l.max-l.min),m.minWindowWidth),n.voi.windowCenter=l.mean,b.setViewport(a.element,n),c.data=[],b.updateImage(a.element)}}function i(a){var b=a.detail,c=b.element;c.removeEventListener(u["default"].MOUSE_MOVE,i),c.removeEventListener(u["default"].MOUSE_DRAG,i),c.addEventListener(u["default"].MOUSE_MOVE,l),c.addEventListener(u["default"].MOUSE_DRAG,l),c.addEventListener(u["default"].MOUSE_CLICK,g),a.type===u["default"].MOUSE_DRAG&&c.addEventListener(u["default"].MOUSE_UP,g)}function j(a){var b=a.detail,c=b.element,d=(0,E.getToolOptions)(I,c);if((0,D["default"])(b.which,d.mouseButtonMask))return c.addEventListener(u["default"].MOUSE_DRAG,i),c.addEventListener(u["default"].MOUSE_MOVE,i),c.removeEventListener(u["default"].MOUSE_DOWN,j),k(b),!1}function k(a){var b=(0,z.getToolState)(a.element,I);b&&b.data&&(b.data=[]);var c={startPoint:{x:a.currentPoints.image.x,y:a.currentPoints.image.y}};(0,z.addToolState)(a.element,I,c)}function l(a){var b=a.detail,c=b.element,d=(0,z.getToolState)(c,I);d&&d.data&&d.data.length&&(d.data[0].endPoint={x:b.currentPoints.image.x,y:b.currentPoints.image.y},w["default"].cornerstone.updateImage(c))}function m(a){var b=a.detail,c=b.element,d=b.canvasContext,e=(0,z.getToolState)(b.element,I);if(e&&e.data&&e.data.length){var f=e.data[0].startPoint,g=e.data[0].endPoint;if(f&&g){d.setTransform(1,0,0,1,0,0);var h=y["default"].getActiveColor(),i=K.getConfiguration();(0,H.draw)(d,function(a){(0,H.setShadow)(a,i),(0,H.drawRect)(a,c,f,g,{color:h})})}}}function n(a){a.removeEventListener(u["default"].MOUSE_DOWN,j),a.removeEventListener(u["default"].MOUSE_UP,g),a.removeEventListener(u["default"].MOUSE_CLICK,g),a.removeEventListener(u["default"].MOUSE_DRAG,l),a.removeEventListener(u["default"].MOUSE_MOVE,l),a.removeEventListener(w["default"].cornerstone.EVENTS.IMAGE_RENDERED,m),a.removeEventListener(w["default"].cornerstone.EVENTS.NEW_IMAGE,f),w["default"].cornerstone.updateImage(a)}function o(a,b){(0,E.setToolOptions)(I,a,{mouseButtonMask:b});var c=(0,z.getToolState)(a,I);if(!c){var d=[];(0,z.addToolState)(a,I,d)}a.removeEventListener(u["default"].MOUSE_DOWN,j),a.removeEventListener(u["default"].MOUSE_UP,g),a.removeEventListener(u["default"].MOUSE_CLICK,g),a.removeEventListener(u["default"].MOUSE_DRAG,l),a.removeEventListener(u["default"].MOUSE_MOVE,l),a.removeEventListener(w["default"].cornerstone.EVENTS.IMAGE_RENDERED,m),a.removeEventListener(w["default"].cornerstone.EVENTS.NEW_IMAGE,f),a.addEventListener(u["default"].MOUSE_DOWN,j),a.addEventListener(w["default"].cornerstone.EVENTS.IMAGE_RENDERED,m),a.addEventListener(w["default"].cornerstone.EVENTS.NEW_IMAGE,f),w["default"].cornerstone.updateImage(a)}function p(a){a.removeEventListener(u["default"].TOUCH_DRAG,l),a.removeEventListener(u["default"].TOUCH_START,k),a.removeEventListener(u["default"].TOUCH_DRAG_END,h),a.removeEventListener(w["default"].cornerstone.EVENTS.IMAGE_RENDERED,m)}function q(a){var b=(0,z.getToolState)(a,I);if(!b){var c=[];(0,z.addToolState)(a,I,c)}a.removeEventListener(u["default"].TOUCH_DRAG,l),a.removeEventListener(u["default"].TOUCH_START,k),a.removeEventListener(u["default"].TOUCH_DRAG_END,h),a.removeEventListener(w["default"].cornerstone.EVENTS.IMAGE_RENDERED,m),a.addEventListener(u["default"].TOUCH_DRAG,l),a.addEventListener(u["default"].TOUCH_START,k),a.addEventListener(u["default"].TOUCH_DRAG_END,h),a.addEventListener(w["default"].cornerstone.EVENTS.IMAGE_RENDERED,m)}function r(){return J}function s(a){J=a}Object.defineProperty(b,"__esModule",{value:!0}),b.wwwcRegionTouch=b.wwwcRegion=void 0;var t=c("./events.js"),u=d(t),v=c("./externalModules.js"),w=d(v),x=c("./stateManagement/toolColors.js"),y=d(x),z=c("./stateManagement/toolState.js"),A=c("./util/getLuminance.js"),B=d(A),C=c("./util/isMouseButtonEnabled.js"),D=d(C),E=c("./toolOptions.js"),F=c("./util/clip.js"),G=d(F),H=c("./util/drawing.js"),I="wwwcRegion",J={minWindowWidth:10},K={activate:o,deactivate:n,disable:n,setConfiguration:s,getConfiguration:r},L={activate:q,deactivate:p,disable:p};b.wwwcRegion=K,b.wwwcRegionTouch=L},"./imageTools/zoom.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){var c=G.getConfiguration(),d=1.7,e=Math.log(a.scale)/Math.log(d),f=e+b,g=Math.pow(d,f);return c.maxScale&&g>c.maxScale?a.scale=c.maxScale:c.minScale&&g<c.minScale?a.scale=c.minScale:a.scale=g,a}function f(a,b){if(b.hflip&&(a.x*=-1),b.vflip&&(a.y*=-1),0!==b.rotation){var c=b.rotation*Math.PI/180,d=Math.cos(c),e=Math.sin(c),f=a.x*d-a.y*e,g=a.x*e+a.y*d;a.x=f,a.y=g}return a}function g(a,b){var c=r["default"].cornerstone,d=a.element,f=e(a.viewport,b);c.setViewport(d,f)}function h(a,b){var c=a.element,d=a.image,g=G.getConfiguration(),h=e(a.viewport,b),i={x:0,y:0},j=8,k=3,l=.01;if(b<0)h.scale<k&&(Math.abs(h.translation.x)<l?h.translation.x=0:i.x=h.translation.x/j,Math.abs(h.translation.y)<l?h.translation.y=0:i.y=h.translation.y/j);else{g&&g.preventZoomOutsideImage&&(0,D.clipToBox)(F.image,d);var m={x:d.width/2-F.image.x,y:d.height/2-F.image.y};m=f(m,h);var n={x:h.translation.x-m.x,y:h.translation.y-m.y};Math.abs(n.x)<l?h.translation.x=m.x:i.x=n.x/j,Math.abs(n.y)<l?h.translation.y=m.y:i.y=n.y/j}h.translation.x-=i.x,h.translation.y-=i.y,r["default"].cornerstone.setViewport(c,h)}function i(a,b){var c=a.element,d=e(a.viewport,b);r["default"].cornerstone.setViewport(c,d)}function j(a){var b=a.detail,c=b.element;c.removeEventListener(p["default"].MOUSE_DRAG,l),c.removeEventListener(p["default"].MOUSE_UP,j),c.removeEventListener(p["default"].MOUSE_CLICK,j)}function k(a){var b=a.detail,c=b.element,d=(0,C.getToolOptions)(E,c);(0,v["default"])(b.which,d.mouseButtonMask)&&(F=b.startPoints,c.addEventListener(p["default"].MOUSE_DRAG,l),c.addEventListener(p["default"].MOUSE_UP,j),c.addEventListener(p["default"].MOUSE_CLICK,j),a.preventDefault(),a.stopPropagation())}function l(a){var b=a.detail;if(!b.deltaPoints.page.y)return!1;var c=b.deltaPoints.page.y/100,d=G.getConfiguration();d&&d.invert&&(c*=-1),G.strategy(b,c),a.preventDefault(),a.stopPropagation()}function m(a){var b=a.detail,c=-b.direction/4,d=G.getConfiguration();d&&d.invert&&(c*=-1);var f=e(b.viewport,c);r["default"].cornerstone.setViewport(b.element,f)}function n(a){var b=a.detail,c=r["default"].cornerstone,d=G.getConfiguration(),e=b.viewport,g=b.element;e.scale+=b.scaleChange*e.scale,d.maxScale&&e.scale>d.maxScale?e.scale=d.maxScale:d.minScale&&e.scale<d.minScale&&(e.scale=d.minScale),c.setViewport(g,e);var h=c.pageToPixel(g,b.startPoints.page.x,b.startPoints.page.y),i={x:b.startPoints.image.x-h.x,y:b.startPoints.image.y-h.y};i=f(i,e),e.translation.x-=i.x,e.translation.y-=i.y,c.setViewport(g,e)}Object.defineProperty(b,"__esModule",{value:!0}),b.zoomTouchDrag=b.zoomTouchPinch=b.zoomWheel=b.zoom=void 0;var o=c("./events.js"),p=d(o),q=c("./externalModules.js"),r=d(q),s=c("./imageTools/simpleMouseButtonTool.js"),t=d(s),u=c("./util/isMouseButtonEnabled.js"),v=d(u),w=c("./imageTools/mouseWheelTool.js"),x=d(w),y=c("./imageTools/touchPinchTool.js"),z=d(y),A=c("./imageTools/touchDragTool.js"),B=d(A),C=c("./toolOptions.js"),D=c("./util/clip.js"),E="zoom",F=void 0,G=(0,t["default"])(k,E);G.strategies={"default":g,translate:h,zoomToCenter:i},G.strategy=g;var H=(0,x["default"])(m),I=(0,z["default"])(n),J=(0,B["default"])(l,E);b.zoom=G,b.zoomWheel=H,b.zoomTouchPinch=I,b.zoomTouchDrag=J},"./index.js":function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b.getToolOptions=b.setToolOptions=b.version=b.adaptiveBrush=b.brush=b.zoomTouchDrag=b.zoomTouchPinch=b.zoomWheel=b.zoom=b.wwwcRegionTouch=b.wwwcRegion=b.wwwcTouchDrag=b.wwwc=b.touchTool=b.touchPinchTool=b.touchDragTool=b.textMarkerTouch=b.textMarker=b.simpleMouseButtonTool=b.simpleAngleTouch=b.simpleAngle=b.seedAnnotateTouch=b.seedAnnotate=b.scaleOverlayTool=b.saveAs=b.rotateTouch=b.rotateTouchDrag=b.rotate=b.rectangleRoiTouch=b.rectangleRoi=b.probeTouch=b.probe=b.panMultiTouch=b.panTouchDrag=b.pan=b.orientationMarkers=b.multiTouchDragTool=b.mouseWheelTool=b.mouseButtonTool=b.mouseButtonRectangleTool=b.magnifyTouchDrag=b.magnify=b.lengthTouch=b.length=b.keyboardTool=b.imageStats=b.highlightTouch=b.highlight=b.freehandSculpter=b.freehand=b.eraserTouch=b.eraser=b.ellipticalRoiTouch=b.ellipticalRoi=b.dragProbeTouch=void 0,b.dragProbe=b.doubleTapZoom=b.doubleTapTool=b.displayTool=b.crosshairsTouch=b.crosshairs=b.arrowAnnotateTouch=b.arrowAnnotate=b.angleTouch=b.angle=b.touchInput=b.preventGhostClick=b.mouseWheelInput=b.mouseInput=b.keyboardInput=b.touchMoveHandle=b.touchMoveAllHandles=b.moveNewHandleTouch=b.moveNewHandle=b.moveHandle=b.moveAllHandles=b.handleActivator=b.getHandleNearImagePoint=b.drawHandles=b.anyHandlesOutsideImage=b.stopClip=b.playClip=b.stackRenderers=b.scrollIndicator=b.stackPrefetch=b.stackScrollMultiTouch=b.stackScrollTouchDrag=b.stackScrollWheel=b.stackScroll=b.stackScrollKeyboard=b.appState=b.globalFrameOfReferenceSpecificToolStateManager=b.newFrameOfReferenceSpecificToolStateManager=b.globalImageIdSpecificToolStateManager=b.newImageIdSpecificToolStateManager=b.loadHandlerManager=b.addStackStateManager=b.newStackSpecificToolStateManager=b.stackSpecificStateManager=b.textStyle=b.newTimeSeriesSpecificToolStateManager=b.addTimeSeriesStateManager=b.toolColors=b.toolCoordinates=b.getElementToolStateManager=b.setElementToolStateManager=b.clearToolState=b.removeToolState=b.getToolState=b.addToolState=b.toolStyle=b.panZoomSynchronizer=b.stackImageIndexSynchronizer=b.stackImagePositionOffsetSynchronizer=b.stackImagePositionSynchronizer=b.stackScrollSynchronizer=b.Synchronizer=b.updateImageSynchronizer=b.wwwcSynchronizer=b.timeSeriesScrollTouchDrag=b.timeSeriesScrollWheel=b.timeSeriesScroll=b.timeSeriesPlayer=b.incrementTimePoint=b.probeTool4D=b.calculateEllipseStatistics=b.calculateSUV=b.copyPoints=b.drawArrow=b.drawCircle=b.drawEllipse=b.drawTextBox=b.getLuminance=b.isMobileDevice=b.getBrowserInfo=b.getMaxSimultaneousRequests=b.getDefaultSimultaneousRequests=b.getRGBPixels=b.isMouseButtonEnabled=b.makeUnselectable=b.pointInEllipse=b.pointInsideBoundingBox=b.planePlaneIntersection=b.imagePointToPatientPoint=b.projectPatientPointToImagePlane=b.roundToDecimal=b.scroll=b.scrollToIndex=b.setContextToDisplayFontSize=b.requestPoolManager=b.orientation=b.referenceLines=b.EVENTS=b.external=b.drawing=void 0;var f=c("./externalModules.js");Object.defineProperty(b,"external",{enumerable:!0,get:function(){return e(f)["default"]}});var g=c("./events.js");Object.defineProperty(b,"EVENTS",{enumerable:!0,get:function(){return e(g)["default"]}});var h=c("./referenceLines/index.js");Object.defineProperty(b,"referenceLines",{enumerable:!0,get:function(){return e(h)["default"]}});var i=c("./orientation/index.js");Object.defineProperty(b,"orientation",{enumerable:!0,get:function(){return e(i)["default"]}});var j=c("./requestPool/requestPoolManager.js");Object.defineProperty(b,"requestPoolManager",{enumerable:!0,get:function(){return e(j)["default"]}});var k=c("./util/setContextToDisplayFontSize.js");Object.defineProperty(b,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return e(k)["default"]}});var l=c("./util/scrollToIndex.js");Object.defineProperty(b,"scrollToIndex",{enumerable:!0,get:function(){return e(l)["default"]}});var m=c("./util/scroll.js");
Object.defineProperty(b,"scroll",{enumerable:!0,get:function(){return e(m)["default"]}});var n=c("./util/roundToDecimal.js");Object.defineProperty(b,"roundToDecimal",{enumerable:!0,get:function(){return e(n)["default"]}});var o=c("./util/pointProjector.js");Object.defineProperty(b,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return o.projectPatientPointToImagePlane}}),Object.defineProperty(b,"imagePointToPatientPoint",{enumerable:!0,get:function(){return o.imagePointToPatientPoint}}),Object.defineProperty(b,"planePlaneIntersection",{enumerable:!0,get:function(){return o.planePlaneIntersection}});var p=c("./util/pointInsideBoundingBox.js");Object.defineProperty(b,"pointInsideBoundingBox",{enumerable:!0,get:function(){return e(p)["default"]}});var q=c("./util/pointInEllipse.js");Object.defineProperty(b,"pointInEllipse",{enumerable:!0,get:function(){return e(q)["default"]}});var r=c("./util/makeUnselectable.js");Object.defineProperty(b,"makeUnselectable",{enumerable:!0,get:function(){return e(r)["default"]}});var s=c("./util/isMouseButtonEnabled.js");Object.defineProperty(b,"isMouseButtonEnabled",{enumerable:!0,get:function(){return e(s)["default"]}});var t=c("./util/getRGBPixels.js");Object.defineProperty(b,"getRGBPixels",{enumerable:!0,get:function(){return e(t)["default"]}});var u=c("./util/getMaxSimultaneousRequests.js");Object.defineProperty(b,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return u.getDefaultSimultaneousRequests}}),Object.defineProperty(b,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return u.getMaxSimultaneousRequests}}),Object.defineProperty(b,"getBrowserInfo",{enumerable:!0,get:function(){return u.getBrowserInfo}}),Object.defineProperty(b,"isMobileDevice",{enumerable:!0,get:function(){return u.isMobileDevice}});var v=c("./util/getLuminance.js");Object.defineProperty(b,"getLuminance",{enumerable:!0,get:function(){return e(v)["default"]}});var w=c("./util/drawTextBox.js");Object.defineProperty(b,"drawTextBox",{enumerable:!0,get:function(){return e(w)["default"]}});var x=c("./util/drawEllipse.js");Object.defineProperty(b,"drawEllipse",{enumerable:!0,get:function(){return e(x)["default"]}});var y=c("./util/drawCircle.js");Object.defineProperty(b,"drawCircle",{enumerable:!0,get:function(){return e(y)["default"]}});var z=c("./util/drawArrow.js");Object.defineProperty(b,"drawArrow",{enumerable:!0,get:function(){return e(z)["default"]}});var A=c("./util/copyPoints.js");Object.defineProperty(b,"copyPoints",{enumerable:!0,get:function(){return e(A)["default"]}});var B=c("./util/calculateSUV.js");Object.defineProperty(b,"calculateSUV",{enumerable:!0,get:function(){return e(B)["default"]}});var C=c("./util/calculateEllipseStatistics.js");Object.defineProperty(b,"calculateEllipseStatistics",{enumerable:!0,get:function(){return e(C)["default"]}});var D=c("./timeSeriesTools/probeTool4D.js");Object.defineProperty(b,"probeTool4D",{enumerable:!0,get:function(){return e(D)["default"]}});var E=c("./timeSeriesTools/incrementTimePoint.js");Object.defineProperty(b,"incrementTimePoint",{enumerable:!0,get:function(){return e(E)["default"]}});var F=c("./timeSeriesTools/timeSeriesPlayer.js");Object.defineProperty(b,"timeSeriesPlayer",{enumerable:!0,get:function(){return e(F)["default"]}});var G=c("./timeSeriesTools/timeSeriesScroll.js");Object.defineProperty(b,"timeSeriesScroll",{enumerable:!0,get:function(){return G.timeSeriesScroll}}),Object.defineProperty(b,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return G.timeSeriesScrollWheel}}),Object.defineProperty(b,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return G.timeSeriesScrollTouchDrag}});var H=c("./synchronization/wwwcSynchronizer.js");Object.defineProperty(b,"wwwcSynchronizer",{enumerable:!0,get:function(){return e(H)["default"]}});var I=c("./synchronization/updateImageSynchronizer.js");Object.defineProperty(b,"updateImageSynchronizer",{enumerable:!0,get:function(){return e(I)["default"]}});var J=c("./synchronization/Synchronizer.js");Object.defineProperty(b,"Synchronizer",{enumerable:!0,get:function(){return e(J)["default"]}});var K=c("./synchronization/stackScrollSynchronizer.js");Object.defineProperty(b,"stackScrollSynchronizer",{enumerable:!0,get:function(){return e(K)["default"]}});var L=c("./synchronization/stackImagePositionSynchronizer.js");Object.defineProperty(b,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return e(L)["default"]}});var M=c("./synchronization/stackImagePositionOffsetSynchronizer.js");Object.defineProperty(b,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return e(M)["default"]}});var N=c("./synchronization/stackImageIndexSynchronizer.js");Object.defineProperty(b,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return e(N)["default"]}});var O=c("./synchronization/panZoomSynchronizer.js");Object.defineProperty(b,"panZoomSynchronizer",{enumerable:!0,get:function(){return e(O)["default"]}});var P=c("./stateManagement/toolStyle.js");Object.defineProperty(b,"toolStyle",{enumerable:!0,get:function(){return e(P)["default"]}});var Q=c("./stateManagement/toolState.js");Object.defineProperty(b,"addToolState",{enumerable:!0,get:function(){return Q.addToolState}}),Object.defineProperty(b,"getToolState",{enumerable:!0,get:function(){return Q.getToolState}}),Object.defineProperty(b,"removeToolState",{enumerable:!0,get:function(){return Q.removeToolState}}),Object.defineProperty(b,"clearToolState",{enumerable:!0,get:function(){return Q.clearToolState}}),Object.defineProperty(b,"setElementToolStateManager",{enumerable:!0,get:function(){return Q.setElementToolStateManager}}),Object.defineProperty(b,"getElementToolStateManager",{enumerable:!0,get:function(){return Q.getElementToolStateManager}});var R=c("./stateManagement/toolCoordinates.js");Object.defineProperty(b,"toolCoordinates",{enumerable:!0,get:function(){return e(R)["default"]}});var S=c("./stateManagement/toolColors.js");Object.defineProperty(b,"toolColors",{enumerable:!0,get:function(){return e(S)["default"]}});var T=c("./stateManagement/timeSeriesSpecificStateManager.js");Object.defineProperty(b,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return T.addTimeSeriesStateManager}}),Object.defineProperty(b,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return T.newTimeSeriesSpecificToolStateManager}});var U=c("./stateManagement/textStyle.js");Object.defineProperty(b,"textStyle",{enumerable:!0,get:function(){return e(U)["default"]}});var V=c("./stateManagement/stackSpecificStateManager.js");Object.defineProperty(b,"stackSpecificStateManager",{enumerable:!0,get:function(){return V.stackSpecificStateManager}}),Object.defineProperty(b,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return V.newStackSpecificToolStateManager}}),Object.defineProperty(b,"addStackStateManager",{enumerable:!0,get:function(){return V.addStackStateManager}});var W=c("./stateManagement/loadHandlerManager.js");Object.defineProperty(b,"loadHandlerManager",{enumerable:!0,get:function(){return e(W)["default"]}});var X=c("./stateManagement/imageIdSpecificStateManager.js");Object.defineProperty(b,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return X.newImageIdSpecificToolStateManager}}),Object.defineProperty(b,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return X.globalImageIdSpecificToolStateManager}});var Y=c("./stateManagement/frameOfReferenceStateManager.js");Object.defineProperty(b,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Y.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(b,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Y.globalFrameOfReferenceSpecificToolStateManager}});var Z=c("./stateManagement/appState.js");Object.defineProperty(b,"appState",{enumerable:!0,get:function(){return e(Z)["default"]}});var $=c("./stackTools/stackScrollKeyboard.js");Object.defineProperty(b,"stackScrollKeyboard",{enumerable:!0,get:function(){return e($)["default"]}});var _=c("./stackTools/stackScroll.js");Object.defineProperty(b,"stackScroll",{enumerable:!0,get:function(){return _.stackScroll}}),Object.defineProperty(b,"stackScrollWheel",{enumerable:!0,get:function(){return _.stackScrollWheel}}),Object.defineProperty(b,"stackScrollTouchDrag",{enumerable:!0,get:function(){return _.stackScrollTouchDrag}}),Object.defineProperty(b,"stackScrollMultiTouch",{enumerable:!0,get:function(){return _.stackScrollMultiTouch}});var aa=c("./stackTools/stackPrefetch.js");Object.defineProperty(b,"stackPrefetch",{enumerable:!0,get:function(){return e(aa)["default"]}});var ba=c("./stackTools/scrollIndicator.js");Object.defineProperty(b,"scrollIndicator",{enumerable:!0,get:function(){return e(ba)["default"]}});var ca=c("./stackTools/stackRenderers.js");Object.defineProperty(b,"stackRenderers",{enumerable:!0,get:function(){return e(ca)["default"]}});var da=c("./stackTools/playClip.js");Object.defineProperty(b,"playClip",{enumerable:!0,get:function(){return da.playClip}}),Object.defineProperty(b,"stopClip",{enumerable:!0,get:function(){return da.stopClip}});var ea=c("./manipulators/anyHandlesOutsideImage.js");Object.defineProperty(b,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return e(ea)["default"]}});var fa=c("./manipulators/drawHandles.js");Object.defineProperty(b,"drawHandles",{enumerable:!0,get:function(){return e(fa)["default"]}});var ga=c("./manipulators/getHandleNearImagePoint.js");Object.defineProperty(b,"getHandleNearImagePoint",{enumerable:!0,get:function(){return e(ga)["default"]}});var ha=c("./manipulators/handleActivator.js");Object.defineProperty(b,"handleActivator",{enumerable:!0,get:function(){return e(ha)["default"]}});var ia=c("./manipulators/moveAllHandles.js");Object.defineProperty(b,"moveAllHandles",{enumerable:!0,get:function(){return e(ia)["default"]}});var ja=c("./manipulators/moveHandle.js");Object.defineProperty(b,"moveHandle",{enumerable:!0,get:function(){return e(ja)["default"]}});var ka=c("./manipulators/moveNewHandle.js");Object.defineProperty(b,"moveNewHandle",{enumerable:!0,get:function(){return e(ka)["default"]}});var la=c("./manipulators/moveNewHandleTouch.js");Object.defineProperty(b,"moveNewHandleTouch",{enumerable:!0,get:function(){return e(la)["default"]}});var ma=c("./manipulators/touchMoveAllHandles.js");Object.defineProperty(b,"touchMoveAllHandles",{enumerable:!0,get:function(){return e(ma)["default"]}});var na=c("./manipulators/touchMoveHandle.js");Object.defineProperty(b,"touchMoveHandle",{enumerable:!0,get:function(){return e(na)["default"]}});var oa=c("./inputSources/keyboardInput.js");Object.defineProperty(b,"keyboardInput",{enumerable:!0,get:function(){return e(oa)["default"]}});var pa=c("./inputSources/mouseInput.js");Object.defineProperty(b,"mouseInput",{enumerable:!0,get:function(){return e(pa)["default"]}});var qa=c("./inputSources/mouseWheelInput.js");Object.defineProperty(b,"mouseWheelInput",{enumerable:!0,get:function(){return e(qa)["default"]}});var ra=c("./inputSources/preventGhostClick.js");Object.defineProperty(b,"preventGhostClick",{enumerable:!0,get:function(){return e(ra)["default"]}});var sa=c("./inputSources/touchInput.js");Object.defineProperty(b,"touchInput",{enumerable:!0,get:function(){return e(sa)["default"]}});var ta=c("./imageTools/angleTool.js");Object.defineProperty(b,"angle",{enumerable:!0,get:function(){return ta.angle}}),Object.defineProperty(b,"angleTouch",{enumerable:!0,get:function(){return ta.angleTouch}});var ua=c("./imageTools/arrowAnnotate.js");Object.defineProperty(b,"arrowAnnotate",{enumerable:!0,get:function(){return ua.arrowAnnotate}}),Object.defineProperty(b,"arrowAnnotateTouch",{enumerable:!0,get:function(){return ua.arrowAnnotateTouch}});var va=c("./imageTools/crosshairs.js");Object.defineProperty(b,"crosshairs",{enumerable:!0,get:function(){return va.crosshairs}}),Object.defineProperty(b,"crosshairsTouch",{enumerable:!0,get:function(){return va.crosshairsTouch}});var wa=c("./imageTools/displayTool.js");Object.defineProperty(b,"displayTool",{enumerable:!0,get:function(){return e(wa)["default"]}});var xa=c("./imageTools/doubleTapTool.js");Object.defineProperty(b,"doubleTapTool",{enumerable:!0,get:function(){return e(xa)["default"]}});var ya=c("./imageTools/doubleTapZoom.js");Object.defineProperty(b,"doubleTapZoom",{enumerable:!0,get:function(){return e(ya)["default"]}});var za=c("./imageTools/dragProbe.js");Object.defineProperty(b,"dragProbe",{enumerable:!0,get:function(){return za.dragProbe}}),Object.defineProperty(b,"dragProbeTouch",{enumerable:!0,get:function(){return za.dragProbeTouch}});var Aa=c("./imageTools/ellipticalRoi.js");Object.defineProperty(b,"ellipticalRoi",{enumerable:!0,get:function(){return Aa.ellipticalRoi}}),Object.defineProperty(b,"ellipticalRoiTouch",{enumerable:!0,get:function(){return Aa.ellipticalRoiTouch}});var Ba=c("./imageTools/eraser.js");Object.defineProperty(b,"eraser",{enumerable:!0,get:function(){return Ba.eraser}}),Object.defineProperty(b,"eraserTouch",{enumerable:!0,get:function(){return Ba.eraserTouch}});var Ca=c("./imageTools/freehand.js");Object.defineProperty(b,"freehand",{enumerable:!0,get:function(){return Ca.freehand}});var Da=c("./imageTools/freehandSculpter.js");Object.defineProperty(b,"freehandSculpter",{enumerable:!0,get:function(){return Da.freehandSculpter}});var Ea=c("./imageTools/highlight.js");Object.defineProperty(b,"highlight",{enumerable:!0,get:function(){return Ea.highlight}}),Object.defineProperty(b,"highlightTouch",{enumerable:!0,get:function(){return Ea.highlightTouch}});var Fa=c("./imageTools/imageStats.js");Object.defineProperty(b,"imageStats",{enumerable:!0,get:function(){return e(Fa)["default"]}});var Ga=c("./imageTools/keyboardTool.js");Object.defineProperty(b,"keyboardTool",{enumerable:!0,get:function(){return e(Ga)["default"]}});var Ha=c("./imageTools/length.js");Object.defineProperty(b,"length",{enumerable:!0,get:function(){return Ha.length}}),Object.defineProperty(b,"lengthTouch",{enumerable:!0,get:function(){return Ha.lengthTouch}});var Ia=c("./imageTools/magnify.js");Object.defineProperty(b,"magnify",{enumerable:!0,get:function(){return Ia.magnify}}),Object.defineProperty(b,"magnifyTouchDrag",{enumerable:!0,get:function(){return Ia.magnifyTouchDrag}});var Ja=c("./imageTools/mouseButtonRectangleTool.js");Object.defineProperty(b,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return e(Ja)["default"]}});var Ka=c("./imageTools/mouseButtonTool.js");Object.defineProperty(b,"mouseButtonTool",{enumerable:!0,get:function(){return e(Ka)["default"]}});var La=c("./imageTools/mouseWheelTool.js");Object.defineProperty(b,"mouseWheelTool",{enumerable:!0,get:function(){return e(La)["default"]}});var Ma=c("./imageTools/multiTouchDragTool.js");Object.defineProperty(b,"multiTouchDragTool",{enumerable:!0,get:function(){return e(Ma)["default"]}});var Na=c("./imageTools/orientationMarkers.js");Object.defineProperty(b,"orientationMarkers",{enumerable:!0,get:function(){return e(Na)["default"]}});var Oa=c("./imageTools/pan.js");Object.defineProperty(b,"pan",{enumerable:!0,get:function(){return Oa.pan}}),Object.defineProperty(b,"panTouchDrag",{enumerable:!0,get:function(){return Oa.panTouchDrag}});var Pa=c("./imageTools/panMultiTouch.js");Object.defineProperty(b,"panMultiTouch",{enumerable:!0,get:function(){return e(Pa)["default"]}});var Qa=c("./imageTools/probe.js");Object.defineProperty(b,"probe",{enumerable:!0,get:function(){return Qa.probe}}),Object.defineProperty(b,"probeTouch",{enumerable:!0,get:function(){return Qa.probeTouch}});var Ra=c("./imageTools/rectangleRoi.js");Object.defineProperty(b,"rectangleRoi",{enumerable:!0,get:function(){return Ra.rectangleRoi}}),Object.defineProperty(b,"rectangleRoiTouch",{enumerable:!0,get:function(){return Ra.rectangleRoiTouch}});var Sa=c("./imageTools/rotate.js");Object.defineProperty(b,"rotate",{enumerable:!0,get:function(){return Sa.rotate}}),Object.defineProperty(b,"rotateTouchDrag",{enumerable:!0,get:function(){return Sa.rotateTouchDrag}});var Ta=c("./imageTools/rotateTouch.js");Object.defineProperty(b,"rotateTouch",{enumerable:!0,get:function(){return e(Ta)["default"]}});var Ua=c("./imageTools/saveAs.js");Object.defineProperty(b,"saveAs",{enumerable:!0,get:function(){return e(Ua)["default"]}});var Va=c("./imageTools/scaleOverlayTool.js");Object.defineProperty(b,"scaleOverlayTool",{enumerable:!0,get:function(){return e(Va)["default"]}});var Wa=c("./imageTools/seedAnnotate.js");Object.defineProperty(b,"seedAnnotate",{enumerable:!0,get:function(){return Wa.seedAnnotate}}),Object.defineProperty(b,"seedAnnotateTouch",{enumerable:!0,get:function(){return Wa.seedAnnotateTouch}});var Xa=c("./imageTools/simpleAngle.js");Object.defineProperty(b,"simpleAngle",{enumerable:!0,get:function(){return Xa.simpleAngle}}),Object.defineProperty(b,"simpleAngleTouch",{enumerable:!0,get:function(){return Xa.simpleAngleTouch}});var Ya=c("./imageTools/simpleMouseButtonTool.js");Object.defineProperty(b,"simpleMouseButtonTool",{enumerable:!0,get:function(){return e(Ya)["default"]}});var Za=c("./imageTools/textMarker.js");Object.defineProperty(b,"textMarker",{enumerable:!0,get:function(){return Za.textMarker}}),Object.defineProperty(b,"textMarkerTouch",{enumerable:!0,get:function(){return Za.textMarkerTouch}});var $a=c("./imageTools/touchDragTool.js");Object.defineProperty(b,"touchDragTool",{enumerable:!0,get:function(){return e($a)["default"]}});var _a=c("./imageTools/touchPinchTool.js");Object.defineProperty(b,"touchPinchTool",{enumerable:!0,get:function(){return e(_a)["default"]}});var ab=c("./imageTools/touchTool.js");Object.defineProperty(b,"touchTool",{enumerable:!0,get:function(){return e(ab)["default"]}});var bb=c("./imageTools/wwwc.js");Object.defineProperty(b,"wwwc",{enumerable:!0,get:function(){return bb.wwwc}}),Object.defineProperty(b,"wwwcTouchDrag",{enumerable:!0,get:function(){return bb.wwwcTouchDrag}});var cb=c("./imageTools/wwwcRegion.js");Object.defineProperty(b,"wwwcRegion",{enumerable:!0,get:function(){return cb.wwwcRegion}}),Object.defineProperty(b,"wwwcRegionTouch",{enumerable:!0,get:function(){return cb.wwwcRegionTouch}});var db=c("./imageTools/zoom.js");Object.defineProperty(b,"zoom",{enumerable:!0,get:function(){return db.zoom}}),Object.defineProperty(b,"zoomWheel",{enumerable:!0,get:function(){return db.zoomWheel}}),Object.defineProperty(b,"zoomTouchPinch",{enumerable:!0,get:function(){return db.zoomTouchPinch}}),Object.defineProperty(b,"zoomTouchDrag",{enumerable:!0,get:function(){return db.zoomTouchDrag}});var eb=c("./paintingTools/brush.js");Object.defineProperty(b,"brush",{enumerable:!0,get:function(){return eb.brush}});var fb=c("./paintingTools/adaptiveBrush.js");Object.defineProperty(b,"adaptiveBrush",{enumerable:!0,get:function(){return fb.adaptiveBrush}});var gb=c("./version.js");Object.defineProperty(b,"version",{enumerable:!0,get:function(){return e(gb)["default"]}});var hb=c("./toolOptions.js");Object.defineProperty(b,"setToolOptions",{enumerable:!0,get:function(){return hb.setToolOptions}}),Object.defineProperty(b,"getToolOptions",{enumerable:!0,get:function(){return hb.getToolOptions}});var ib=c("./util/drawing.js"),jb=d(ib);b.drawing=jb},"./inputSources/keyboardInput.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=l["default"].cornerstone,c=a.currentTarget,d=b.getEnabledElement(c);if(d.image){var e={event:window.event||a,element:c,viewport:b.getViewport(c),image:d.image,currentPoints:{page:{x:o,y:p},image:b.pageToPixel(c,o,p)},keyCode:a.keyCode,which:a.which};e.currentPoints.canvas=b.pixelToCanvas(c,e.currentPoints.image);var f={keydown:j["default"].KEY_DOWN,keypress:j["default"].KEY_PRESS,keyup:j["default"].KEY_UP};(0,n["default"])(c,f[a.type],e)}}function f(a){o=a.pageX,p=a.pageY}function g(a){q.forEach(function(b){a.removeEventListener(b,e),a.addEventListener(b,e)}),a.removeEventListener("mousemove",f),a.addEventListener("mousemove",f)}function h(a){q.forEach(function(b){a.removeEventListener(b,e)}),a.removeEventListener("mousemove",f)}Object.defineProperty(b,"__esModule",{value:!0});var i=c("./events.js"),j=d(i),k=c("./externalModules.js"),l=d(k),m=c("./util/triggerEvent.js"),n=d(m),o=void 0,p=void 0,q=["keydown","keypress","keyup"],r={enable:g,disable:h};b["default"]=r},"./inputSources/mouseInput.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return"number"!=typeof a.buttons?a.which:0===a.buttons?0:a.buttons%2===1?1:a.buttons%4===2?3:a.buttons%8===4?2:0}function f(){t=!1}function g(a){var b=o["default"].cornerstone,c=a.currentTarget,d=b.getEnabledElement(c);if(d.image){var e=m["default"].MOUSE_DOUBLE_CLICK,f={page:o["default"].cornerstoneMath.point.pageToPoint(a),image:b.pageToPixel(c,a.pageX,a.pageY),client:{x:a.clientX,y:a.clientY}};f.canvas=b.pixelToCanvas(c,f.image);var g=(0,q["default"])(f),h={event:a,which:a.which,viewport:b.getViewport(c),image:d.image,element:c,startPoints:f,lastPoints:g,currentPoints:f,deltaPoints:{x:0,y:0},type:e};(0,s["default"])(c,e,h)}}function h(a){function b(a){var b=m["default"].MOUSE_DRAG,c={page:o["default"].cornerstoneMath.point.pageToPoint(a),image:d.pageToPixel(g,a.pageX,a.pageY),client:{x:a.clientX,y:a.clientY}};c.canvas=d.pixelToCanvas(g,c.image);var e={page:o["default"].cornerstoneMath.point.subtract(c.page,l.page),image:o["default"].cornerstoneMath.point.subtract(c.image,l.image),client:o["default"].cornerstoneMath.point.subtract(c.client,l.client),canvas:o["default"].cornerstoneMath.point.subtract(c.canvas,l.canvas)},f={which:r,viewport:d.getViewport(g),image:h.image,element:g,startPoints:k,lastPoints:l,currentPoints:c,deltaPoints:e,type:b,ctrlKey:a.ctrlKey,metaKey:a.metaKey,shiftKey:a.shiftKey};(0,s["default"])(f.element,b,f),l=(0,q["default"])(c)}function c(a){clearTimeout(u);var e=m["default"].MOUSE_UP;t&&(e=m["default"].MOUSE_CLICK);var f={page:o["default"].cornerstoneMath.point.pageToPoint(a),image:d.pageToPixel(g,a.pageX,a.pageY),client:{x:a.clientX,y:a.clientY}};f.canvas=d.pixelToCanvas(g,f.image);var j={page:o["default"].cornerstoneMath.point.subtract(f.page,l.page),image:o["default"].cornerstoneMath.point.subtract(f.image,l.image),client:o["default"].cornerstoneMath.point.subtract(f.client,l.client),canvas:o["default"].cornerstoneMath.point.subtract(f.canvas,l.canvas)},n={event:a,which:r,viewport:d.getViewport(g),image:h.image,element:g,startPoints:k,lastPoints:l,currentPoints:f,deltaPoints:j,type:e};(0,s["default"])(n.element,e,n),document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",c),g.addEventListener("mousemove",i),t=!0}var d=o["default"].cornerstone,g=a.currentTarget,h=d.getEnabledElement(g);if(h.image){u=setTimeout(f,v);var j=m["default"].MOUSE_DOWN;g.removeEventListener("mousemove",i);var k={page:o["default"].cornerstoneMath.point.pageToPoint(a),image:d.pageToPixel(g,a.pageX,a.pageY),client:{x:a.clientX,y:a.clientY}};k.canvas=d.pixelToCanvas(g,k.image);var l=(0,q["default"])(k),n={event:a,which:e(a),viewport:d.getViewport(g),image:h.image,element:g,startPoints:k,lastPoints:l,currentPoints:k,deltaPoints:{x:0,y:0},type:j},p=(0,s["default"])(n.element,j,n);p&&(n.type=m["default"].MOUSE_DOWN_ACTIVATE,(0,s["default"])(n.element,m["default"].MOUSE_DOWN_ACTIVATE,n));var r=e(a);document.addEventListener("mousemove",b),document.addEventListener("mouseup",c)}}function i(a){var b=o["default"].cornerstone,c=a.currentTarget,d=b.getEnabledElement(c);if(d.image){var e=m["default"].MOUSE_MOVE,f={page:o["default"].cornerstoneMath.point.pageToPoint(a),image:b.pageToPixel(c,a.pageX,a.pageY),client:{x:a.clientX,y:a.clientY}};f.canvas=b.pixelToCanvas(c,f.image);var g=(0,q["default"])(f),h={page:o["default"].cornerstoneMath.point.pageToPoint(a),image:b.pageToPixel(c,a.pageX,a.pageY),client:{x:a.clientX,y:a.clientY}};h.canvas=b.pixelToCanvas(c,h.image);var i={page:o["default"].cornerstoneMath.point.subtract(h.page,g.page),image:o["default"].cornerstoneMath.point.subtract(h.image,g.image),client:o["default"].cornerstoneMath.point.subtract(h.client,g.client),canvas:o["default"].cornerstoneMath.point.subtract(h.canvas,g.canvas)},j={viewport:b.getViewport(c),image:d.image,element:c,startPoints:f,lastPoints:g,currentPoints:h,deltaPoints:i,type:e};(0,s["default"])(c,e,j),g=(0,q["default"])(h)}}function j(a){a.removeEventListener("mousedown",h),a.removeEventListener("mousemove",i),a.removeEventListener("dblclick",g)}function k(a){j(a),a.addEventListener("mousedown",h),a.addEventListener("mousemove",i),a.addEventListener("dblclick",g)}Object.defineProperty(b,"__esModule",{value:!0});var l=c("./events.js"),m=d(l),n=c("./externalModules.js"),o=d(n),p=c("./util/copyPoints.js"),q=d(p),r=c("./util/triggerEvent.js"),s=d(r),t=!0,u=void 0,v=200,w={enable:k,disable:j};b["default"]=w},"./inputSources/mouseWheelInput.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=k["default"].cornerstone,c=a.currentTarget,d=b.getEnabledElement(c);if(d.image&&!("mousewheel"===a.type&&0===a.wheelDeltaY||"DOMMouseScroll"===a.type&&1===a.axis)){a.preventDefault();var e=void 0,f=void 0;void 0!==a.pageX&&void 0!==a.pageY?(e=a.pageX,f=a.pageY):(e=a.x,f=a.y);var g=b.pageToPixel(c,e,f);a=window.event&&window.event.wheelDelta?window.event:a;var h=void 0;h=a.wheelDelta?a.wheelDelta:a.deltaY?-a.deltaY:a.detail?-a.detail:a.wheelDelta;var j=h<0?-1:1,l={element:c,viewport:b.getViewport(c),image:d.image,direction:j,pageX:e,pageY:f,imageX:g.x,imageY:g.y};(0,m["default"])(c,i["default"].MOUSE_WHEEL,l)}}function f(a){g(a),n.forEach(function(b){a.addEventListener(b,e)})}function g(a){n.forEach(function(b){a.removeEventListener(b,e)})}Object.defineProperty(b,"__esModule",{value:!0});var h=c("./events.js"),i=d(h),j=c("./externalModules.js"),k=d(j),l=c("./util/triggerEvent.js"),m=d(l),n=["mousewheel","DOMMouseScroll"],o={enable:f,disable:g};b["default"]=o},"./inputSources/preventGhostClick.js":function(a,b,c){"use strict";function d(a,b){var c=Date.now();if(a!==k){if(c-l<=i)return b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation(),!1;k=a}l=c}function e(a,b,c){var d=c?m:n;b.forEach(function(b){a.addEventListener(b,d)})}function f(a,b,c){var d=c?m:n;b.forEach(function(b){a.removeEventListener(b,d)})}function g(a){f(a,o,j.mouse),f(a,p,j.touch)}function h(a){g(a),e(a,o,j.mouse),e(a,p,j.touch)}Object.defineProperty(b,"__esModule",{value:!0});var i=2e3,j={mouse:0,touch:1},k=void 0,l=void 0,m=d.bind(null,j.mouse),n=d.bind(null,j.touch),o=["mousedown","mouseup"],p=["touchstart","touchend"],q={enable:h,disable:g};b["default"]=q},"./inputSources/touchInput.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=k["default"].cornerstone,c=a.currentTarget||a.srcEvent.currentTarget,d=b.getEnabledElement(c);if(d.image){var e=void 0,f=void 0,g=void 0,h=void 0,j=void 0;switch(a.preventDefault(),(a.pointers&&a.pointers.length>1||a.touches&&a.touches.length>1)&&(D=!1,clearTimeout(y)),a.type){case"tap":D=!1,clearTimeout(y),t={page:k["default"].cornerstoneMath.point.pageToPoint(a.pointers[0]),image:b.pageToPixel(c,a.pointers[0].pageX,a.pointers[0].pageY),client:{x:a.pointers[0].clientX,y:a.pointers[0].clientY}},t.canvas=b.pixelToCanvas(c,t.image),e=i["default"].TAP,w={event:a,viewport:b.getViewport(c),image:d.image,element:c,currentPoints:t,type:e,isTouchEvent:!0},(0,q["default"])(c,e,w);break;case"doubletap":D=!1,clearTimeout(y),t={page:k["default"].cornerstoneMath.point.pageToPoint(a.pointers[0]),image:b.pageToPixel(c,a.pointers[0].pageX,a.pointers[0].pageY),client:{x:a.pointers[0].clientX,y:a.pointers[0].clientY}},t.canvas=b.pixelToCanvas(c,t.image),e=i["default"].DOUBLE_TAP,w={event:a,viewport:b.getViewport(c),image:d.image,element:c,currentPoints:t,type:e,isTouchEvent:!0},(0,q["default"])(c,e,w);break;case"pinchstart":D=!1,clearTimeout(y),A=1;break;case"pinchmove":if(D=!1,clearTimeout(y),C===!0){A=a.scale,C=!1;break}f=(a.scale-A)/A,s={page:a.center,image:b.pageToPixel(c,a.center.x,a.center.y)},s.canvas=b.pixelToCanvas(c,s.image),e=i["default"].TOUCH_PINCH,w={event:a,startPoints:s,viewport:b.getViewport(c),image:d.image,element:c,direction:a.scale<1?1:-1,scaleChange:f,type:e,isTouchEvent:!0},(0,q["default"])(c,e,w),A=a.scale;break;case"touchstart":A=1,clearTimeout(y),clearTimeout(x),x=setTimeout(function(){s={page:k["default"].cornerstoneMath.point.pageToPoint(a.touches[0]),image:b.pageToPixel(c,a.touches[0].pageX,a.touches[0].pageY),client:{x:a.touches[0].clientX,y:a.touches[0].clientY}},s.canvas=b.pixelToCanvas(c,s.image),e=i["default"].TOUCH_START,a.touches.length>1&&(e=i["default"].MULTI_TOUCH_START),w={event:a,viewport:b.getViewport(c),image:d.image,element:c,startPoints:s,currentPoints:s,type:e,isTouchEvent:!0};var f=(0,q["default"])(c,e,w);f===!0&&(e=i["default"].TOUCH_START_ACTIVE,a.touches.length>1&&(e=i["default"].MULTI_TOUCH_START_ACTIVE),w.type=e,(0,q["default"])(c,e,w)),u=(0,m["default"])(s)},50),D=!0,z=0,y=setTimeout(function(){D&&(t={page:k["default"].cornerstoneMath.point.pageToPoint(a.touches[0]),image:b.pageToPixel(c,a.touches[0].pageX,a.touches[0].pageY),client:{x:a.touches[0].clientX,y:a.touches[0].clientY}},t.canvas=b.pixelToCanvas(c,s.image),e=i["default"].TOUCH_PRESS,w={event:a,viewport:b.getViewport(c),image:d.image,element:c,currentPoints:t,type:e,isTouchEvent:!0},(0,q["default"])(c,e,w))},F);break;case"touchend":A=1,D=!1,clearTimeout(y),setTimeout(function(){s={page:k["default"].cornerstoneMath.point.pageToPoint(a.changedTouches[0]),image:b.pageToPixel(c,a.changedTouches[0].pageX,a.changedTouches[0].pageY),client:{x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY}},s.canvas=b.pixelToCanvas(c,s.image),e=i["default"].TOUCH_END,w={event:a,viewport:b.getViewport(c),image:d.image,element:c,startPoints:s,currentPoints:s,type:e,isTouchEvent:!0},(0,q["default"])(c,e,w)},50);break;case"panmove":g={x:a.deltaX-E.x,y:a.deltaY-E.y},E={x:a.deltaX,y:a.deltaY},t={page:{x:u.page.x+g.x,y:u.page.y+g.y},image:b.pageToPixel(c,u.page.x+g.x,u.page.y+g.y),client:{x:u.client.x+g.x,y:u.client.y+g.y}},t.canvas=b.pixelToCanvas(c,t.image),v={page:k["default"].cornerstoneMath.point.subtract(t.page,u.page),image:k["default"].cornerstoneMath.point.subtract(t.image,u.image),client:k["default"].cornerstoneMath.point.subtract(t.client,u.client),canvas:k["default"].cornerstoneMath.point.subtract(t.canvas,u.canvas)},z+=Math.sqrt(v.page.x*v.page.x+v.page.y*v.page.y),z>G&&(D=!1,clearTimeout(y)),e=i["default"].TOUCH_DRAG,a.pointers.length>1&&(e=i["default"].MULTI_TOUCH_DRAG),w={viewport:b.getViewport(c),image:d.image,element:c,startPoints:s,lastPoints:u,currentPoints:t,deltaPoints:v,numPointers:a.pointers.length,type:e,isTouchEvent:!0},(0,q["default"])(c,e,w),u=(0,m["default"])(t);break;case"panstart":E={x:a.deltaX,y:a.deltaY},t={page:k["default"].cornerstoneMath.point.pageToPoint(a.pointers[0]),image:b.pageToPixel(c,a.pointers[0].pageX,a.pointers[0].pageY),client:{x:a.pointers[0].clientX,y:a.pointers[0].clientY}},t.canvas=b.pixelToCanvas(c,t.image),u=(0,m["default"])(t);break;case"panend":if(D=!1,clearTimeout(y),!u)return!1;t={page:k["default"].cornerstoneMath.point.pageToPoint(a.pointers[0]),image:b.pageToPixel(c,a.pointers[0].pageX,a.pointers[0].pageY),client:{x:a.pointers[0].clientX,y:a.pointers[0].clientY}},t.canvas=b.pixelToCanvas(c,t.image),v={page:k["default"].cornerstoneMath.point.subtract(t.page,u.page),image:k["default"].cornerstoneMath.point.subtract(t.image,u.image),client:k["default"].cornerstoneMath.point.subtract(t.client,u.client),canvas:k["default"].cornerstoneMath.point.subtract(t.canvas,u.canvas)},e=i["default"].TOUCH_DRAG_END,w={event:a.srcEvent,viewport:b.getViewport(c),image:d.image,element:c,startPoints:s,lastPoints:u,currentPoints:t,deltaPoints:v,type:e,isTouchEvent:!0},(0,q["default"])(c,e,w),h=a.pointers.length-a.changedPointers.length,2===h&&(C=!0);break;case"rotatemove":
D=!1,clearTimeout(y),j=a.rotation-B,B=a.rotation,e=i["default"].TOUCH_ROTATE,w={event:a.srcEvent,viewport:b.getViewport(c),image:d.image,element:c,rotation:j,type:e},(0,q["default"])(c,e,w)}return!1}}function f(a){g(a);var b=k["default"].Hammer,c={inputClass:b.SUPPORT_POINTER_EVENTS?b.PointerEventInput:b.TouchInput},d=new b.Manager(a,c),f={pointers:0,direction:b.DIRECTION_ALL,threshold:0},h=new b.Pan(f),i=new b.Pinch({threshold:0}),j=new b.Rotate({threshold:0});i.recognizeWith(h),i.recognizeWith(j),j.recognizeWith(h);var l=new b.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});l.recognizeWith(h),d.add([l,h,j,i]),d.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",e),o["default"].enable(a);var m=["touchstart","touchend"];m.forEach(function(b){a.addEventListener(b,e)});var n=(0,r.getToolOptions)(H,a);n.hammer=d,(0,r.setToolOptions)(H,a,n)}function g(a){o["default"].disable(a);var b=["touchstart","touchend"];b.forEach(function(b){a.removeEventListener(b,e)});var c=(0,r.getToolOptions)(H,a),d=c.hammer;d&&d.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",e)}Object.defineProperty(b,"__esModule",{value:!0});var h=c("./events.js"),i=d(h),j=c("./externalModules.js"),k=d(j),l=c("./util/copyPoints.js"),m=d(l),n=c("./inputSources/preventGhostClick.js"),o=d(n),p=c("./util/triggerEvent.js"),q=d(p),r=c("./toolOptions.js"),s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0,A=1,B=0,C=!1,D=!1,E=void 0,F=700,G=5,H="touchInput",I={enable:f,disable:g};b["default"]=I},"./manipulators/anyHandlesOutsideImage.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=a.image,d={left:0,top:0,width:c.width,height:c.height},e=!1;return Object.keys(b).forEach(function(a){var c=b[a];c.allowedOutsideImage!==!0&&f["default"].cornerstoneMath.point.insideRect(c,d)===!1&&(e=!0)}),e};var e=c("./externalModules.js"),f=d(e)},"./manipulators/drawHandles.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=void 0;return b=a&&a.handleRadius?a.handleRadius:i}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,f){Object.keys(c).forEach(function(i){var j=c[i];if(j.drawnIndependently!==!0&&(!f||f.drawHandlesIfActive!==!0||j.active)){var k=e(f),l={color:d,lineWidth:j.active?g["default"].getActiveWidth():g["default"].getToolWidth(),fillStyle:f&&f.fill};(0,h.drawCircle)(a,b.element,j,k,l)}})};var f=c("./stateManagement/toolStyle.js"),g=d(f),h=c("./util/drawing.js"),i=handleRadiusComm},"./manipulators/getHandleNearImagePoint.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d){var e=void 0;if(b)return Object.keys(b).forEach(function(g){var i=b[g];if(i.hasOwnProperty("pointNearHandle")){if(i.pointNearHandle(a,i,c))return void(e=i)}else if(i.hasBoundingBox===!0){if((0,h["default"])(i,c))return void(e=i)}else{var j=f["default"].cornerstone.pixelToCanvas(a,i),k=f["default"].cornerstoneMath.point.distance(j,c);if(k<=d)return void(e=i)}}),e};var e=c("./externalModules.js"),f=d(e),g=c("./util/pointInsideBoundingBox.js"),h=d(g)},"./manipulators/handleActivator.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=void 0;return Object.keys(a).forEach(function(c){var d=a[c];if(d.active===!0)return void(b=d)}),b}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d){d||(d=6);var f=e(b),h=(0,g["default"])(a,b,c,d);return f!==h&&(void 0!==h&&(h.active=!0),void 0!==f&&(f.active=!1),!0)};var f=c("./manipulators/getHandleNearImagePoint.js"),g=d(f)},"./manipulators/moveAllHandles.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e,g){function i(a){var c=a.detail;b.active=!0,Object.keys(b.handles).forEach(function(a){var d=b.handles[a];d.movesIndependently!==!0&&(d.x+=c.deltaPoints.image.x,d.y+=c.deltaPoints.image.y,e.preventHandleOutsideImage&&(0,n.clipToBox)(d,c.image))}),o.updateImage(q);var g=f["default"].MEASUREMENT_MODIFIED,h={toolType:d,element:q,measurementData:b};(0,m["default"])(q,g,h),a.preventDefault(),a.stopPropagation()}function l(a){var c=a.detail;b.invalidated=!0,q.removeEventListener(f["default"].MOUSE_DRAG,i),q.removeEventListener(f["default"].MOUSE_UP,l),q.removeEventListener(f["default"].MOUSE_CLICK,l),e.deleteIfHandleOutsideImage===!0&&(0,j["default"])(c,b.handles)&&(0,k.removeToolState)(q,d,b),o.updateImage(q),"function"==typeof g&&g()}var o=h["default"].cornerstone,p=a.detail,q=p.element;return q.addEventListener(f["default"].MOUSE_DRAG,i),q.addEventListener(f["default"].MOUSE_UP,l),q.addEventListener(f["default"].MOUSE_CLICK,l),!0};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./manipulators/anyHandlesOutsideImage.js"),j=d(i),k=c("./stateManagement/toolState.js"),l=c("./util/triggerEvent.js"),m=d(l),n=c("./util/clip.js")},"./manipulators/moveHandle.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e,g){function i(a){var e=a.detail;d.hasMoved===!1&&(d.hasMoved=!0),d.active=!0,d.x=e.currentPoints.image.x+o.x,d.y=e.currentPoints.image.y+o.y,g&&(0,k.clipToBox)(d,e.image),m.updateImage(n);var h=f["default"].MEASUREMENT_MODIFIED,i={toolType:b,element:n,measurementData:c};(0,j["default"])(n,h,i)}function l(){d.active=!1,n.removeEventListener(f["default"].MOUSE_DRAG,i),n.removeEventListener(f["default"].MOUSE_UP,l),n.removeEventListener(f["default"].MOUSE_CLICK,l),m.updateImage(n),"function"==typeof e&&e()}var m=h["default"].cornerstone,n=a.element,o={x:d.x-a.currentPoints.image.x,y:d.y-a.currentPoints.image.y};n.addEventListener(f["default"].MOUSE_DRAG,i),n.addEventListener(f["default"].MOUSE_UP,l),n.addEventListener(f["default"].MOUSE_CLICK,l)};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./util/triggerEvent.js"),j=d(i),k=c("./util/clip.js")},"./manipulators/moveNewHandle.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e,g){function i(a){var e=a.detail;d.active=!0,d.x=e.currentPoints.image.x,d.y=e.currentPoints.image.y,g&&(0,k.clipToBox)(d,e.image),p.updateImage(q);var h=f["default"].MEASUREMENT_MODIFIED,i={toolType:b,element:q,measurementData:c};(0,j["default"])(q,h,i)}function l(a){q.removeEventListener(f["default"].MOUSE_MOVE,l),q.removeEventListener(f["default"].MOUSE_DRAG,l),q.addEventListener(f["default"].MOUSE_MOVE,i),q.addEventListener(f["default"].MOUSE_DRAG,i),q.addEventListener(f["default"].MOUSE_CLICK,o),a.type===f["default"].MOUSE_DRAG&&q.addEventListener(f["default"].MOUSE_UP,o)}function m(a){var b=a.detail;b.measurementData===c&&o()}function n(a){var c=a.detail;c.toolType===b&&(q.removeEventListener(f["default"].MOUSE_MOVE,i),q.removeEventListener(f["default"].MOUSE_DRAG,i),q.removeEventListener(f["default"].MOUSE_CLICK,o),q.removeEventListener(f["default"].MOUSE_UP,o),q.removeEventListener(f["default"].MEASUREMENT_REMOVED,m),q.removeEventListener(f["default"].TOOL_DEACTIVATED,n),d.active=!1,p.updateImage(q))}function o(){q.removeEventListener(f["default"].MOUSE_MOVE,i),q.removeEventListener(f["default"].MOUSE_DRAG,i),q.removeEventListener(f["default"].MOUSE_CLICK,o),q.removeEventListener(f["default"].MOUSE_UP,o),q.removeEventListener(f["default"].MEASUREMENT_REMOVED,m),q.removeEventListener(f["default"].TOOL_DEACTIVATED,n),d.active=!1,p.updateImage(q),"function"==typeof e&&e()}var p=h["default"].cornerstone,q=a.element;q.addEventListener(f["default"].MOUSE_DRAG,l),q.addEventListener(f["default"].MOUSE_MOVE,l),q.addEventListener(f["default"].MEASUREMENT_REMOVED,m),q.addEventListener(f["default"].TOOL_DEACTIVATED,n)};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./util/triggerEvent.js"),j=d(i),k=c("./util/clip.js")},"./manipulators/moveNewHandleTouch.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e,g){function i(a){var e=a.detail;d.x=e.currentPoints.image.x+r.x,d.y=e.currentPoints.image.y+r.y,g&&(0,k.clipToBox)(d,e.image),o.updateImage(p);var h=f["default"].MEASUREMENT_MODIFIED,i={toolType:b,element:p,measurementData:c};(0,j["default"])(p,h,i)}function l(a){var b=a.detail;return p.removeEventListener(f["default"].TOUCH_DRAG,i),p.removeEventListener(f["default"].TOUCH_PINCH,l),p.removeEventListener(f["default"].TOUCH_END,l),p.removeEventListener(f["default"].TAP,l),p.removeEventListener(f["default"].TOUCH_START,m),p.removeEventListener(f["default"].TOOL_DEACTIVATED,n),a.type===f["default"].TOUCH_PINCH||a.type===f["default"].TOUCH_PRESS?(d.active=!1,o.updateImage(p),void e()):(d.active=!1,c.active=!1,d.x=b.currentPoints.image.x+r.x,d.y=b.currentPoints.image.y+r.y,g&&(0,k.clipToBox)(d,b.image),o.updateImage(p),void("function"==typeof e&&e()))}function m(a){return a.stopImmediatePropagation(),!1}function n(){p.removeEventListener(f["default"].TOUCH_DRAG,i),p.removeEventListener(f["default"].TOUCH_PINCH,l),p.removeEventListener(f["default"].TOUCH_END,l),p.removeEventListener(f["default"].TAP,l),p.removeEventListener(f["default"].TOUCH_START,m),p.removeEventListener(f["default"].TOOL_DEACTIVATED,n),d.active=!1,c.active=!1,d.x=a.currentPoints.image.x+r.x,d.y=a.currentPoints.image.y+r.y,g&&(0,k.clipToBox)(d,a.image),o.updateImage(p)}var o=h["default"].cornerstone,p=a.element,q=o.pageToPixel(p,a.currentPoints.page.x,a.currentPoints.page.y+50),r={x:d.x-q.x,y:d.y-q.y};d.active=!0,c.active=!0,p.addEventListener(f["default"].TOUCH_DRAG,i),p.addEventListener(f["default"].TOUCH_PINCH,l),p.addEventListener(f["default"].TOUCH_END,l),p.addEventListener(f["default"].TAP,l),p.addEventListener(f["default"].TOUCH_START,m),p.addEventListener(f["default"].TOOL_DEACTIVATED,n)};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./util/triggerEvent.js"),j=d(i),k=c("./util/clip.js")},"./manipulators/touchMoveAllHandles.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e,g){function i(a){var c=a.detail;b.active=!0,Object.keys(b.handles).forEach(function(a){var d=b.handles[a];d.movesIndependently!==!0&&(d.x+=c.deltaPoints.image.x,d.y+=c.deltaPoints.image.y)}),p.updateImage(o);var e=f["default"].MEASUREMENT_MODIFIED,g={toolType:d,element:o,measurementData:b};(0,m["default"])(o,e,g),a.preventDefault(),a.stopPropagation()}function l(a){var c=a.detail;b.active=!1,b.invalidated=!1,o.removeEventListener(f["default"].TOUCH_DRAG,i),o.removeEventListener(f["default"].TOUCH_PINCH,l),o.removeEventListener(f["default"].TOUCH_PRESS,l),o.removeEventListener(f["default"].TOUCH_END,l),o.removeEventListener(f["default"].TOUCH_DRAG_END,l),o.removeEventListener(f["default"].TAP,l);var h=(0,j["default"])(c,b.handles);e===!0&&h===!0&&(0,k.removeToolState)(o,d,b),p.updateImage(o),"function"==typeof g&&g(a)}var n=a.detail,o=n.element,p=h["default"].cornerstone;return o.addEventListener(f["default"].TOUCH_DRAG,i),o.addEventListener(f["default"].TOUCH_PINCH,l),o.addEventListener(f["default"].TOUCH_PRESS,l),o.addEventListener(f["default"].TOUCH_END,l),o.addEventListener(f["default"].TOUCH_DRAG_END,l),o.addEventListener(f["default"].TAP,l),!0};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./manipulators/anyHandlesOutsideImage.js"),j=d(i),k=c("./stateManagement/toolState.js"),l=c("./util/triggerEvent.js"),m=d(l)},"./manipulators/touchMoveHandle.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d,f){if(c.value){var g=i["default"].cornerstone,h=(new Date).getTime(),j=Math.abs(b.y-f.y),k=j/10;if(j<1)return b.y=f.y,void(c.value=!1);b.y>f.y?b.y-=k:b.y<f.y&&(b.y+=k),g.updateImage(d.element),g.requestAnimationFrame(function(){e(h,b,c,d,f)})}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,f){function h(a){var e=a.detail;l.value=!1,d.hasMoved===!1&&(d.hasMoved=!0),d.active=!0;var f=e.currentPoints,h={x:f.page.x,y:f.page.y+s};u=o.pageToPixel(p,h.x,h.y),d.x=u.x,d.y=u.y,o.updateImage(p);var i=g["default"].MEASUREMENT_MODIFIED,j={toolType:b,element:p,measurementData:c};(0,k["default"])(p,i,j)}function j(a){var b=a.detail;l.value=!1,d.active=!1,p.removeEventListener(g["default"].TOUCH_DRAG,h),m.forEach(function(a){p.removeEventListener(a,j)}),o.updateImage(p),a.type===g["default"].TOUCH_PRESS&&(b.handlePressed=c,d.x=n.currentPoints.image.x,d.y=n.currentPoints.image.y),"function"==typeof f&&f(a)}l.value=!0;var n=a.detail,o=i["default"].cornerstone,p=n.element,q=o.getEnabledElement(p),r=(new Date).getTime(),s=-57,t={x:n.currentPoints.page.x,y:n.currentPoints.page.y+s},u=o.pageToPixel(p,t.x,t.y);p.addEventListener(g["default"].TOUCH_DRAG,h),m.forEach(function(a){p.addEventListener(a,j)}),e(r,d,l,q,u)};var f=c("./events.js"),g=d(f),h=c("./externalModules.js"),i=d(h),j=c("./util/triggerEvent.js"),k=d(j),l={value:!1},m=[g["default"].TOUCH_END,g["default"].TOUCH_DRAG_END,g["default"].TOUCH_PINCH,g["default"].TOUCH_PRESS,g["default"].TAP]},"./measurementManager/lineSampleMeasurement.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(){var a=h["default"].cornerstone,b=this;b.samples=[],this.set=function(c){b.samples=c,(0,j["default"])(a.events,f["default"].LINE_SAMPLE_UPDATED)}};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./util/triggerEvent.js"),j=d(i)},"./measurementManager/measurementManager.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){var a=i["default"].cornerstone,b=this;b.measurements=[],this.add=function(c){var d=b.measurements.push(c),e={index:d,measurement:c};(0,k["default"])(a.events,g["default"].MEASUREMENT_ADDED,e)},this.remove=function(c){var d=b.measurements[c];b.measurements.splice(c,1);var e={index:c,measurement:d};(0,k["default"])(a.events,g["default"].MEASUREMENT_REMOVED,e)}}Object.defineProperty(b,"__esModule",{value:!0});var f=c("./events.js"),g=d(f),h=c("./externalModules.js"),i=d(h),j=c("./util/triggerEvent.js"),k=d(j),l=new e;b["default"]=l},"./orientation/getOrientationString.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){for(var b=(0,h["default"])(a),c="",d=b.x<0?"R":"L",e=b.y<0?"A":"P",g=b.z<0?"F":"H",i=new f["default"].cornerstoneMath.Vector3(Math.abs(b.x),Math.abs(b.y),Math.abs(b.z)),j=0;j<3;j++)if(i.x>1e-4&&i.x>i.y&&i.x>i.z)c+=d,i.x=0;else if(i.y>1e-4&&i.y>i.x&&i.y>i.z)c+=e,i.y=0;else{if(!(i.z>1e-4&&i.z>i.x&&i.z>i.y))break;c+=g,i.z=0}return c};var e=c("./externalModules.js"),f=d(e),g=c("./util/convertToVector3.js"),h=d(g)},"./orientation/index.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c("./orientation/getOrientationString.js"),f=d(e),g=c("./orientation/invertOrientationString.js"),h=d(g),i={getOrientationString:f["default"],invertOrientationString:h["default"]};b["default"]=i},"./orientation/invertOrientationString.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){var b=a.replace("H","f");return b=b.replace("F","h"),b=b.replace("R","l"),b=b.replace("L","r"),b=b.replace("A","p"),b=b.replace("P","a"),b=b.toUpperCase()}},"./paintingTools/adaptiveBrush.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=D.getConfiguration(),e=d.tolerance,f=Number.MAX_VALUE,g=-Number.MAX_VALUE;a.forEach(function(a){var d=a[1]*c+a[0],e=b[d];f=Math.min(e,f),g=Math.max(e,g)}),A=f-e,z=g+e}function f(a,b,c,d){for(var e=D.getConfiguration(),f=e.draw,g=Math.round(y.x),h=Math.round(y.y),i=null,j=[],k=e.radius;0!==i&&k>e.minRadius;){i=0,j=(0,t["default"])(k,c,d,g,h);for(var l=0;l<j.length;l++){var m=j[l][0],n=j[l][1],o=n*d+m,p=a[o];if(p>z||p<A){i++;break}}k--}return 0===i&&(0,u.drawBrushPixels)(j,b,f,d),k}function g(a){var b=D.getConfiguration(),c=a.element,d=o["default"].cornerstone.getLayer(c,b.brushLayerId),e=o["default"].cornerstone.getLayers(c)[0],g=d.image,h=g.rows,i=g.columns,j=(0,p.getToolState)(c,v),k=j.data[0];B=f(e.image.getPixelData(),k.pixelData,h,i),d.invalid=!0,o["default"].cornerstone.updateImage(c)}function h(a){var b=D.getConfiguration(),c=a.element,d=o["default"].cornerstone.getLayer(c,b.brushLayerId),e=d.image,f=e.rows,g=e.columns,h=a.currentPoints.image,i=h.x,j=h.y,k=(0,p.getToolState)(c,v),l=k.data[0].pixelData,m=b.draw,n=b.radius;if(!(i<0||i>g||j<0||j>f)){var q=(0,t["default"])(n,f,g,i,j);(0,u.drawBrushPixels)(q,l,m,g),d.invalid=!0,o["default"].cornerstone.updateImage(c)}}function i(a){var b=a.detail;y=b.currentPoints.image;var c=D.getConfiguration();C=!1,B=c.radius,o["default"].cornerstone.updateImage(b.element)}function j(a){var b=a.detail,c=b.element,d=D.getConfiguration(),f=o["default"].cornerstone.getLayer(c,d.brushLayerId),i=o["default"].cornerstone.getLayers(c)[0],j=b.currentPoints.image,k=j.x,l=j.y,m=f.image,n=m.rows,p=m.columns,q=(0,t["default"])(d.radius,n,p,k,l);0===d.draw?h(b):(e(q,i.image.getPixelData(),p),g(b)),C=!0,y=b.currentPoints.image}function k(a){var b=a.detail;y=b.currentPoints.image,o["default"].cornerstone.updateImage(b.element)}function l(a){var b=a.detail;0===x.draw?h(b):g(b),C=!0,y=b.currentPoints.image}function m(a){var b=a.detail;if(y){var c=b.image,d=c.rows,e=c.columns,f=y,g=f.x,h=f.y;if(!(g<0||g>e||h<0||h>d)){var i=D.getConfiguration(),j=b.canvasContext,k=C?i.dragColor:i.hoverColor,l=b.element;if(B=C?B||i.radius:i.radius,j.setTransform(1,0,0,1,0,0),i.active){var m=(0,t["default"])(B,d,e,g,h);(0,u.drawBrushOnCanvas)(m,j,k,l)}}}}Object.defineProperty(b,"__esModule",{value:!0}),b.adaptiveBrush=void 0;var n=c("./externalModules.js"),o=d(n),p=c("./stateManagement/toolState.js"),q=c("./paintingTools/brushTool.js"),r=d(q),s=c("./paintingTools/getCircle.js"),t=d(s),u=c("./paintingTools/drawBrush.js"),v="brush",w="adaptiveBrush",x={draw:1,radius:5,tolerance:5,minRadius:1,maxRadius:20,hoverColor:"rgba(230, 25, 75, 1.0)",dragColor:"rgba(230, 25, 75, 0.8)",active:!1},y=void 0,z=void 0,A=void 0,B=void 0,C=void 0,D=(0,r["default"])({onMouseMove:k,onMouseDown:j,onMouseUp:i,onDrag:l,toolType:w,onImageRendered:m});D.setConfiguration(x),b.adaptiveBrush=D},"./paintingTools/brush.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=A.getConfiguration(),c=a.element,d=n["default"].cornerstone.getLayer(c,b.brushLayerId),e=d.image,f=e.rows,g=e.columns,h=a.currentPoints.image,i=h.x,j=h.y,k=(0,o.getToolState)(c,v),l=k.data[0].pixelData,m=b.draw,p=b.radius;if(!(i<0||i>g||j<0||j>f)){var q=(0,s["default"])(p,f,g,i,j);(0,t.drawBrushPixels)(q,l,m,g),d.invalid=!0,n["default"].cornerstone.updateImage(c)}}function f(a){var b=a.detail;y=b.currentPoints.image,z=!1}function g(a){var b=a.detail;e(b),z=!0,y=b.currentPoints.image}function h(a){var b=a.detail;y=b.currentPoints.image,n["default"].cornerstone.updateImage(b.element)}function i(a){var b=a.detail;e(b),z=!0,y=b.currentPoints.image}function j(a){var b=a.detail;if(y){var c=b.image,d=c.rows,e=c.columns,f=y,g=f.x,h=f.y;if(!(g<0||g>e||h<0||h>d)){var i=A.getConfiguration(),j=i.radius,k=b.canvasContext,l=z?i.dragColor:i.hoverColor,m=b.element;if(k.setTransform(1,0,0,1,0,0),i.active){var n=(0,s["default"])(j,d,e,g,h);(0,t.drawBrushOnCanvas)(n,k,l,m)}}}}function k(a){var b=A.getConfiguration(),c=b.radius,d=a.element,e=n["default"].cornerstone.getLayer(d,b.brushLayerId),f=e.image,g=f.rows,h=f.columns,i=a.currentPoints.image,j=i.x,k=i.y,l=(0,o.getToolState)(d,v),m=l.data[0].pixelData,p=b.draw;if(!(j<0||j>h||k<0||k>g)){j=Math.round(j),k=Math.round(k);var q=(0,u.getEndOfCircle)(j,k,h,g,m,p);Math.abs(q[0]-q[2])>2*c&&Math.abs(q[1]-q[3])>2*c||((0,u.connectEndsOfBrush)(j,k,h,g,q,m,p)&&(0,u.isCircleInPolygon)(j,k,h,g,q,m,p)&&(0,u.fillColor)(j,q[0]-1,h,g,m,p),e.invalid=!0,n["default"].cornerstone.updateImage(d))}}function l(a){var b=a.detail;k(b)}Object.defineProperty(b,"__esModule",{value:!0}),b.brush=void 0;var m=c("./externalModules.js"),n=d(m),o=c("./stateManagement/toolState.js"),p=c("./paintingTools/brushTool.js"),q=d(p),r=c("./paintingTools/getCircle.js"),s=d(r),t=c("./paintingTools/drawBrush.js"),u=c("./paintingTools/fill.js"),v="brush",w="brush",x={draw:1,radius:5,minRadius:1,maxRadius:20,hoverColor:"rgba(230, 25, 75, 1.0)",dragColor:"rgba(230, 25, 75, 0.8)",active:!1},y=void 0,z=!1,A=(0,q["default"])({onMouseMove:h,onMouseDown:g,onMouseUp:f,onDrag:i,toolType:w,onImageRendered:j,onMouseDoubleClick:l});A.setConfiguration(x),b.brush=A},"./paintingTools/brushTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){function b(a){var b=a.detail,e=!1;e=c(b)||e,e=d(b)||e,e&&i["default"].cornerstone.updateImage(b.element)}function c(a){var b=a.keyCode,c=!1;return 109===b||173===b?(h(),c=!0):61!==b&&107!==b||(f(),c=!0),c}function d(a){var b=a.keyCode,c=!1;return 219===b?(m(),c=!0):221===b&&(k(),c=!0),c}function e(a){var b=E.getConfiguration(),c=i["default"].cornerstone.colors.getColormap(b.colormapId);b.draw=a;var d=c.getColor(b.draw);b.hoverColor="rgba("+d[[0]]+", "+d[[1]]+", "+d[[2]]+", 1.0 )",b.dragColor="rgba("+d[[0]]+", "+d[[1]]+", "+d[[2]]+", 0.8 )"}function f(){var a=E.getConfiguration();a.radius=(0,q["default"])(a.radius+1,a.minRadius,a.maxRadius)}function h(){var a=E.getConfiguration();a.radius=(0,q["default"])(a.radius-1,a.minRadius,a.maxRadius)}function k(){var a=E.getConfiguration(),b=p(),c=a.draw+1;c===b&&(c=0),e(c)}function m(){var a=E.getConfiguration(),b=p(),c=a.draw-1;c<0&&(c=b-1),e(c)}function p(){var a=E.getConfiguration(),b=i["default"].cornerstone.colors.getColormap(a.colormapId);return b.getNumberOfColors()}function u(b){a.onMouseMove(b)}function v(b){var c=b.detail,d=c.element;a.onMouseUp(b),d.removeEventListener(g["default"].MOUSE_DRAG,u),d.removeEventListener(g["default"].MOUSE_DRAG,w),d.removeEventListener(g["default"].MOUSE_UP,v),d.removeEventListener(g["default"].MOUSE_CLICK,v)}function w(b){return a.onDrag(b),!1}function x(b){a.onMouseDoubleClick(b)}function y(b){var c=b.detail,d=c.element,e=(0,o.getToolOptions)(D,d);return(0,n["default"])(c.which,e.mouseButtonMask)?(d.addEventListener(g["default"].MOUSE_DRAG,w),d.addEventListener(g["default"].MOUSE_UP,v),d.addEventListener(g["default"].MOUSE_CLICK,v),d.addEventListener(g["default"].MOUSE_DOUBLE_CLICK,x),a.onMouseDown(b),!1):(d.addEventListener(g["default"].MOUSE_DRAG,u),void d.addEventListener(g["default"].MOUSE_UP,v))}function z(b){var c=b.detail,d=c.element,e=(0,j.getToolState)(d,r),f=void 0;e?f=e.data[0].pixelData:(f=new Uint8ClampedArray(c.image.width*c.image.height),(0,j.addToolState)(d,r,{pixelData:f}));var g=i["default"].cornerstone.getLayer(c.element,s);g.image.setPixelData(f),g.invalid=!0,i["default"].cornerstone.updateImage(d),a.onImageRendered(b)}function A(a){var b=i["default"].cornerstone.colors.getColormap(a);b.setNumberOfColors(20),b.setColor(0,[255,255,255,0]),b.setColor(1,[230,25,75,102]),b.setColor(2,[60,180,175,102]),b.setColor(3,[255,225,25,102]),b.setColor(4,[0,130,200,102]),b.setColor(5,[245,130,48,102]),b.setColor(6,[145,30,180,102]),b.setColor(7,[70,240,240,102]),b.setColor(8,[240,50,230,102]),b.setColor(9,[210,245,60,102]),b.setColor(10,[250,190,190,102]),b.setColor(11,[0,128,128,102]),b.setColor(12,[230,190,255,102]),b.setColor(13,[170,110,40,102]),b.setColor(14,[255,250,200,102]),b.setColor(15,[128,0,0,102]),b.setColor(16,[170,255,195,102]),b.setColor(17,[128,128,0,102]),b.setColor(18,[255,215,180,102]),b.setColor(19,[0,0,128,102])}function B(a,c){(0,o.setToolOptions)(D,a,{mouseButtonMask:c}),a.removeEventListener(i["default"].cornerstone.EVENTS.IMAGE_RENDERED,z),a.addEventListener(i["default"].cornerstone.EVENTS.IMAGE_RENDERED,z),a.removeEventListener(g["default"].MOUSE_DOWN_ACTIVATE,y),a.addEventListener(g["default"].MOUSE_DOWN_ACTIVATE,y),a.removeEventListener(g["default"].MOUSE_MOVE,u),a.addEventListener(g["default"].MOUSE_MOVE,u),a.removeEventListener(g["default"].KEY_DOWN,b),a.addEventListener(g["default"].KEY_DOWN,b);var d=i["default"].cornerstone.getEnabledElement(a),e=d.image,f=e.width,h=e.height,k=new Uint8ClampedArray(f*h),l=E.getConfiguration();l.active=!0;var m=l.colormapId;if(!m){var n=E.getConfiguration();m="BrushColorMap",A(m),n.colormapId=m}var p={minPixelValue:0,maxPixelValue:1,slope:1,intercept:0,getPixelData:function(){return k},rows:d.image.height,columns:d.image.width,height:h,width:f,pixelData:k,setPixelData:function(a){k=a},colormap:m,color:!1,rgba:!1,labelmap:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:d.image.width*d.image.height},q=void 0,v={viewport:{pixelReplication:!0}};t||(t=i["default"].cornerstone.addLayer(a,i["default"].cornerstone.getEnabledElement(a).image)),s&&(q=i["default"].cornerstone.getLayer(a,s)),q||(s=i["default"].cornerstone.addLayer(a,p,v)),(0,j.addToolState)(a,r,{pixelData:k}),l.brushLayerId=s,E.setConfiguration(l),i["default"].cornerstone.updateImage(a)}function C(a){a.removeEventListener(i["default"].cornerstone.EVENTS.IMAGE_RENDERED,z),a.removeEventListener(g["default"].MOUSE_DOWN_ACTIVATE,y),a.removeEventListener(g["default"].MOUSE_MOVE,u),a.removeEventListener(g["default"].MOUSE_DOUBLE_CLICK,x),a.removeEventListener(g["default"].KEY_DOWN,b),a.addEventListener(i["default"].cornerstone.EVENTS.IMAGE_RENDERED,z);var c=E.getConfiguration();c.active=!1}var D=a.toolType,E=(0,l["default"])({mouseMoveCallback:u,mouseDownActivateCallback:y,onImageRendered:z,deactivate:C});return E.keyDownCallback=b,E.activate=B,E.changeDrawColor=e,E.increaseRadius=f,E.decreaseRadius=h,E.nextSegmentation=k,E.previousSegmentation=m,E}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./events.js"),g=d(f),h=c("./externalModules.js"),i=d(h),j=c("./stateManagement/toolState.js"),k=c("./imageTools/mouseButtonTool.js"),l=d(k),m=c("./util/isMouseButtonEnabled.js"),n=d(m),o=c("./toolOptions.js"),p=c("./util/clip.js"),q=d(p),r="brush",s=void 0,t=void 0},"./paintingTools/drawBrush.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d){var e=function(a,b){return b*d+a};a.forEach(function(a){var d=e(a[0],a[1]);b[d]=c})}function f(a,b,c,d){var e=h["default"].cornerstone.pixelToCanvas(d,{x:0,y:0}),f=h["default"].cornerstone.pixelToCanvas(d,{x:1,y:1}),g=f.x-e.x,j=f.y-e.y;(0,i.draw)(b,function(b){a.forEach(function(a){var e=h["default"].cornerstone.pixelToCanvas(d,{x:a[0],y:a[1]}),f={left:e.x,top:e.y,width:g,height:j};(0,i.fillBox)(b,f,c)})})}Object.defineProperty(b,"__esModule",{value:!0}),b.drawBrushOnCanvas=b.drawBrushPixels=void 0;var g=c("./externalModules.js"),h=d(g),i=c("./util/drawing.js");b.drawBrushPixels=e,b.drawBrushOnCanvas=f},"./paintingTools/fill.js":function(a,b,c){"use strict";function d(a,b,c,d){for(var e=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=a;a<b?f<=b:f>=b;f+=a<b?1:-1){if(e&&c(d,f))return f;if(!e&&c(f,d))return f}return null}function e(a,b,c){return b[a]===c}function f(a,b,c,f,g,h){var i=function(a,b){return b*c+a};return[d(b,0,function(a,b){return!e(i(a,b-1),g,h)},a,!0),d(a,c,function(a,b){return!e(i(a+1,b),g,h)},b,!1),d(b,f,function(a,b){return!e(i(a,b+1),g,h)},a,!0),d(a,0,function(a,b){return!e(i(a-1,b),g,h)},b,!1)]}function g(a,b,c,f,g,h,i){for(var j=[0,1,0,-1],k=[-1,0,1,0],l=Number.MAX_SAFE_INTEGER,m=-1,n=void 0,o=void 0,p=void 0,q=function(a,b){return b*c+a},r=function(r){var s=void 0,t=void 0,u=void 0;if(r%2){if(s=b,t=d(g[r]+j[r],1===r?c:0,function(a,b){return e(q(a,b),h,i)},s,!1),null===t)return"continue";u=d(t+j[r],1===r?c:0,function(a,b){return!e(q(a+j[r],b+k[r]),h,i)},s,!1)}else{if(s=a,t=d(g[r]+k[r],0===r?0:f,function(a,b){return e(q(a,b),h,i)},s,!0),null===t)return"continue";u=d(t+k[r],0===r?0:f,function(a,b){return!e(q(a+j[r],b+k[r]),h,i)},s,!0)}var v=Math.abs(t-(r%2?a:b));l>v&&(l=v,m=r,n=s,o=t,p=u)},s=0;s<g.length;s++){r(s)}return l===Number.MAX_SAFE_INTEGER?[null,null,null,null]:[m,n,o,p]}function h(a,b,c,d,f,g){var h=a,i=b,j=0,k=new o.Queue,l=[],m=[0,1,0,-1],n=[-1,0,1,0],p=0,q=function(a,b){return b*c+a};k.enqueue({x:a,y:b});for(var r=0;r<d*c;r+=1)l.push(0);for(l[q(a,b)]=1;0!==k.size()&&p<=d*c;){p+=1;var s=k.dequeue(),t=q(s.x,s.y);if(j<l[t]){var u=[s.x,s.y,l[t]];h=u[0],i=u[1],j=u[2]}for(var v=0;v<4;v+=1){var w=s.y+n[v],x=s.x+m[v],y=q(x,w);w<0||w>=d||x<0||x>=c||e(y,f,g)&&0===l[y]&&(l[y]=l[t]+1,k.enqueue({x:x,y:w}))}}return{x:h,y:i}}function i(a,b,c){for(var d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],e=[],f=a;a<b?f<=b:f>=b;f+=a<b?1:-1)e.push(d?[c,f]:[f,c]);return e}function j(a,b,c,d,e,f,j){var k=function(a,b,d){return(0,n.drawBrushPixels)([[a,b]],f,d,c)},l=function(a,b){return(0,n.drawBrushPixels)(a,f,b,c)},o=g(a,b,c,d,e,f,j),p=m(o,4),q=p[0],r=p[1],s=p[2],t=p[3],u=[];if(null===q)return!1;if(l(i(s,t,r,!(q%2)),0),q%2){var v=h(s,r-1,c,d,f,j),w=h(s,r+1,c,d,f,j);u.push(v),u.push(w)}else{var x=h(r-1,s,c,d,f,j),y=h(r+1,s,c,d,f,j);u.push(x),u.push(y)}if(l(i(s,t,r,!(q%2)),j),u.sort(function(a,b){return a.x-b.x}),u[0].x===u[1].x)l(i(u[0].y,u[1].y,u[0].x,!0),j);else{var z=(u[1].y-u[0].y)/(u[1].x-u[0].x),A=u[0].y-z*u[0].x,B=1;if(Math.abs(z)>=1){u.sort(function(a,b){return a.y-b.y});for(var C=u[0].y;C<=u[1].y;C+=1)for(var D=-(B-1);D<=B+1;D+=1)k(Math.round((C-A)/z)+D,C,j)}else for(var E=u[0].x;E<=u[1].x;E+=1)for(var F=-(B-1);F<=B+1;F+=1)k(E,Math.round(z*E+A)+F,j)}return!0}function k(a,b,c,f,g,h,i){var j=function(a,b){return b*c+a},k=d(g[3]-1,0,function(a,b){return e(j(a,b),h,i)},b,!1),l=d(g[1]+1,c,function(a,b){return e(j(a,b),h,i)},b,!1);return k&&l}function l(a,b,c,d,f,g){var h=new o.Queue,i=[0,1,0,-1],j=[-1,0,1,0],k=0,l=function(a,b){return b*c+a},m=function(a,b,d){return(0,n.drawBrushPixels)([[a,b]],f,d,c)};for(h.enqueue({x:a,y:b}),m(a,b,g);0!==h.size()&&k<=d*c;){k+=1;for(var p=h.dequeue(),q=0;q<4;q+=1){var r=p.y+j[q],s=p.x+i[q];r<0||r>=d||s<0||s>=c||e(l(s,r),f,g)||(h.enqueue({x:s,y:r}),m(s,r,g))}}}Object.defineProperty(b,"__esModule",{value:!0}),b.fillColor=b.isCircleInPolygon=b.connectEndsOfBrush=b.getEndOfCircle=void 0;var m=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=c("./paintingTools/drawBrush.js"),o=c("./paintingTools/queue.js");b.getEndOfCircle=f,b.connectEndsOfBrush=j,b.isCircleInPolygon=k,b.fillColor=l},"./paintingTools/getCircle.js":function(a,b,c){"use strict";function d(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=Math.round(d),g=Math.round(e);if(1===a)return[[f,g]];for(var h=[],i=0,j=-a;j<=a;j++){var k=g+j;if(!(k>b||k<0))for(var l=-a;l<=a;l++){var m=f+l;m>c||m<0||l*l+j*j<a*a&&(h[i++]=[f+l,g+j])}}return h}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d},"./paintingTools/queue.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,
d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();b.Queue=function(){function a(){d(this,a),this.store={},this.front=0,this.end=0}return e(a,[{key:"enqueue",value:function(a){this.store[this.end]=a,this.end++}},{key:"dequeue",value:function(){if(this.front===this.end)return null;var a=this.store[this.front];return delete this.store[this.front],this.front++,a}},{key:"size",value:function(){return this.end-this.front}}]),a}()},"./referenceLines/calculateReferenceLine.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=(0,d.planePlaneIntersection)(a,b);if(c)return{start:(0,d.projectPatientPointToImagePlane)(c.start,a),end:(0,d.projectPatientPointToImagePlane)(c.end,a)}};var d=c("./util/pointProjector.js")},"./referenceLines/index.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c("./referenceLines/calculateReferenceLine.js"),f=d(e),g=c("./referenceLines/referenceLinesTool.js"),h=d(g),i=c("./referenceLines/renderActiveReferenceLine.js"),j=d(i),k={calculateReferenceLine:f["default"],tool:h["default"],renderActiveReferenceLine:j["default"],getImgPlan:j.getImgPlan};b["default"]=k},"./referenceLines/referenceLinesTool.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=(0,j.getToolState)(a.currentTarget,m);if(void 0!==c){var d=c.data[0].synchronizationContext,e=d.getSourceElements(),f=c.data[0].renderer,g=b.canvasContext.canvas.getContext("2d");i["default"].cornerstone.setToPixelCoordinateSystem(b.enabledElement,g),e.forEach(function(c){c!==a.currentTarget&&f(g,b,a.currentTarget,c)})}}function f(a,b,c){c=c||l["default"],(0,j.addToolState)(a,m,{synchronizationContext:b,renderer:c}),a.removeEventListener(i["default"].cornerstone.EVENTS.IMAGE_RENDERED,e),a.addEventListener(i["default"].cornerstone.EVENTS.IMAGE_RENDERED,e),i["default"].cornerstone.updateImage(a)}function g(a){a.removeEventListener(i["default"].cornerstone.EVENTS.IMAGE_RENDERED,e),i["default"].cornerstone.updateImage(a)}Object.defineProperty(b,"__esModule",{value:!0});var h=c("./externalModules.js"),i=d(h),j=c("./stateManagement/toolState.js"),k=c("./referenceLines/renderActiveReferenceLine.js"),l=d(k),m="referenceLines",n={enable:f,disable:g};b["default"]=n},"./referenceLines/renderActiveReferenceLine.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=cornerstone.metaData.get("imagePlaneModule",a);try{return b.rowCosines=(0,m["default"])(b.rowCosines),b.columnCosines=(0,m["default"])(b.columnCosines),b.imagePositionPatient=(0,m["default"])(b.imagePositionPatient),b}catch(c){return}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d){var e=g["default"].cornerstone,f=e.getEnabledElement(c).image,h=e.getEnabledElement(d).image;if(f&&h){if(_&&ViewerTab&&_.isObject(ViewerTab)){var j=ViewerTab.viewer.getActiveWin();if(j){if(ViewerTab.viewer.isInWin(c,j)||!ViewerTab.viewer.isInWin(d,j))return;if(ViewerTab.viewer.isInSameWin(c,d))return}}var l=e.metaData.get("imagePlaneModule",f.imageId),o=e.metaData.get("imagePlaneModule",h.imageId);if(l&&o&&l.rowCosines&&l.columnCosines&&l.imagePositionPatient&&o.rowCosines&&o.columnCosines&&o.imagePositionPatient&&l.frameOfReferenceUID===o.frameOfReferenceUID){l.rowCosines=(0,m["default"])(l.rowCosines),l.columnCosines=(0,m["default"])(l.columnCosines),l.imagePositionPatient=(0,m["default"])(l.imagePositionPatient),o.rowCosines=(0,m["default"])(o.rowCosines),o.columnCosines=(0,m["default"])(o.columnCosines),o.imagePositionPatient=(0,m["default"])(o.imagePositionPatient);var p=l.rowCosines.clone().cross(l.columnCosines),q=o.rowCosines.clone().cross(o.columnCosines),r=p.angleTo(q);if(r=Math.abs(r),!(r<.5)){var s=(0,i["default"])(l,o);if(s){var t=k["default"].getActiveColor(),u=cornerstoneTools.toolStyle.getToolWidth();if(a.setTransform(1,0,0,1,0,0),j){var v=ViewerTab.series.findSeriesByElement(d);if(v){for(var w=[],x=0;x<v.sideImageIds.length;x++){var y=v.sideImageIds[x].farsideImageId,z=v.sideImageIds[x].nearsideImageId,A=e.metaData.get("imagePlaneModule",y);A.rowCosines=(0,m["default"])(A.rowCosines),A.columnCosines=(0,m["default"])(A.columnCosines),A.imagePositionPatient=(0,m["default"])(A.imagePositionPatient);var B=A.rowCosines.clone().cross(A.columnCosines),r=q.angleTo(B);if(r=Math.abs(r),r<.1){w.push(y),w.push(z);break}}if(w.length>0)for(var x=0;x<w.length;x++){var C=e.metaData.get("imagePlaneModule",w[x]);if(C.rowCosines=(0,m["default"])(C.rowCosines),C.columnCosines=(0,m["default"])(C.columnCosines),C.imagePositionPatient=(0,m["default"])(C.imagePositionPatient),C){var D=C.rowCosines.clone().cross(C.columnCosines),r=p.angleTo(D);if(r=Math.abs(r),!(r<.5)){var E=cornerstoneTools.referenceLines.calculateReferenceLine(l,C);if(E){var F=e.pixelToCanvas(b.element,E.start),G=e.pixelToCanvas(b.element,E.end);a.save(),a.beginPath(),a.strokeStyle="#FF4600",a.lineWidth=u,a.moveTo(F.x,F.y),a.lineTo(G.x,G.y),a.stroke(),a.restore()}}}}}}(0,n.draw)(a,function(a){(0,n.drawLine)(a,b.element,s.start,s.end,{color:t})})}}}}},b.getImgPlan=e;var f=c("./externalModules.js"),g=d(f),h=c("./referenceLines/calculateReferenceLine.js"),i=d(h),j=c("./stateManagement/toolColors.js"),k=d(j),l=c("./util/convertToVector3.js"),m=d(l),n=c("./util/drawing.js")},"./requestPool/requestPoolManager.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d,e,f,g){if(!o.hasOwnProperty(c))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(a&&b){var h={type:c,imageId:b,preventCache:d,doneCallback:e,failCallback:f},i=m["default"].cornerstone.imageCache.getImageLoadObject(b);if(i)return void i.promise.then(function(a){e(a)},function(a){f(a)});g?o[c].unshift(h):o[c].push(h),r=!0}}function f(a){if(!o.hasOwnProperty(a))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");o[a]=[]}function g(){r&&setTimeout(function(){i()},s)}function h(a){function b(a){return"prefetch"===a.type?-5:"interactive"===a.type?0:"thumbnail"===a.type?5:void 0}var c=m["default"].cornerstone,d=a.type;p[d]++,r=!0;var e=a.imageId,f=a.doneCallback,h=a.failCallback,i=c.imageCache.getImageLoadObject(e);if(console.log("imageLoadObject==============",i),i)return void i.promise.then(function(a){p[d]--,f(a),g()},function(a){p[d]--,h(a),g()});var j=b(a),k=void 0;k=a.preventCache===!0?c.loadImage(e,{priority:j,type:a.type}):c.loadAndCacheImage(e,{priority:j,type:a.type}),k.then(function(a){p[d]--,f(a),g()},function(a){p[d]--,h(a),g()})}function i(){var a=(0,n.getMaxSimultaneousRequests)();q={interaction:Math.max(a,1),thumbnail:Math.max(a-2,1),prefetch:Math.max(a-1,1)};for(var b=p.interaction+p.thumbnail+p.prefetch,c=a-b,d=0;d<c;d++){var e=j();e&&h(e)}}function j(){return o.interaction.length&&p.interaction<q.interaction?o.interaction.shift():o.thumbnail.length&&p.thumbnail<q.thumbnail?o.thumbnail.shift():o.prefetch.length&&p.prefetch<q.prefetch?o.prefetch.shift():(o.interaction.length||o.thumbnail.length||o.prefetch.length||(r=!1),!1)}function k(){return o}Object.defineProperty(b,"__esModule",{value:!0});var l=c("./externalModules.js"),m=d(l),n=c("./util/getMaxSimultaneousRequests.js"),o={interaction:[],thumbnail:[],prefetch:[]},p={interaction:0,thumbnail:0,prefetch:0},q={interaction:6,thumbnail:6,prefetch:5},r=!1,s=20;b["default"]={addRequest:e,clearRequestStack:f,startGrabbing:i,getRequestPool:k}},"./stackTools/fusionRenderer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c("./externalModules.js"),h=d(g),i=c("./stateManagement/toolState.js"),j=function(){function a(){e(this,a),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return f(a,[{key:"render",value:function(a,b){var c=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");if(!b){var d=(0,i.getToolState)(a,"stack");b=d.data}var e=h["default"].cornerstone,f=b[0],g=f.imageIds[this.currentImageIdIndex],j=b.slice(1,b.length);e.loadAndCacheImage(g).then(function(b){var d=c.layerIds[0];d=e.addLayer(a,b,f.options),c.layerIds.push(d),e.displayImage(a,b),j.forEach(function(b,f){var h=c.findImageFn(b.imageIds,g),i=f+1,j=c.layerIds[i];j||(j=e.addLayer(a,void 0,b.options),c.layerIds.push(j)),h?e.loadAndCacheImage(h).then(function(b){e.setLayerImage(a,b,j),e.updateImage(a)}):(e.setLayerImage(a,void 0,j),e.setActiveLayer(a,d),e.updateImage(a))})})}}]),a}();b["default"]=j},"./stackTools/playClip.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){var c=void 0,d=void 0,e=void 0,f=0,g=a.length,h=[];for(h.isTimeVarying=!1,("number"!=typeof b||b<=0)&&(b=1),c=1;c<g;c++)e=Number(a[c])/b|0,h.push(e),1===c?d=e:e!==d&&(h.isTimeVarying=!0),f+=e;return h.length>0&&(e=h.isTimeVarying?f/h.length|0:h[0],h.push(e)),h}function f(a){var b=a.intervalId;"undefined"!=typeof b&&(a.intervalId=void 0,a.usingFrameTimeVector?clearTimeout(b):clearInterval(b))}function g(a){var b={element:a};(0,r["default"])(a,k["default"].CLIP_STOPPED,b)}function h(a,b){var c=void 0,d=void 0;if(void 0===a)throw new Error("playClip: element must not be undefined");var h=(0,p.getToolState)(a,"stack");if(h&&h.data&&h.data.length){var i=m["default"].cornerstone,j=void 0;if(h.data.length>1){var k=(0,p.getToolState)(a,"stackRenderer");k&&k.data&&k.data.length&&(j=k.data[0])}var l=h.data[0],n=(0,p.getToolState)(a,s);n&&n.data&&n.data.length?(c=n.data[0],f(c)):(c={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,p.addToolState)(a,s,c)),(b<0||b>0)&&(c.framesPerSecond=Number(b),c.reverse=c.framesPerSecond<0,c.ignoreFrameTimeVector=!0),c.ignoreFrameTimeVector!==!0&&c.frameTimeVector&&c.frameTimeVector.length===l.imageIds.length&&(d=e(c.frameTimeVector,c.speed));var q=function(){var b=void 0,d=void 0,e=void 0,k=void 0,m=l.currentImageIdIndex,n=l.imageIds.length;return c.reverse?m--:m++,!c.loop&&(m<0||m>=n)?(f(c),void g(a)):(m>=n&&(m=0),m<0&&(m=n-1),void(m!==l.currentImageIdIndex&&(d=o["default"].getStartLoadHandler(),e=o["default"].getEndLoadHandler(),k=o["default"].getErrorLoadingHandler(),d&&d(a),b=l.preventCache===!0?i.loadImage(l.imageIds[m]):i.loadAndCacheImage(l.imageIds[m]),b.then(function(b){try{l.currentImageIdIndex=m,j?(j.currentImageIdIndex=m,j.render(a,h.data)):i.displayImage(a,b),e&&e(a,b)}catch(c){return}},function(b){var c=l.imageIds[m];k&&k(a,c,b)}))))};d&&d.length>0&&d.isTimeVarying?(c.usingFrameTimeVector=!0,c.intervalId=setTimeout(function r(){c.intervalId=setTimeout(r,d[l.currentImageIdIndex]),q()},0)):(c.usingFrameTimeVector=!1,c.intervalId=setInterval(q,1e3/Math.abs(c.framesPerSecond)))}}function i(a){var b=(0,p.getToolState)(a,s);b&&b.data&&b.data.length&&f(b.data[0])}Object.defineProperty(b,"__esModule",{value:!0}),b.stopClip=b.playClip=void 0;var j=c("./events.js"),k=d(j),l=c("./externalModules.js"),m=d(l),n=c("./stateManagement/loadHandlerManager.js"),o=d(n),p=c("./stateManagement/toolState.js"),q=c("./util/triggerEvent.js"),r=d(q),s="playClip";b.playClip=h,b.stopClip=i},"./stackTools/scrollIndicator.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.element,d=b.enabledElement.canvas.width,e=b.enabledElement.canvas.height;if(!d||!e)return!1;var f=(0,i.getNewContext)(b.enabledElement.canvas);(0,i.draw)(f,function(a){var b=l.getConfiguration(),f=void 0;f="horizontal"===b.orientation?{left:0,top:e-j,width:d,height:j}:{left:0,top:0,width:j,height:e},(0,i.fillBox)(a,f,b.backgroundColor);var g=(0,h.getToolState)(c,"stack");if(g&&g.data&&g.data.length){var k=g.data[0].imageIds,m=g.data[0].currentImageIdIndex,n=d/k.length,o=e/k.length,p=n*m,q=o*m;f="horizontal"===b.orientation?{left:p,top:e-j,width:n,height:j}:{left:0,top:q,width:j,height:o},(0,i.fillBox)(a,f,b.fillColor)}})}Object.defineProperty(b,"__esModule",{value:!0});var f=c("./imageTools/displayTool.js"),g=d(f),h=c("./stateManagement/toolState.js"),i=c("./util/drawing.js"),j=6,k={backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"},l=(0,g["default"])(e);l.setConfiguration(k),b["default"]=l},"./stackTools/stackPrefetch.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){a=Math.round(a)||0,b=Math.round(b)||0;var c=[],d=b-a+1;if(d<=0)return c;for(;d--;)c[d]=b--;return c}function f(a,b){var c=[],d=[];return a.forEach(function(a){a<b?c.push(a):a>b&&d.push(a)}),{low:a.indexOf(A(c)),high:a.indexOf(B(d))}}function g(a){function b(a){var b=i.indicesToRequest.indexOf(a);b>-1&&i.indicesToRequest.splice(b,1)}function c(a){var c=g.imageIds.indexOf(a.imageId);b(c)}function d(b){console.log("prefetch errored: "+b),p&&p(a,l,b,"stackPrefetch")}var e=(0,t.getToolState)(a,"stack");if(e&&e.data&&e.data.length){var g=e.data[0],h=(0,t.getToolState)(a,v);if(h){var i=h.data[0]||{};if(i.indicesToRequest&&i.indicesToRequest.length||(i.enabled=!1),i.enabled!==!1){h.data[0].indicesToRequest.sort(function(a,b){return a-b});var j=i.indicesToRequest.slice();if(j.forEach(function(a){var c=g.imageIds[a];if(c){var d=o["default"].cornerstone.imageCache.getImageLoadObject(c);console.log("imageLoadObject==============",d),d&&b(a)}}),i.indicesToRequest.length){x.preserveExistingPool||q["default"].clearRequestStack(w);for(var k=f(i.indicesToRequest,g.currentImageIdIndex),l=void 0,m=void 0,n=!1,p=s["default"].getErrorLoadingHandler(),r=k.low,u=k.high,y=[];r>=0||u<i.indicesToRequest.length;){var z=g.currentImageIdIndex,A=z-i.indicesToRequest[r]>x.maxImagesToPrefetch,B=i.indicesToRequest[u]-z>x.maxImagesToPrefetch,C=!A&&r>=0,D=!B&&u<i.indicesToRequest.length;if(!D&&!C)break;C&&(m=i.indicesToRequest[r--],l=g.imageIds[m],y.push(l)),D&&(m=i.indicesToRequest[u++],l=g.imageIds[m],y.push(l))}var E=!0,F=!1,G=void 0;try{for(var H,I=y.reverse()[Symbol.iterator]();!(E=(H=I.next()).done);E=!0){var J=H.value;q["default"].addRequest(a,J,w,n,c,d,!0)}}catch(K){F=!0,G=K}finally{try{!E&&I["return"]&&I["return"]()}finally{if(F)throw G}}q["default"].startGrabbing()}}}}}function h(a){return function(b){var c=b.detail,d=void 0;try{d=(0,t.getToolState)(a,"stack")}catch(e){return}if(d&&d.data&&d.data.length){var f=d.data[0],g=f.imageIds.indexOf(c.imageId);if(!(g<0)){var h=(0,t.getToolState)(a,v);h&&h.data&&h.data.length&&h.data[0].indicesToRequest.push(g)}}}}function i(a){clearTimeout(y),y=setTimeout(function(){var b=a.target;try{g(b)}catch(c){return}},z)}function j(a){var b=(0,t.getToolState)(a,v);b.data=[];var c=(0,t.getToolState)(a,"stack");if(c&&c.data&&c.data.length){var d=c.data[0];if(d.preventCache===!0)return void console.warn("A stack that should not be cached was given the stackPrefetch");var f={indicesToRequest:e(0,d.imageIds.length-1),enabled:!0,direction:1},j=f.indicesToRequest.indexOf(d.currentImageIdIndex);f.indicesToRequest.splice(j,1),(0,t.addToolState)(a,v,f),g(a),a.removeEventListener(o["default"].cornerstone.EVENTS.NEW_IMAGE,i),a.addEventListener(o["default"].cornerstone.EVENTS.NEW_IMAGE,i);var k=h(a);o["default"].cornerstone.events.removeEventListener(o["default"].cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,k),o["default"].cornerstone.events.addEventListener(o["default"].cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,k)}}function k(a){clearTimeout(y),a.removeEventListener(o["default"].cornerstone.EVENTS.NEW_IMAGE,i);var b=h(a);o["default"].cornerstone.events.removeEventListener(o["default"].cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,b);var c=(0,t.getToolState)(a,v);c&&c.data.length&&(c.data[0].enabled=!1,q["default"].clearRequestStack(w))}function l(){return x}function m(a){x=a,a.maxSimultaneousRequests&&(0,u.setMaxSimultaneousRequests)(a.maxSimultaneousRequests)}Object.defineProperty(b,"__esModule",{value:!0});var n=c("./externalModules.js"),o=d(n),p=c("./requestPool/requestPoolManager.js"),q=d(p),r=c("./stateManagement/loadHandlerManager.js"),s=d(r),t=c("./stateManagement/toolState.js"),u=c("./util/getMaxSimultaneousRequests.js"),v="stackPrefetch",w="prefetch",x={maxImagesToPrefetch:1/0,preserveExistingPool:!1},y=void 0,z=10,A=function(a){return Math.max.apply(null,a)},B=function(a){return Math.min.apply(null,a)},C={enable:j,disable:k,getConfiguration:l,setConfiguration:m};b["default"]=C},"./stackTools/stackRenderers.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c("./stackTools/fusionRenderer.js"),f=d(e),g={};g.FusionRenderer=f["default"],b["default"]=g},"./stackTools/stackScroll.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.element;c.removeEventListener(k["default"].MOUSE_DRAG,h),c.removeEventListener(k["default"].MOUSE_UP,e),c.removeEventListener(k["default"].MOUSE_CLICK,e)}function f(a){var b=a.detail,c=b.element,d=(0,y.getToolOptions)(z,c);if((0,u["default"])(b.which,d.mouseButtonMask))return d.deltaY=0,(0,y.setToolOptions)(z,c,d),c.addEventListener(k["default"].MOUSE_DRAG,h),c.addEventListener(k["default"].MOUSE_UP,e),c.addEventListener(k["default"].MOUSE_CLICK,e),a.stopImmediatePropagation(),!1}function g(a){var b=a.detail,c=-b.direction,d=B.getConfiguration(),e=!1,f=!0;d&&(e=void 0!==d.loop&&d.loop,f=void 0===d.allowSkipping||d.allowSkipping),(0,w["default"])(b.element,c,e,f)}function h(a){var b=a.detail,c=b.element,d=(0,x.getToolState)(c,"stack");if(d&&d.data&&d.data.length){var e=d.data[0],f=B.getConfiguration(),g=!0;f&&void 0!==f.allowSkipping&&(g=f.allowSkipping);var h=Math.max(2,c.offsetHeight/Math.max(e.imageIds.length,8));f&&f.stackScrollSpeed&&(h=f.stackScrollSpeed);var i=(0,y.getToolOptions)(z,c),j=i.deltaY||0;if(j+=b.deltaPoints.page.y,Math.abs(j)>=h){var k=Math.round(j/h);(0,w["default"])(c,k,!1,g),i.deltaY=j%h}else i.deltaY=j;(0,y.setToolOptions)(z,c,i),a.preventDefault(),a.stopPropagation()}}function i(a){var b=a.detail,c=G.getConfiguration();c&&c.testPointers(b)&&h(a)}Object.defineProperty(b,"__esModule",{value:!0}),b.stackScrollMultiTouch=b.stackScrollTouchDrag=b.stackScrollWheel=b.stackScroll=void 0;var j=c("./events.js"),k=d(j),l=c("./imageTools/touchDragTool.js"),m=d(l),n=c("./imageTools/multiTouchDragTool.js"),o=d(n),p=c("./imageTools/simpleMouseButtonTool.js"),q=d(p),r=c("./imageTools/mouseWheelTool.js"),s=d(r),t=c("./util/isMouseButtonEnabled.js"),u=d(t),v=c("./util/scroll.js"),w=d(v),x=c("./stateManagement/toolState.js"),y=c("./toolOptions.js"),z="stackScroll",A="stackScrollTouchDrag",B=(0,q["default"])(f,z),C=(0,s["default"])(g),D={eventData:{deltaY:0}},E=(0,m["default"])(h,A,D),F={testPointers:function(a){return a.numPointers>=3}},G=(0,o["default"])(i,D);G.setConfiguration(F),b.stackScroll=B,b.stackScrollWheel=C,b.stackScrollTouchDrag=E,b.stackScrollMultiTouch=G},"./stackTools/stackScrollKeyboard.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.keyCode;if(c===j.UP||c===j.DOWN){var d=1;c===j.DOWN&&(d=-1),(0,g["default"])(b.element,d)}}Object.defineProperty(b,"__esModule",{value:!0});var f=c("./util/scroll.js"),g=d(f),h=c("./imageTools/keyboardTool.js"),i=d(h),j={UP:38,DOWN:40},k=(0,i["default"])(e);b["default"]=k},"./stateManagement/appState.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b={imageIdToolState:i.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return a.forEach(function(a){var c=(0,j.getElementToolStateManager)(a);c!==i.globalImageIdSpecificToolStateManager&&(b.elementToolState[a.id]=c.saveToolState(),b.elementViewport[a.id]=h["default"].cornerstone.getViewport(a))}),b}function f(a){if(a.hasOwnProperty("imageIdToolState")&&a.hasOwnProperty("elementToolState")&&a.hasOwnProperty("elementViewport")){var b=h["default"].cornerstone;return i.globalImageIdSpecificToolStateManager.restoreToolState(a.imageIdToolState),Object.keys(a.elementViewport).forEach(function(c){var d=document.getElementById(c);if(d&&a.elementToolState.hasOwnProperty(c)){var e=(0,j.getElementToolStateManager)(d);if(e!==i.globalImageIdSpecificToolStateManager){e.restoreToolState(a.elementToolState[c]);var f=a.elementViewport[c];b.setViewport(d,f),b.updateImage(d)}}}),a}}Object.defineProperty(b,"__esModule",{value:!0});var g=c("./externalModules.js"),h=d(g),i=c("./stateManagement/imageIdSpecificStateManager.js"),j=c("./stateManagement/toolState.js"),k={save:e,restore:f};b["default"]=k},"./stateManagement/frameOfReferenceStateManager.js":function(a,b,c){"use strict";function d(){function a(a,b,c){d.hasOwnProperty(a)===!1&&(d[a]={});var e=d[a];e.hasOwnProperty(b)===!1&&(e[b]={data:[]});var f=e[b];f.data.push(c)}function b(a,b){if(d.hasOwnProperty(a)!==!1){var c=d[a];if(c.hasOwnProperty(b)!==!1){var e=c[b];return e}}}function c(a,b,c){if(d.hasOwnProperty(a)!==!1){var e=d[a];if(e.hasOwnProperty(b)!==!1){for(var f=e[b],g=-1,h=0;h<f.data.length;h++)f.data[h]===c&&(g=h);g!==-1&&f.data.splice(g,1)}}}var d={};return{get:b,add:a,remove:c}}Object.defineProperty(b,"__esModule",{value:!0});var e=d();b.newFrameOfReferenceSpecificToolStateManager=d,b.globalFrameOfReferenceSpecificToolStateManager=e},"./stateManagement/imageIdSpecificStateManager.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){function a(a){return i[a]}function b(a,b){i[a]=b}function c(){return i}function d(a){i=a}function e(a,b,c){var d=g["default"].cornerstone.getEnabledElement(a);d.image&&i.hasOwnProperty(d.image.imageId)!==!1||(i[d.image.imageId]={});var e=i[d.image.imageId];e.hasOwnProperty(b)===!1&&(e[b]={data:[]});var f=e[b];f.data.push(c)}function f(a,b){var c=g["default"].cornerstone.getEnabledElement(a);if(c.image&&i.hasOwnProperty(c.image.imageId)!==!1){var d=i[c.image.imageId];if(d.hasOwnProperty(b)!==!1){var e=d[b];return e}}}function h(a){var b=g["default"].cornerstone.getEnabledElement(a);b.image&&i.hasOwnProperty(b.image.imageId)!==!1&&delete i[b.image.imageId]}var i={};return{get:f,add:e,clear:h,saveImageIdToolState:a,restoreImageIdToolState:b,saveToolState:c,restoreToolState:d,toolState:i}}Object.defineProperty(b,"__esModule",{value:!0}),b.globalImageIdSpecificToolStateManager=b.newImageIdSpecificToolStateManager=void 0;var f=c("./externalModules.js"),g=d(f),h=e();b.newImageIdSpecificToolStateManager=e,b.globalImageIdSpecificToolStateManager=h},"./stateManagement/loadHandlerManager.js":function(a,b,c){"use strict";function d(a){j=a}function e(){return j}function f(a){k=a}function g(){return k}function h(a){l=a}function i(){return l}Object.defineProperty(b,"__esModule",{value:!0});var j=void 0,k=void 0,l=void 0,m={setStartLoadHandler:d,getStartLoadHandler:e,setEndLoadHandler:f,getEndLoadHandler:g,setErrorLoadingHandler:h,getErrorLoadingHandler:i};b["default"]=m},"./stateManagement/stackSpecificStateManager.js":function(a,b,c){"use strict";function d(a,b){function c(){return g}function d(a){g=a}function e(c,d,e){if(!(a.indexOf(d)>=0))return b.add(c,d,e);g.hasOwnProperty(d)===!1&&(g[d]={data:[]});var f=g[d];f.data.push(e)}function f(c,d){return a.indexOf(d)>=0?(g.hasOwnProperty(d)===!1&&(g[d]={data:[]}),g[d]):b.get(c,d)}var g={},h={get:f,add:e,saveToolState:c,restoreToolState:d,toolState:g};return h}function e(a,b){var c=(0,g.getElementToolStateManager)(a);c||(c=f.globalImageIdSpecificToolStateManager);var e=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];b&&(e=e.concat(b));var i=d(e,c);h.push(i),(0,g.setElementToolStateManager)(a,i)}Object.defineProperty(b,"__esModule",{value:!0}),b.addStackStateManager=b.newStackSpecificToolStateManager=b.stackSpecificStateManager=void 0;var f=c("./stateManagement/imageIdSpecificStateManager.js"),g=c("./stateManagement/toolState.js"),h=[],i={newStackSpecificToolStateManager:d,addStackStateManager:e};b.stackSpecificStateManager=i,b.newStackSpecificToolStateManager=d,b.addStackStateManager=e},"./stateManagement/textStyle.js":function(a,b,c){"use strict";function d(a){k=a}function e(){return k}function f(a){j=a}function g(){return j}function h(a){l=a}function i(){return l}Object.defineProperty(b,"__esModule",{value:!0});var j=15,k=j+"px Arial",l="transparent",m={setFont:d,getFont:e,setFontSize:f,getFontSize:g,setBackgroundColor:h,getBackgroundColor:i};b["default"]=m},"./stateManagement/timeSeriesSpecificStateManager.js":function(a,b,c){"use strict";function d(a,b){function c(c,d,f){if(!(a.indexOf(d)>=0))return b.add(c,d,f);e.hasOwnProperty(d)===!1&&(e[d]={data:[]});var g=e[d];g.data.push(f)}function d(c,d){return a.indexOf(d)>=0?(e.hasOwnProperty(d)===!1&&(e[d]={data:[]}),e[d]):b.get(c,d)}var e={},f={get:d,add:c};return f}function e(a,b){b=b||["timeSeries"];var c=(0,g.getElementToolStateManager)(a);void 0===c&&(c=f.globalImageIdSpecificToolStateManager);var e=d(b,c);h.push(e),(0,g.setElementToolStateManager)(a,e)}Object.defineProperty(b,"__esModule",{value:!0}),b.newTimeSeriesSpecificToolStateManager=b.addTimeSeriesStateManager=void 0;var f=c("./stateManagement/imageIdSpecificStateManager.js"),g=c("./stateManagement/toolState.js"),h=[];b.addTimeSeriesStateManager=e,b.newTimeSeriesSpecificToolStateManager=d},"./stateManagement/toolColors.js":function(a,b,c){"use strict";function d(a){m=a}function e(){return m}function f(a){k=a}function g(){return k}function h(a){l=a}function i(){return l}function j(a){return a.color?a.color:a.active?l:k}Object.defineProperty(b,"__esModule",{value:!0});var k="white",l="greenyellow",m="transparent",n={setFillColor:d,getFillColor:e,setToolColor:f,getToolColor:g,setActiveColor:h,getActiveColor:i,getColorIfActive:j};b["default"]=n},"./stateManagement/toolCoordinates.js":function(a,b,c){"use strict";function d(a){f=a.currentPoints.canvas}function e(){return f}Object.defineProperty(b,"__esModule",{value:!0});var f=void 0,g={setCoords:d,getCoords:e};b["default"]=g},"./stateManagement/toolState.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=n["default"].cornerstone.getEnabledElement(a);return void 0===b.toolStateManager&&(b.toolStateManager=o.globalImageIdSpecificToolStateManager),b.toolStateManager}function f(a,b,c){var d=e(a);d.add(a,b,c);var f=l["default"].MEASUREMENT_ADDED,g={toolType:b,element:a,measurementData:c};(0,q["default"])(a,f,g)}function g(a,b){var c=e(a);return c.get(a,b)}function h(a,b,c){for(var d=e(a),f=d.get(a,b),g=-1,h=0;h<f.data.length;h++)f.data[h]===c&&(g=h);if(g!==-1){f.data.splice(g,1);var i=l["default"].MEASUREMENT_REMOVED,j={toolType:b,element:a,measurementData:c};(0,q["default"])(a,i,j)}}function i(a,b){var c=e(a),d=c.get(a,b);void 0!==d&&(d.data=[])}function j(a,b){var c=n["default"].cornerstone.getEnabledElement(a);c.toolStateManager=b}Object.defineProperty(b,"__esModule",{value:!0}),b.getElementToolStateManager=b.setElementToolStateManager=b.clearToolState=b.removeToolState=b.getToolState=b.addToolState=void 0;var k=c("./events.js"),l=d(k),m=c("./externalModules.js"),n=d(m),o=c("./stateManagement/imageIdSpecificStateManager.js"),p=c("./util/triggerEvent.js"),q=d(p);b.addToolState=f,b.getToolState=g,b.removeToolState=h,b.clearToolState=i,b.setElementToolStateManager=j,b.getElementToolStateManager=e},"./stateManagement/toolStyle.js":function(a,b,c){"use strict";function d(a){h=a}function e(){return h}function f(a){i=a}function g(){return i}Object.defineProperty(b,"__esModule",{value:!0});var h=1,i=2,j={setToolWidth:d,getToolWidth:e,setActiveWidth:f,getActiveWidth:g};b["default"]=j},"./synchronization/Synchronizer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return a.filter(function(a,b,c){return c.indexOf(a)===b})}function f(a,b){function c(a,b){i.enabled&&l.length&&m.length&&(n=!0,m.forEach(function(c){var d=m.indexOf(c);if(d!==-1){var e=o.imageIds.targetElements[d],f=l.indexOf(a);if(f!==-1){var g=o.imageIds.sourceElements[f],h=void 0;g===e?h=0:void 0!==o.distances[g]&&(h=o.distances[g][e]),p(i,a,c,b,h)}}}),n=!1)}function d(a){var b=a.detail;n!==!0&&c(a.currentTarget,b)}function f(a){var b=a.detail.element;i.remove(b),(0,k.clearToolOptionsByElement)(b)}var g=h["default"].cornerstone,i=this,l=[],m=[],n=!1,o={},p=b;this.enabled=!0,this.setHandler=function(a){p=a},this.getHandler=function(){return p},this.getDistances=function(){l.length&&m.length&&(o.distances={},o.imageIds={sourceElements:[],targetElements:[]},l.forEach(function(a){var b=g.getEnabledElement(a);if(b&&b.image){var c=b.image.imageId,d=g.metaData.get("imagePlaneModule",c);if(d&&d.imagePositionPatient){var e=(0,j["default"])(d.imagePositionPatient);o.hasOwnProperty(b)||(o.distances[c]={},o.imageIds.sourceElements.push(c),m.forEach(function(b){var d=g.getEnabledElement(b);if(d&&d.image){var f=d.image.imageId;if(o.imageIds.targetElements.push(f),a!==b&&c!==f&&!o.distances[c].hasOwnProperty(f)){var h=g.metaData.get("imagePlaneModule",f);if(h&&h.imagePositionPatient){var i=(0,j["default"])(h.imagePositionPatient);o.distances[c][f]=i.clone().sub(e)}}}}),Object.keys(o.distances[c]).length||delete o.distances[c])}}}))},this.addSource=function(b){var c=l.indexOf(b);c===-1&&(l.push(b),a.split(" ").forEach(function(a){b.addEventListener(a,d)}),i.getDistances(),i.updateDisableHandlers())},this.addTarget=function(a){var b=m.indexOf(a);b===-1&&(m.push(a),i.getDistances(),p(i,a,a,0),i.updateDisableHandlers())},this.add=function(a){i.addSource(a),i.addTarget(a)},this.removeSource=function(b){var e=l.indexOf(b);e!==-1&&(l.splice(e,1),a.split(" ").forEach(function(a){b.removeEventListener(a,d)}),i.getDistances(),c(b),i.updateDisableHandlers())},this.removeTarget=function(a){var b=m.indexOf(a);b!==-1&&(m.splice(b,1),i.getDistances(),p(i,a,a,0),i.updateDisableHandlers())},this.remove=function(a){i.removeTarget(a),i.removeSource(a)},this.getSourceElements=function(){return l},this.getTargetElements=function(){return m},this.displayImage=function(a,b,c){return console.log("    console.log(displayImage);"),n=!0,g.displayImage(a,b,c),n=!1},this.displayImageDraw=function(a,b,c){return console.log("displayImageDraw"),n=!0,g.displayImageDraw(a,b,c),n=!1},this.setViewport=function(a,b){n=!0,g.setViewport(a,b),n=!1},this.updateDisableHandlers=function(){var a=e(l.concat(m));a.forEach(function(a){a.removeEventListener(h["default"].cornerstone.EVENTS.ELEMENT_DISABLED,f),a.addEventListener(h["default"].cornerstone.EVENTS.ELEMENT_DISABLED,f)})},this.destroy=function(){var a=e(l.concat(m));a.forEach(function(a){i.remove(a)})}}Object.defineProperty(b,"__esModule",{value:!0});var g=c("./externalModules.js"),h=d(g),i=c("./util/convertToVector3.js"),j=d(i),k=c("./toolOptions.js");b["default"]=f},"./synchronization/panZoomSynchronizer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){if(c!==b){var d=f["default"].cornerstone,e=d.getViewport(b),g=d.getViewport(c);g.scale===e.scale&&g.translation.x===e.translation.x&&g.translation.y===e.translation.y||(g.scale=e.scale,g.translation.x=e.translation.x,g.translation.y=e.translation.y,a.setViewport(c,g))}};var e=c("./externalModules.js"),f=d(e)},"./synchronization/stackImageIndexSynchronizer.js":function(a,b,c){
"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){if(c!==b){var d=f["default"].cornerstone,e=(0,g.getToolState)(b,"stack"),h=e.data[0],j=(0,g.getToolState)(c,"stack"),l=j.data[0],m=h.currentImageIdIndex;if(m=(0,k["default"])(m,0,l.imageIds.length-1),m!==l.currentImageIdIndex){var n=i["default"].getStartLoadHandler(),o=i["default"].getEndLoadHandler(),p=i["default"].getErrorLoadingHandler();n&&n(c);var q=void 0;q=l.preventCache===!0?d.loadImage(l.imageIds[m]):d.loadAndCacheImage(l.imageIds[m]),q.then(function(b){var e=d.getViewport(c);l.currentImageIdIndex=m,a.displayImage(c,b,e),o&&o(c,b)},function(a){var b=l.imageIds[m];p&&p(c,b,a)})}}};var e=c("./externalModules.js"),f=d(e),g=c("./stateManagement/toolState.js"),h=c("./stateManagement/loadHandlerManager.js"),i=d(h),j=c("./util/clip.js"),k=d(j)},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e){if(c!==b){var h=f["default"].cornerstone,j=h.getEnabledElement(b),l=h.metaData.get("imagePlaneModule",j.image.imageId);if(void 0!==l&&void 0!==l.imagePositionPatient){var m=(0,k["default"])(l.imagePositionPatient),n=(0,g.getToolState)(c,"stack"),o=n.data[0],p=Number.MAX_VALUE,q=-1;if(e){var r=m.clone().add(e);if(o.imageIds.forEach(function(a,b){var c=h.metaData.get("imagePlaneModule",a);if(void 0!==c&&void 0!==c.imagePositionPatient){var d=(0,k["default"])(c.imagePositionPatient),e=r.distanceToSquared(d);e<p&&(p=e,q=b)}}),q!==o.currentImageIdIndex&&q!==-1){var s=i["default"].getStartLoadHandler(),t=i["default"].getEndLoadHandler(),u=i["default"].getErrorLoadingHandler();o.currentImageIdIndex=q;var v=o.imageIds[q];s&&s(c);var w=void 0;w=o.preventCache===!0?h.loadImage(v):h.loadAndCacheImage(v),w.then(function(b){var d=h.getViewport(c);o.currentImageIdIndex===q&&(a.displayImage(c,b,d),t&&t(c,b))},function(a){var b=o.imageIds[q];u&&u(c,b,a)})}}}}};var e=c("./externalModules.js"),f=d(e),g=c("./stateManagement/toolState.js"),h=c("./stateManagement/loadHandlerManager.js"),i=d(h),j=c("./util/convertToVector3.js"),k=d(j)},"./synchronization/stackImagePositionSynchronizer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){if(c!==b){var d=f["default"].cornerstone,e=d.getEnabledElement(b).image,h=d.metaData.get("imagePlaneModule",e.imageId);if(void 0!==h&&void 0!==h.imagePositionPatient){var j=(0,k["default"])(h.imagePositionPatient),l=(0,g.getToolState)(c,"stack"),m=l.data[0],n=Number.MAX_VALUE,o=-1;if(m.imageIds.forEach(function(a,b){var c=d.metaData.get("imagePlaneModule",a);if(void 0!==c&&void 0!==c.imagePositionPatient){var e=(0,k["default"])(c.imagePositionPatient),f=e.distanceToSquared(j);f<n&&(n=f,o=b)}}),o!==m.currentImageIdIndex){var p=i["default"].getStartLoadHandler(),q=i["default"].getEndLoadHandler(),r=i["default"].getErrorLoadingHandler();m.currentImageIdIndex=o;var s=m.imageIds[o];if(p&&p(c),o!==-1){var t=void 0;t=m.preventCache===!0?d.loadImage(s):d.loadAndCacheImage(s),t.then(function(b){var e=d.getViewport(c);m.currentImageIdIndex===o&&(a.displayImage(c,b,e),q&&q(c,b))},function(a){var b=m.imageIds[o];r&&r(c,b,a)})}}}}};var e=c("./externalModules.js"),f=d(e),g=c("./stateManagement/toolState.js"),h=c("./stateManagement/loadHandlerManager.js"),i=d(h),j=c("./util/convertToVector3.js"),k=d(j)},"./synchronization/stackScrollSynchronizer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d){if(b!==c&&d&&d.direction){var e=f["default"].cornerstone,h=(0,g.getToolState)(c,"stack"),j=h.data[0],l=j.currentImageIdIndex+d.direction;if(l=(0,k["default"])(l,0,j.imageIds.length-1),j.currentImageIdIndex!==l){var m=i["default"].getStartLoadHandler(),n=i["default"].getEndLoadHandler(),o=i["default"].getErrorLoadingHandler();j.currentImageIdIndex=l;var p=j.imageIds[l];m&&m(c);var q=void 0;q=j.preventCache===!0?e.loadImage(p):e.loadAndCacheImage(p),q.then(function(b){var d=e.getViewport(c);j.currentImageIdIndex===l&&(a.displayImage(c,b,d),n&&n(c,b))},function(a){var b=j.imageIds[l];o&&o(c,b,a)})}}};var e=c("./externalModules.js"),f=d(e),g=c("./stateManagement/toolState.js"),h=c("./stateManagement/loadHandlerManager.js"),i=d(h),j=c("./util/clip.js"),k=d(j)},"./synchronization/updateImageSynchronizer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){c!==b&&f["default"].cornerstone.updateImage(c)};var e=c("./externalModules.js"),f=d(e)},"./synchronization/wwwcSynchronizer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){if(c!==b){var d=f["default"].cornerstone,e=d.getViewport(b),g=d.getViewport(c);g.voi.windowWidth===e.voi.windowWidth&&g.voi.windowCenter===e.voi.windowCenter&&g.invert===e.invert||(g.voi.windowWidth=e.voi.windowWidth,g.voi.windowCenter=e.voi.windowCenter,g.invert=e.invert,a.setViewport(c,g))}};var e=c("./externalModules.js"),f=d(e)},"./timeSeriesTools/incrementTimePoint.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){var d=(0,g.getToolState)(a,"timeSeries");if(d&&d.data&&d.data.length){var e=f["default"].cornerstone,h=d.data[0],j=h.stacks[h.currentStackIndex],l=j.currentImageIdIndex,m=h.currentStackIndex+b;if(c?(m>=h.stacks.length&&(m=0),m<0&&(m=h.stacks.length-1)):m=(0,k["default"])(m,0,h.stacks.length-1),m!==h.currentStackIndex){var n=e.getViewport(a),o=h.stacks[m],p=i["default"].getStartLoadHandler(),q=i["default"].getEndLoadHandler(),r=i["default"].getErrorLoadingHandler();p&&p(a);var s=void 0;s=o.preventCache===!0?e.loadImage(o.imageIds[l]):e.loadAndCacheImage(o.imageIds[l]),s.then(function(b){h.currentImageIdIndex!==l&&(o.currentImageIdIndex=l,h.currentStackIndex=m,e.displayImage(a,b,n),q&&q(a,b))},function(b){var c=o.imageIds[l];r&&r(a,c,b)})}}};var e=c("./externalModules.js"),f=d(e),g=c("./stateManagement/toolState.js"),h=c("./stateManagement/loadHandlerManager.js"),i=d(h),j=c("./util/clip.js"),k=d(j)},"./timeSeriesTools/probeTool4D.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=i["default"].cornerstone,c=[];a.timeSeries.stacks.forEach(function(d){var e=void 0;e=d.preventCache===!0?b.loadImage(d.imageIds[a.imageIdIndex]):b.loadAndCacheImage(d.imageIds[a.imageIdIndex]),e.then(function(b){var d=Math.round(a.handles.end.x)+Math.round(a.handles.end.y)*b.width,e=b.getPixelData()[d];c.push(e)})}),a.lineSample.set(c)}function f(a){var b=(0,n.getToolState)(a.element,"timeSeries");if(void 0!==b&&void 0!==b.data&&0!==b.data.length){var c=b.data[0],d={timeSeries:c,lineSample:new r["default"],imageIdIndex:c.stacks[c.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:a.currentPoints.image.x,y:a.currentPoints.image.y,highlight:!0,active:!0}}};return e(d),p["default"].add(d),d}}function g(a){var b=i["default"].cornerstone,c=a.detail,d=(0,n.getToolState)(a.currentTarget,v);if(d){var e=c.canvasContext;e.setTransform(1,0,0,1,0,0);for(var f="white",g=function(a){(0,u.draw)(e,function(e){var g=d.data[a];(0,m["default"])(e,c,g.handles,f);var h={x:g.handles.end.x+3,y:g.handles.end.y-3},i=b.pixelToCanvas(c.element,h);(0,t["default"])(e,g.handles.end.x+", "+g.handles.end.y,i.x,i.y,f)})},h=0;h<d.data.length;h++)g(h)}}Object.defineProperty(b,"__esModule",{value:!0});var h=c("./externalModules.js"),i=d(h),j=c("./imageTools/mouseButtonTool.js"),k=d(j),l=c("./manipulators/drawHandles.js"),m=d(l),n=c("./stateManagement/toolState.js"),o=c("./measurementManager/measurementManager.js"),p=d(o),q=c("./measurementManager/lineSampleMeasurement.js"),r=d(q),s=c("./util/drawTextBox.js"),t=d(s),u=c("./util/drawing.js"),v="probe4D",w=(0,k["default"])({createNewMeasurement:f,onImageRendered:g,toolType:v});b["default"]=w},"./timeSeriesTools/timeSeriesPlayer.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(void 0===a)throw new Error("playClip: element must not be undefined");void 0===b&&(b=30);var c=(0,g.getToolState)(a,"timeSeries");if(void 0!==c&&void 0!==c.data&&0!==c.data.length){var d=(0,g.getToolState)(a,j),e=void 0;void 0===d||0===d.data.length?(e={intervalId:void 0,framesPerSecond:b,lastFrameTimeStamp:void 0,frameRate:0},(0,g.addToolState)(a,j,e)):(e=d.data[0],e.framesPerSecond=b),void 0===e.intervalId&&(e.intervalId=setInterval(function(){e.framesPerSecond>0?(0,i["default"])(a,1,!0):(0,i["default"])(a,-1,!0)},1e3/Math.abs(e.framesPerSecond)))}}function f(a){var b=(0,g.getToolState)(a,j);if(b&&b.data&&b.data.length){var c=b.data[0];clearInterval(c.intervalId),c.intervalId=void 0}}Object.defineProperty(b,"__esModule",{value:!0});var g=c("./stateManagement/toolState.js"),h=c("./timeSeriesTools/incrementTimePoint.js"),i=d(h),j="timeSeriesPlayer",k={start:e,stop:f};b["default"]=k},"./timeSeriesTools/timeSeriesScroll.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=b.element;c.removeEventListener(k["default"].MOUSE_DRAG,g),c.removeEventListener(k["default"].MOUSE_UP,e),c.removeEventListener(k["default"].MOUSE_CLICK,e)}function f(a){var b=a.detail,c=b.element,d=(0,w.getToolOptions)(x,c);if((0,u["default"])(b.which,d.mouseButtonMask))return d.deltaY=0,(0,w.setToolOptions)(x,c,d),c.addEventListener(k["default"].MOUSE_DRAG,g),c.addEventListener(k["default"].MOUSE_UP,e),c.addEventListener(k["default"].MOUSE_CLICK,e),a.stopImmediatePropagation(),!1}function g(a){var b=a.detail,c=b.element;a.data.deltaY+=b.deltaPoints.page.y;var d=(0,v.getToolState)(b.element,"timeSeries");if(void 0!==d&&void 0!==d.data&&0!==d.data.length){var e=d.data[0],f=c.offsetHeight/e.stacks.length;if(void 0!==a.data.options&&void 0!==a.data.options.timeSeriesScrollSpeed&&(f=a.data.options.timeSeriesScrollSpeed),a.data.deltaY>=f||a.data.deltaY<=-f){var g=Math.round(a.data.deltaY/f),h=a.data.deltaY%f;(0,s["default"])(b.element,g),a.data.deltaY=h}return!1}}function h(a){var b=a.detail,c=-b.direction;(0,s["default"])(b.element,c)}function i(a){var b=a.originalEvent.detail,c={deltaY:0};c.deltaY+=b.deltaPoints.page.y;var d=(0,v.getToolState)(b.element,"stack");if(void 0!==d&&void 0!==d.data&&0!==d.data.length){if(c.deltaY>=3||c.deltaY<=-3){var e=c.deltaY/3,f=c.deltaY%3;(0,s["default"])(c.element,e),c.deltaY=f}return!1}}Object.defineProperty(b,"__esModule",{value:!0}),b.timeSeriesScrollTouchDrag=b.timeSeriesScrollWheel=b.timeSeriesScroll=void 0;var j=c("./events.js"),k=d(j),l=c("./imageTools/simpleMouseButtonTool.js"),m=d(l),n=c("./imageTools/touchDragTool.js"),o=d(n),p=c("./imageTools/mouseWheelTool.js"),q=d(p),r=c("./timeSeriesTools/incrementTimePoint.js"),s=d(r),t=c("./util/isMouseButtonEnabled.js"),u=d(t),v=c("./stateManagement/toolState.js"),w=c("./toolOptions.js"),x="timeSeriesScroll",y=(0,m["default"])(f,x),z=(0,q["default"])(h),A=(0,o["default"])(i);b.timeSeriesScroll=y,b.timeSeriesScrollWheel=z,b.timeSeriesScrollTouchDrag=A},"./toolOptions.js":function(a,b,c){"use strict";function d(a,b){if(!i[a])return{};var c=i[a],d=c.find(function(a){return a.element===b});return d?d.options:{}}function e(a,b,c){if(!i[a])return void(i[a]=[{element:b,options:c}]);var d=i[a],e=d.findIndex(function(a){return a.element===b});if(e===-1)i[a].push({element:b,options:c});else{var f=i[a][e].options||{};i[a][e].options=Object.assign(f,c)}}function f(a,b){var c=i[a];c&&(i[a]=c.filter(function(a){return a.element!==b}))}function g(a){delete i[a]}function h(a){for(var b in i)i[b]=i[b].filter(function(b){return b.element!==a})}Object.defineProperty(b,"__esModule",{value:!0});var i={};b.getToolOptions=d,b.setToolOptions=e,b.clearToolOptions=f,b.clearToolOptionsByToolType=g,b.clearToolOptionsByElement=h},"./util/calculateEllipseStatistics.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){for(var c=0,d=0,e=0,g=0,h=b.top;h<b.top+b.height;h++)for(var i=b.left;i<b.left+b.width;i++){var j={x:i,y:h};(0,f["default"])(b,j)&&(c+=a[g],d+=a[g]*a[g],e++),g++}if(0===e)return{count:e,mean:0,variance:0,stdDev:0};var k=c/e,l=d/e-k*k;return{count:e,mean:k,variance:l,stdDev:Math.sqrt(l)}};var e=c("./util/pointInEllipse.js"),f=d(e)},"./util/calculateSUV.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return parseFloat("."+a)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=g["default"].cornerstone,d=c.metaData.get("patientStudyModule",a.imageId),f=c.metaData.get("generalSeriesModule",a.imageId);if(d&&f){var h=f.modality;if("PT"===h){var i=b*a.slope+a.intercept,j=d.patientWeight;if(j){var k=c.metaData.get("petIsotopeModule",a.imageId);if(k){var l=k.radiopharmaceuticalInfo,m=l.radiopharmaceuticalStartTime,n=l.radionuclideTotalDose,o=l.radionuclideHalfLife,p=f.seriesTime;if(m&&n&&o&&p){var q=e(p.fractionalSeconds||0)+p.seconds+60*p.minutes+60*p.hours*60,r=e(m.fractionalSeconds)+m.seconds+60*m.minutes+60*m.hours*60,s=q-r,t=n*Math.exp(-s*Math.log(2)/o),u=i*j/t*1e3;return u}}}}}};var f=c("./externalModules.js"),g=d(f)},"./util/clip.js":function(a,b,c){"use strict";function d(a,b,c){return Math.min(Math.max(b,a),c)}function e(a,b){a.x=d(a.x,0,b.width),a.y=d(a.y,0,b.height)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d,b.clipToBox=e},"./util/convertToVector3.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=g["default"].cornerstoneMath;return a instanceof b.Vector3?a:new b.Vector3(a[0],a[1],a[2])}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./externalModules.js"),g=d(f)},"./util/copyPoints.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a){var b=f["default"].cornerstoneMath.point.copy(a.page),c=f["default"].cornerstoneMath.point.copy(a.image),d=f["default"].cornerstoneMath.point.copy(a.client),e=f["default"].cornerstoneMath.point.copy(a.canvas);return{page:b,image:c,client:d,canvas:e}};var e=c("./externalModules.js"),f=d(e)},"./util/drawArrow.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,e,f){var g=10,h=Math.atan2(c.y-b.y,c.x-b.x),i={color:e,lineWidth:f};(0,d.drawLine)(a,void 0,b,c,i,"canvas"),i={color:e,lineWidth:f,fillStyle:e};var j=[{x:c.x-g*Math.cos(h-Math.PI/7),y:c.y-g*Math.sin(h-Math.PI/7)},{x:c.x-g*Math.cos(h+Math.PI/7),y:c.y-g*Math.sin(h+Math.PI/7)},c];(0,d.drawJoinedLines)(a,void 0,c,j,i,"canvas")};var d=c("./util/drawing.js")},"./util/drawCircle.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,e){var f=handleRadiusComm,g={color:c,lineWidth:e};(0,d.drawCircle)(a,void 0,b,f,g,"canvas")};var d=c("./util/drawing.js")},"./util/drawEllipse.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,e,f){var g={x:b,y:c},h={x:b+e,y:c+f};(0,d.drawEllipse)(a,void 0,g,h,{},"canvas")};var d=c("./util/drawing.js")},"./util/drawLink.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e,h){var i=a.length>0?f["default"].cornerstoneMath.point.findClosestPoint(a,b):b,j=[{x:c.left+c.width/2,y:c.top},{x:c.left,y:c.top+c.height/2},{x:c.left+c.width/2,y:c.top+c.height},{x:c.left+c.width,y:c.top+c.height/2}],k=f["default"].cornerstoneMath.point.findClosestPoint(j,i),l={color:e,lineWidth:h,lineDash:[2,3]};(0,g.drawLine)(d,void 0,i,k,l,"canvas")};var e=c("./externalModules.js"),f=d(e),g=c("./util/drawing.js")},"./util/drawLinkedTextBox.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e,g,i,k,l,m){var n=f["default"].cornerstone,o=n.pixelToCanvas(b,c);l&&(o.x+=l);var p={centering:{x:!1,y:m}};if(c.boundingBox=(0,h["default"])(a,d,o.x,o.y,i,p),c.hasMoved){var q=g(e).map(function(a){return n.pixelToCanvas(b,a)});(0,j["default"])(q,o,c.boundingBox,a,i,k)}};var e=c("./externalModules.js"),f=d(e),g=c("./util/drawTextBox.js"),h=d(g),i=c("./util/drawLink.js"),j=d(i)},"./util/drawTextBox.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=g["default"].getFont(),e=a.font;d&&d!==e&&(a.font=d);var f=a.measureText(b).width;return d&&d!==e&&(a.font=e),f+2*c}Object.defineProperty(b,"__esModule",{value:!0}),b.textBoxWidth=e,b["default"]=function(a,b,c,d,f,i){"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]);var j=5,k=g["default"].getFontSize(),l=(g["default"].getBackgroundColor(),0);b.forEach(function(b){var c=e(a,b,j);l=Math.max(l,c)});var m={width:l,height:j+b.length*(k+j)};return(0,h.draw)(a,function(a){a.strokeStyle=f,i&&i.centering&&i.centering.x===!0&&(c-=m.width/2),i&&i.centering&&i.centering.y===!0&&(d-=m.height/2),m.left=c,m.top=d;var e="rgba(0,0,0,0.5)";(0,h.fillBox)(a,m,e),(0,h.fillTextLines)(a,m,b,f,j)}),m};var f=c("./stateManagement/textStyle.js"),g=d(f),h=c("./util/drawing.js")},"./util/drawing.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.getContext("2d");return b.setTransform(1,0,0,1,0,0),b}function f(a,b){a.save(),b(a),a.restore()}function g(a,b,c){var d=b.color,e=b.lineWidth,f=b.fillStyle,g=b.lineDash;a.beginPath(),a.strokeStyle=d||a.strokeStyle,a.lineWidth=e||void 0===e&&v["default"].getToolWidth()||a.lineWidth,g&&a.setLineDash(g),c(a),f&&(a.fillStyle=f,a.fill()),a.stroke(),g&&a.setLineDash([])}function h(a,b){b.shadow&&(a.shadowColor=(0,t.getDefault)(b.shadowColor,"#000000"),a.shadowBlur=(0,t.getDefault)(b.shadowBlur,0),a.shadowOffsetX=(0,t.getDefault)(b.shadowOffsetX,1),a.shadowOffsetY=(0,t.getDefault)(b.shadowOffsetY,1))}function i(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";g(a,e,function(a){if("pixel"===f){var e=s["default"].cornerstone;c=e.pixelToCanvas(b,c),d=e.pixelToCanvas(b,d)}a.moveTo(c.x,c.y),a.lineTo(d.x,d.y)})}function j(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";g(a,d,function(a){c.forEach(function(c){var d=c.start,f=c.end;if("pixel"===e){var g=s["default"].cornerstone;d=g.pixelToCanvas(b,d),f=g.pixelToCanvas(b,f)}a.moveTo(d.x,d.y),a.lineTo(f.x,f.y)})})}function k(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";g(a,e,function(a){if("pixel"===f){var e=s["default"].cornerstone;c=e.pixelToCanvas(b,c),d=d.map(function(a){return e.pixelToCanvas(b,a)})}a.moveTo(c.x,c.y),d.forEach(function(b){var c=b.x,d=b.y;a.lineTo(c,d)})})}function l(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";"pixel"===f&&(c=s["default"].cornerstone.pixelToCanvas(b,c)),g(a,e,function(a){a.arc(c.x,c.y,d,0,2*Math.PI)})}function m(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";"pixel"===f&&(c=s["default"].cornerstone.pixelToCanvas(b,c),d=s["default"].cornerstone.pixelToCanvas(b,d));var h=Math.min(c.x,d.x),i=Math.min(c.y,d.y),j=Math.abs(c.x-d.x),k=Math.abs(c.y-d.y),l=.5522848,m=j/2*l,n=k/2*l,o=h+j,p=i+k,q=h+j/2,r=i+k/2;g(a,e,function(a){a.moveTo(h,r),a.bezierCurveTo(h,r-n,q-m,i,q,i),a.bezierCurveTo(q+m,i,o,r-n,o,r),a.bezierCurveTo(o,r+n,q+m,p,q,p),a.bezierCurveTo(q-m,p,h,r+n,h,r),a.closePath()})}function n(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===f){var h=s["default"].cornerstone;c=h.pixelToCanvas(b,c),d=h.pixelToCanvas(b,d)}var i=Math.min(c.x,d.x),j=Math.min(c.y,d.y),k=Math.abs(c.x-d.x),l=Math.abs(c.y-d.y);g(a,e,function(a){a.rect(i,j,k,l)})}function o(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===f){var h=s["default"].cornerstone;c=h.pixelToCanvas(b,c),d=h.pixelToCanvas(b,d)}var i=Math.min(c.x,d.x),j=Math.min(c.y,d.y),k=Math.abs(c.x-d.x),l=Math.abs(c.y-d.y);g(a,e,function(a){a.rect(0,0,a.canvas.clientWidth,a.canvas.clientHeight),a.rect(i+k,j,-k,l)})}function p(a,b,c){a.fillStyle=c,a.fillRect(b.left,b.top,b.width,b.height)}function q(a,b,c,d,e){var f=x["default"].getFontSize();a.font=x["default"].getFont(),a.textBaseline="top",a.fillStyle=d,c.forEach(function(c,d){a.fillText(c,b.left+e,b.top+e+d*(f+e))})}Object.defineProperty(b,"__esModule",{value:!0}),b.getNewContext=e,b.draw=f,b.path=g,b.setShadow=h,b.drawLine=i,b.drawLines=j,b.drawJoinedLines=k,b.drawCircle=l,b.drawEllipse=m,b.drawRect=n,b.fillOutsideRect=o,b.fillBox=p,b.fillTextLines=q;var r=c("./externalModules.js"),s=d(r),t=c("./util/getDefault.js"),u=c("./stateManagement/toolStyle.js"),v=d(u),w=c("./stateManagement/textStyle.js"),x=d(w)},"./util/freehand/ClickedLineData.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});b.ClickedLineData=function e(a,b){d(this,e),this.toolIndex=a,this.handleIndexArray=b}},"./util/freehand/FreehandHandleData.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});b.FreehandHandleData=function e(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];d(this,e),this.x=a.x,this.y=a.y,this.highlight=b,this.active=c,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0}),b.FreehandLineFinder=void 0;var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c("./stateManagement/toolState.js"),h=c("./externalModules.js"),i=d(h),j=c("./util/freehand/ClickedLineData.js"),k="freehand",l=10;b.FreehandLineFinder=function(){function a(b){e(this,a),this._eventData=b}return f(a,[{key:"findLine",value:function(){var a=this.findTool();if(null===a)return null;var b=this._getCloseLinesInTool(a);if(b){var c=this._findCorrectLine(a,b);return c}return null}},{key:"findTool",value:function(){if(this._toolData=(0,g.getToolState)(this._eventData.element,k),this._mousePoint=this._eventData.currentPoints.canvas,!this._toolData)return null;var a=this._nearestHandleToPointAllTools();return a.toolIndex}},{key:"_nearestHandleToPointAllTools",value:function(){for(var a=this._toolData,b={toolIndex:null,handleIndex:null,distance:1/0},c=0;c<a.data.length;c++){var d=this._nearestHandleToPoint(c);null!==d&&d.distance<b.distance&&(b=d)}return b}},{key:"_nearestHandleToPoint",value:function(a){var b=this._eventData,c=this._toolData,d=c.data[a];if(void 0===d.handles)return null;if(d.visible===!1)return null;for(var e={toolIndex:a,handleIndex:null,distance:1/0},f=0;f<d.handles.length;f++){var g=i["default"].cornerstone.pixelToCanvas(b.element,d.handles[f]),h=i["default"].cornerstoneMath.point.distance(g,this._mousePoint);h<e.distance&&(e.handleIndex=f,e.distance=h)}return e}},{key:"_getCloseLinesInTool",value:function(b){for(var c=this._toolData,d=c.data[b].handles,e=[],f=0;f<d.length;f++){var g=a.getNextHandleIndex(f,d.length),h=this._distanceOfPointfromLine(d[f],d[g]);h<l&&e.push([f,g])}return e}},{key:"_findCorrectLine",value:function(a,b){for(var c=0;c<b.length;c++)if(this._pointProjectsToLineSegment(a,b[c]))return new j.ClickedLineData(a,b[c]);return null}},{key:"_pointProjectsToLineSegment",value:function(b,c){var d=this._eventData,e=this._toolData,f=e.data[b];if(void 0!==f.handles){if(f.visible===!1)return!1;var g=f.handles[c[0]],h=f.handles[c[1]],i=a.getCanvasPointsFromHandles(g,h,d.element),j=a.getLineAsVector(i),k=this._getLineOriginToMouseAsVector(i),l=(k[0]*j[0]+k[1]*j[1])/j.magnitude;return l>0&&l<j.magnitude}}},{key:"_getLineOriginToMouseAsVector",value:function(a){var b=[this._mousePoint.x-a[0].x,this._mousePoint.y-a[0].y];return b}},{key:"_distanceOfPointfromLine",value:function(a,b){var c=this._eventData,d=i["default"].cornerstone.pixelToCanvas(c.element,a),e=i["default"].cornerstone.pixelToCanvas(c.element,b),f=this._mousePoint,g=Math.abs((e.y-d.y)*f.x-(e.x-d.x)*f.y+e.x*d.y-e.y*d.x),h=i["default"].cornerstoneMath.point.distance(d,e),j=g/h;return j}}],[{key:"getCanvasPointsFromHandles",value:function(a,b,c){var d=[];return a.x<b.x?(d.push(i["default"].cornerstone.pixelToCanvas(c,a)),d.push(i["default"].cornerstone.pixelToCanvas(c,b))):(d.push(i["default"].cornerstone.pixelToCanvas(c,b)),d.push(i["default"].cornerstone.pixelToCanvas(c,a))),d}},{key:"getLineAsVector",value:function(a){var b=[a[1].x-a[0].x,a[1].y-a[0].y];return b.magnitude=i["default"].cornerstoneMath.point.distance(a[0],a[1]),b}},{key:"getNextHandleIndex",value:function(a,b){var c=void 0;return c=a<b-1?a+1:0}}]),a}()},"./util/freehand/Sculpter.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0}),b.Sculpter=void 0;var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c("./externalModules.js"),h=d(g),i=c("./imageTools/freehandSculpter.js"),j=c("./util/freehand/FreehandHandleData.js"),k=c("./util/clip.js");b.Sculpter=function(){function a(){e(this,a)}return f(a,[{key:"sculpt",value:function(a,b){this._setData(a,b),this._pushHandles(),this._insertNewHandles(),this._consolidateHandles()}},{key:"_setData",value:function(a,b){var c=i.freehandSculpter.getConfiguration();this._eventData=a,this._element=a.element,this._image=a.image,this._mousePoint=a.currentPoints.image,this._dataHandles=b,this._toolSize=c.toolSizeImage,this._minSpacing=c.minSpacing,this._maxSpacing=c.maxSpacing}},{key:"_pushHandles",value:function(){for(var a=this._dataHandles,b=this._mousePoint,c=this._toolSize,d=0;d<a.length;d++){var e=h["default"].cornerstoneMath.point.distance(a[d],b);e<c&&this._pushOneHandle(d,e)}}},{key:"_pushOneHandle",value:function(b,c){var d=this._dataHandles,e=d[b],f=this._mousePoint,g=this._toolSize,h={x:(e.x-f.x)/c,y:(e.y-f.y)/c},i={x:f.x+g*h.x,y:f.y+g*h.y};(0,k.clipToBox)(i,this._image),e.x=i.x,e.y=i.y;var j=a.getPreviousHandleIndex(b,d.length);d[j].lines.pop(),d[j].lines.push(e)}},{key:"_insertNewHandles",value:function(){for(var a=this._findNewHandleIndicies(),b=0,c=0;c<a.length;c++){var d=a[c]+1+b;this._insertHandleRadially(d),b++}}},{key:"_findNewHandleIndicies",value:function(){for(var b=this._dataHandles,c=[],d=0;d<b.length;d++){var e=h["default"].cornerstone.pixelToCanvas(this._element,b[d]),f=a.getNextHandleIndex(d,b.length),g=h["default"].cornerstone.pixelToCanvas(this._element,b[f]),i=h["default"].cornerstoneMath.point.distance(e,g);i>this._maxSpacing&&c.push(d)}return c}},{key:"_insertHandleRadially",value:function(b){var c=this._dataHandles,d=b-1,e=a.getNextHandleIndexBeforeInsert(b,c.length),f=this._getInsertPosition(b,d,e),g=new j.FreehandHandleData(f);c.splice(b,0,g),c[d].lines.pop(),c[d].lines.push(c[b]),b===c.length-1?c[b].lines.push(c[0]):c[b].lines.push(c[b+1])}},{key:"_getInsertPosition",value:function(a,b,c){var d=this._toolSize,e=this._mousePoint,f=this._dataHandles,g={x:(f[b].x+f[c].x)/2,y:(f[b].y+f[c].y)/2},i=h["default"].cornerstoneMath.point.distance(e,g),j=void 0;if(i<d){var l={x:(g.x-e.x)/i,y:(g.y-e.y)/i};j={x:e.x+d*l.x,y:e.y+d*l.y}}else j=g;return(0,k.clipToBox)(j,this._image),j}},{key:"_consolidateHandles",value:function(){if(this._dataHandles.length>3){var a=this._findCloseHandlePairs();this._mergeCloseHandles(a)}}},{key:"_mergeCloseHandles",value:function(b){for(var c=0,d=0;d<b.length;d++){var e=a.getCorrectedPair(b[d],c);this._combineHandles(e),c++}var f=this._findCloseHandlePairs();f.length&&this._mergeCloseHandles(f)}},{key:"_findCloseHandlePairs",value:function(){for(var b=this._dataHandles,c=this._element,d=[],e=b.length,f=0;f<e;f++){var g=h["default"].cornerstone.pixelToCanvas(c,b[f]),i=a.getNextHandleIndex(f,b.length),j=h["default"].cornerstone.pixelToCanvas(c,b[i]),k=h["default"].cornerstoneMath.point.distance(g,j);if(k<this._minSpacing){var l=[f,i];d.push(l),0===f&&(e-=1),f++}}return d}},{key:"_combineHandles",value:function(b){var c=this._dataHandles,d={x:(c[b[0]].x+c[b[1]].x)/2,y:(c[b[0]].y+c[b[1]].y)/2};(0,k.clipToBox)(d,this._image),c[b[0]].x=d.x,c[b[0]].y=d.y;var e=a.getNextHandleIndex(b[1],c.length);c[b[0]].lines.pop(),c[b[0]].lines.push(c[e]),c.splice(b[1],1)}}],[{key:"getNextHandleIndex",value:function(a,b){return a===b-1?0:a+1}},{key:"getNextHandleIndexBeforeInsert",value:function(a,b){return a===b?0:a}},{key:"getPreviousHandleIndex",value:function(a,b){return 0===a?b-1:a-1}},{key:"getCorrectedPair",value:function(a,b){var c=[a[0]-b,a[1]-b];return c[1]<0&&(c[1]=0),c}}]),a}()},"./util/freehand/calculateFreehandStatistics.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){for(var d={value:0,squared:0,count:0},e=0,g=b.top;g<b.top+b.height;g++)for(var h=b.left;h<b.left+b.width;h++){var i={x:h,y:g};f(c,i,d,a[e]),e++}return d}function f(a,b,c,d){(0,h["default"])(a,b)&&(c.value+=d,c.squared+=d*d,c.count++)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){var d={count:0,mean:0,variance:0,stdDev:0},f=e(a,b,c);return 0===f.count?d:(d.count=f.count,d.mean=f.value/f.count,d.variance=f.squared/f.count-d.mean*d.mean,d.stdDev=Math.sqrt(d.variance),d)};var g=c("./util/freehand/pointInFreehand.js"),h=d(g)},"./util/freehand/dragObject.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=g.freehand.getConfiguration();a.hasMoved=!0,a.x=b.mouseLocation.handles.start.x,a.y=b.mouseLocation.handles.start.y}function f(a,b){var c=g.freehand.getConfiguration();if(b.handles.invalidHandlePlacement=i["default"].modify(b.handles,a),b.active=!0,b.highlight=!0,b.handles[a].x=c.mouseLocation.handles.start.x,b.handles[a].y=c.mouseLocation.handles.start.y,a){var d=b.handles[a-1].lines.length-1,e=b.handles[a-1].lines[d];e.x=c.mouseLocation.handles.start.x,e.y=c.mouseLocation.handles.start.y}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=g.freehand.getConfiguration();c.movingTextBox&&e(a),c.modifying&&f(a,b)};var g=c("./imageTools/freehand.js"),h=c("./util/freehand/freeHandIntersect.js"),i=d(h)},"./util/freehand/dropObject.js":function(a,b,c){"use strict";function d(a,b){var c=f.freehand.getConfiguration();c.movingTextBox=!1,b.data[c.currentTool].invalidated=!0,c.currentHandle=0,c.currentTool=-1}function e(a,b){var c=f.freehand.getConfiguration(),d=c.currentTool,e=b.data[d].handles;if(e.invalidHandlePlacement){var g=c.currentHandle,h=e[g],i=void 0;if(0===g){var j=e.length-1;i=e[j]}else i=e[g-1];h.x=c.dragOrigin.x,h.y=c.dragOrigin.y,i.lines[0]=h,e.invalidHandlePlacement=!1}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=a.detail,g=f.freehand.getConfiguration();return g.movingTextBox===!0?(d(c,b),
"textBox"):g.modifying?(e(c,b),"handle"):null};var f=c("./imageTools/freehand.js")},"./util/freehand/freeHandArea.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=0,d=a.length-1;b=b||1;for(var e=0;e<a.length;e++)c+=(a[d].x+a[e].x)*(a[d].y-a[e].y),d=e;return Math.abs(c*b/2)}},"./util/freehand/freeHandIntersect.js":function(a,b,c){"use strict";function d(a,b){var c=b.length-1,d=i(b[c]),e=i(a);return g(b,d,e,[c])}function e(a){var b=a.length-1,c=i(a[b]),d=i(a[0]);return g(a,c,d,[b,0])}function f(a,b){var c=i(a[b]),d=b-1;0===b&&(d=a.length-1);var e=i(a[d]);return!!g(a,c,e,[b,d])||(d=b===a.length-1?0:b+1,e=i(a[d]),g(a,c,e,[b,d]))}function g(a,b,c,d){for(var e=a.length-1,f=0;f<a.length;f++)if(d.indexOf(f)===-1&&d.indexOf(e)===-1){var g=i(a[e]),j=i(a[f]);if(h(b,c,g,j))return!0;e=f}else e=f;return!1}function h(a,b,c,d){var e=!1,f=[j(a,b,c),j(a,b,d),j(c,d,a),j(c,d,b)];return f[0]!==f[1]&&f[2]!==f[3]||(0===f[0]&&k(a,c,b)?e=!0:0===f[1]&&k(a,d,b)?e=!0:0===f[2]&&k(c,a,d)?e=!0:0===f[3]&&k(c,b,d)&&(e=!0),e)}function i(a){return{x:a.x,y:a.y}}function j(a,b,c){var d=(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y);return 0===d?0:d>0?1:2}function k(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}Object.defineProperty(b,"__esModule",{value:!0});var l={newHandle:d,end:e,modify:f};b["default"]=l},"./util/freehand/insertOrDelete.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){var c=(0,j.getToolState)(a.element,m);if(void 0!==c){var d=b.handleIndex,e=b.toolIndex,f=c.data[e];f.handles.length<=3||(d===f.handles.length-1?(f.handles[d-1].lines.pop(),f.handles[d-1].lines.push(f.handles[0])):0===d?(f.handles[f.handles.length-1].lines.pop(),f.handles[f.handles.length-1].lines.push(f.handles[d+1])):(f.handles[d-1].lines.pop(),f.handles[d-1].lines.push(f.handles[d+1])),f.handles.splice(d,1),f.invalidated=!0,f.active=!0,f.highlight=!0,l["default"].cornerstone.updateImage(a.element))}}function f(a,b){var c=(0,j.getToolState)(a.element,m);if(void 0!==c){var d=c.data[b.toolIndex],e=g(b);if(e!==1/0){var f=new i.FreehandHandleData(a.currentPoints.image);d.handles.splice(e,0,f),d.handles[e-1].lines.pop(),d.handles[e-1].lines.push(a.currentPoints.image),e===d.handles.length-1?d.handles[e].lines.push(d.handles[0]):d.handles[e].lines.push(d.handles[e+1]),d.active=!0,d.highlight=!0,d.invalidated=!0,l["default"].cornerstone.updateImage(a.element)}}}function g(a){for(var b=a.handleIndexArray,c=1/0,d=b.includes(0),e=0;e<b.length;e++){var f=b[e];0!==f&&f<c&&(c=f)}return d&&1===c&&(c=0),c++,c}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=a.detail;if(b&&null!==b.handleNearby){var d={toolIndex:b.toolIndex,handleIndex:b.handleNearby};e(c,d)}else{var g=new h.FreehandLineFinder(c),i=g.findLine();i&&f(c,i)}a.preventDefault(),a.stopPropagation()};var h=c("./util/freehand/FreehandLineFinder.js"),i=c("./util/freehand/FreehandHandleData.js"),j=c("./stateManagement/toolState.js"),k=c("./externalModules.js"),l=d(k),m="freehand"},"./util/freehand/keysHeld.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){var b=a.detail,c=i.freehand.getConfiguration(),d=b.keyCode,e=!1;d===j.CTRL&&(c.keyDown.ctrl=!0,e=!0),d===j.SHIFT&&(c.keyDown.shift=!0),d===j.ALT&&(c.keyDown.alt=!0),e&&h["default"].cornerstone.updateImage(b.element)}function f(a){var b=a.detail,c=i.freehand.getConfiguration(),d=b.keyCode,e=!1;d===j.CTRL&&(c.keyDown.ctrl=!1,e=!0),d===j.SHIFT&&(c.keyDown.shift=!1),d===j.ALT&&(c.keyDown.alt=!1),e&&h["default"].cornerstone.updateImage(b.element)}Object.defineProperty(b,"__esModule",{value:!0}),b.keyDownCallback=e,b.keyUpCallback=f;var g=c("./externalModules.js"),h=d(g),i=c("./imageTools/freehand.js"),j={SHIFT:16,CTRL:17,ALT:18}},"./util/freehand/pointInFreehand.js":function(a,b,c){"use strict";function d(a,b,c){return b<a&&a<c||c<a&&a<b}function e(a,b,c){if(b.x>a.x&&c.x>a.x)return!0;if(b.x===c.x)return a.x<b.x;if(b.x>c.x){var d=b;b=c,c=d}var e=f(a,b,c);return Math.sign(e.gradient)*a.y>e.value}function f(a,b,c){var d=(c.y-b.y)/(c.x-b.x),e={value:b.x+d*(a.x-b.x),gradient:d};return e}function g(a,b,c){return!(!d(a.y,b.y,c.y)||!e(a,b,c))}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){for(var c=!1,d=a.length-1,e=0;e<a.length;e++)g(b,a[e],a[d])&&(c=!c),d=e;return c}},"./util/getDefault.js":function(a,b,c){"use strict";function d(a,b){return void 0!==a?a:b}Object.defineProperty(b,"__esModule",{value:!0}),b.getDefault=d},"./util/getLuminance.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e){if(!a)throw new Error("getLuminance: parameter element must not be undefined");b=Math.round(b),c=Math.round(c);var g=f["default"].cornerstone.getEnabledElement(a),h=g.image,i=[],j=0,k=h.getPixelData(),l=void 0,m=void 0,n=void 0;if(h.color)for(m=0;m<e;m++)for(n=0;n<d;n++){l=4*((m+c)*h.columns+(n+b));var o=k[l],p=k[l+1],q=k[l+2];i[j++]=.2126*o+.7152*p+.0722*q}else for(m=0;m<e;m++)for(n=0;n<d;n++)l=(m+c)*h.columns+(n+b),i[j++]=k[l]*h.slope+h.intercept;return i};var e=c("./externalModules.js"),f=d(e)},"./util/getMaxSimultaneousRequests.js":function(a,b,c){"use strict";function d(){var a=navigator.userAgent,b=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],c=void 0;return/trident/i.test(b[1])?(c=/\brv[ :]+(\d+)/g.exec(a)||[],"IE "+(c[1]||"")):"Chrome"===b[1]&&(c=a.match(/\b(OPR|Edge)\/(\d+)/),null!==c)?c.slice(1).join(" ").replace("OPR","Opera"):(b=b[2]?[b[1],b[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(c=a.match(/version\/(\d+)/i))&&b.splice(1,1,c[1]),b.join(" "))}function e(a){i=a}function f(){return i?i:g()}function g(){var a=d(),b=a.split(" "),c=b[0],e=b[1],f=j[c];return f?f[e]?f[e]:f["default"]:j["default"]}function h(){var a=new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini");return a.test(navigator.userAgent)}Object.defineProperty(b,"__esModule",{value:!0});var i=void 0,j={"default":6,IE:{9:6,10:8,"default":8},Firefox:{"default":6},Opera:{10:8,11:6,12:6,"default":6},Chrome:{"default":6},Safari:{"default":6}};b.getDefaultSimultaneousRequests=g,b.getMaxSimultaneousRequests=f,b.setMaxSimultaneousRequests=e,b.getBrowserInfo=d,b.isMobileDevice=h},"./util/getRGBPixels.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d,e){if(!a)throw new Error("getRGBPixels: parameter element must not be undefined");b=Math.round(b),c=Math.round(c);var g=f["default"].cornerstone.getEnabledElement(a),h=[],i=0,j=g.image.getPixelData(),k=void 0,l=void 0,m=void 0;if(g.image.color)for(l=0;l<e;l++)for(m=0;m<d;m++){k=4*((l+c)*g.image.columns+(m+b));var n=j[k],o=j[k+1],p=j[k+2],q=j[k+3];h[i++]=n,h[i++]=o,h[i++]=p,h[i++]=q}return h};var e=c("./externalModules.js"),f=d(e)},"./util/isMouseButtonEnabled.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=1<<a-1;return 0!==(b&c)}},"./util/lineSegDistance.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c,d){var e=f["default"].cornerstone,g={start:e.pixelToCanvas(a,b),end:e.pixelToCanvas(a,c)};return f["default"].cornerstoneMath.lineSegment.distanceToPoint(g,d)};var e=c("./externalModules.js"),f=d(e)},"./util/makeUnselectable.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){a.style.webkitUserSelect="none",a.style.webkitTouchCallout="none",a.style.mozUserSelect="none",a.style.msUserSelect="none",a.style.oUserSelect="none",a.style.khtmlUserSelect="none",a.style.userSelect="none",a.unselectable="on",a.oncontextmenu=function(){return!1},b===!0&&(a.style.pointerEvents="none")}},"./util/pointInEllipse.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=a.width/2,d=a.height/2;if(c<=0||d<=0)return!1;var e={x:a.left+c,y:a.top+d},f={x:b.x-e.x,y:b.y-e.y},g=f.x*f.x/(c*c)+f.y*f.y/(d*d)<=1;return g}},"./util/pointInsideBoundingBox.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){if(a.boundingBox)return f["default"].cornerstoneMath.point.insideRect(b,a.boundingBox)};var e=c("./externalModules.js"),f=d(e)},"./util/pointProjector.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){var c=(0,m["default"])(b.rowCosines),d=(0,m["default"])(b.columnCosines),e=(0,m["default"])(b.imagePositionPatient),f=a.clone().sub(e),g=c.dot(f)/b.columnPixelSpacing,h=d.dot(f)/b.rowPixelSpacing;return{x:g,y:h}}function f(a,b){var c=(0,m["default"])(b.rowCosines),d=(0,m["default"])(b.columnCosines),e=(0,m["default"])(b.imagePositionPatient),f=c.clone().multiplyScalar(a.x);f.multiplyScalar(b.columnPixelSpacing||1);var g=d.clone().multiplyScalar(a.y);g.multiplyScalar(b.rowPixelSpacing||1);var h=f.add(g);return h.add(e),h}function g(a){var b=f({x:0,y:0},a),c=f({x:a.columns,y:0},a),d=f({x:0,y:a.rows},a),e=f({x:a.columns,y:a.rows},a),g={top:new k["default"].cornerstoneMath.Line3(b,c),left:new k["default"].cornerstoneMath.Line3(b,d),right:new k["default"].cornerstoneMath.Line3(c,e),bottom:new k["default"].cornerstoneMath.Line3(d,e)};return g}function h(a,b){var c=[];return Object.keys(b).forEach(function(d){var e=b[d],f=a.intersectLine(e);f&&c.push(f)}),c}function i(a,b){var c=(0,m["default"])(a.rowCosines),d=(0,m["default"])(a.columnCosines),e=(0,m["default"])(a.imagePositionPatient),i=(0,m["default"])(b.rowCosines),j=(0,m["default"])(b.columnCosines),l=(0,m["default"])(b.imagePositionPatient),n=c.clone().cross(d),o=new k["default"].cornerstoneMath.Plane;o.setFromNormalAndCoplanarPoint(n,e);var p=i.clone().cross(j),q=new k["default"].cornerstoneMath.Plane;q.setFromNormalAndCoplanarPoint(p,l);var r=q.clone().intersectPlane(o),s=r.origin,t=r.direction,u=f({x:b.columns,y:b.rows},b),v=l.distanceTo(u),w=new k["default"].cornerstoneMath.Line3;w.start=s,w.end=s.clone().add(t.multiplyScalar(v));var x=g(b),y=h(w,x);if(2===y.length)return{start:y[0],end:y[1]}}Object.defineProperty(b,"__esModule",{value:!0}),b.projectPatientPointToImagePlane=e,b.imagePointToPatientPoint=f,b.planePlaneIntersection=i;var j=c("./externalModules.js"),k=d(j),l=c("./util/convertToVector3.js"),m=d(l)},"./util/roundToDecimal.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}},"./util/scroll.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){if(a.pending[0]===b){if(a.currentImageIdIndex===b.index)return a.pending.splice(a.pending.indexOf(b),1),void(a.pending.length>0&&e(a,a.pending[0],c));var d=function f(d){var g=a.imageIds.indexOf(d.detail.image.imageId);g===b.index&&(a.pending.splice(a.pending.indexOf(b),1),c.removeEventListener(external.cornerstone.EVENTS.NEW_IMAGE,f),a.pending.length>0&&e(a,a.pending[0],c))};c.addEventListener(external.cornerstone.EVENTS.NEW_IMAGE,d),(0,g["default"])(c,b.index)}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],f=(0,h.getToolState)(a,"stack");if(f&&f.data&&f.data.length){var i=f.data[0];i.pending||(i.pending=[]);var k=i.currentImageIdIndex+b;if(c){var l=i.imageIds.length;k%=l}else k=(0,j["default"])(k,0,i.imageIds.length-1);if(d)(0,g["default"])(a,k);else{var m={index:k};i.pending.push(m),e(i,m,a)}}};var f=c("./util/scrollToIndex.js"),g=d(f),h=c("./stateManagement/toolState.js"),i=c("./util/clip.js"),j=d(i)},"./util/scrollToIndex.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b){function c(c){if(n.currentImageIdIndex===b){try{g.getEnabledElement(a)}catch(d){return}j?(j.currentImageIdIndex=b,j.render(a,e.data)):g.displayImage(a,c),q&&q(a,c)}}function d(c){var d=n.imageIds[b];r&&r(a,d,c)}var e=(0,i.getToolState)(a,"stack");if(e&&e.data&&e.data.length){var g=h["default"].cornerstone,j=void 0;if(e.data.length>1){var l=(0,i.getToolState)(a,"stackRenderer");l&&l.data&&l.data.length&&(j=l.data[0])}var n=e.data[0];b<0&&(b+=n.imageIds.length);var p=m["default"].getStartLoadHandler(),q=m["default"].getEndLoadHandler(),r=m["default"].getErrorLoadingHandler();if(b!==n.currentImageIdIndex){p&&p(a);var s={newImageIdIndex:b,direction:b-n.currentImageIdIndex};n.currentImageIdIndex=b;var t=n.imageIds[b],u=Boolean(n.preventCache),v=void 0;v=u?g.loadImage(t):g.loadAndCacheImage(t),v.then(c,d),k["default"].startGrabbing(),(0,o["default"])(a,f["default"].STACK_SCROLL,s)}}};var e=c("./events.js"),f=d(e),g=c("./externalModules.js"),h=d(g),i=c("./stateManagement/toolState.js"),j=c("./requestPool/requestPoolManager.js"),k=d(j),l=c("./stateManagement/loadHandlerManager.js"),m=d(l),n=c("./util/triggerEvent.js"),o=d(n)},"./util/setContextToDisplayFontSize.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(a,b,c){var d=.1;f["default"].cornerstone.setToPixelCoordinateSystem(a,b,d);var e=c/a.viewport.scale/d,g=c/a.viewport.scale/d;return{fontSize:e,lineHeight:g,fontScale:d}};var e=c("./externalModules.js"),f=d(e)},"./util/triggerEvent.js":function(a,b,c){"use strict";function d(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=void 0;return"function"==typeof window.CustomEvent?d=new CustomEvent(b,{detail:c,cancelable:!0}):(d=document.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c)),a.dispatchEvent(d)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d},"./version.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]="2.4.0"}})}),function(a,b,c){"use strict";function d(a){return _.find(j,function(b){return b.wid==a.winId&&b.suid==a.suid})}function e(a){for(var b=0;b<j.length;b++)j[b].wid==a.winId&&j[b].suid==a.suid&&j.splice(b,1)}function f(a,b){j.push({wid:a.winId,suid:a.suid,data:[b]})}function g(a,c){var d=a.stack.currentImageIdIndex+c;d>=a.stack.imageIds.length?d=0:d<0&&(d=a.stack.imageIds.length-1);var e=b.loadImage(a.stack.imageIds[d]),f=a.element,g=b.getViewport(f);e.then(function(c){a.stack.currentImageIdIndex!==d&&(a.stack.currentImageIdIndex=d,b.displayImage(f,c,g))},function(a){console.error(a)})}function h(a,b){if(a.wrappers=[],a.wrappers.push(a),void 0===a)throw"play: win must not be undefined";void 0===b&&(b=100);var c,h=d(a);if(void 0===h||0===h.data.length||h.data.length!=a.wrappers.length){void 0===h||0===h.data.length||(i(a),e(a));for(var j=[],k=0;k<a.wrappers.length;k++)a.wrappers[k].stack.imageIds.length>0&&j.push(a.wrappers[k]);c={intervalId:void 0,framesPerSecond:b,lastFrameTimeStamp:void 0,frameRate:0,wraps:j},f(a,c)}else c=h.data[0],c.framesPerSecond=b;void 0===c.intervalId&&(c.intervalId=setInterval(function(){if(c.framesPerSecond>0)for(var a=0;a<c.wraps.length;a++)g(c.wraps[a],1);else for(var a=0;a<c.wraps.length;a++)g(c.wraps[a],-1)},1e3/Math.abs(c.framesPerSecond)))}function i(a){var b,c=d(a);void 0!==c&&0!==c.data.length&&(b=c.data[0],clearInterval(b.intervalId),b.intervalId=void 0)}var j=[];c.diy={winPlayClip:h,winStopClip:i}}($,cornerstone,cornerstoneTools),function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define("dicom-parser",[],b):"object"==typeof exports?exports["dicom-parser"]=b():a.dicomParser=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.r=function(a){Object.defineProperty(a,"__esModule",{value:!0})},b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s="./index.js")}({"../node_modules/assert/assert.js":function(a,b,c){"use strict";(function(b){function d(a,b){if(a===b)return 0;for(var c=a.length,d=b.length,e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:d<c?1:0}function e(a){return b.Buffer&&"function"==typeof b.Buffer.isBuffer?b.Buffer.isBuffer(a):!(null==a||!a._isBuffer)}function f(a){return Object.prototype.toString.call(a)}function g(a){return!e(a)&&("function"==typeof b.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):!!a&&(a instanceof DataView||!!(a.buffer&&a.buffer instanceof ArrayBuffer))))}function h(a){if(u.isFunction(a)){if(x)return a.name;var b=a.toString(),c=b.match(z);return c&&c[1]}}function i(a,b){return"string"==typeof a?a.length<b?a:a.slice(0,b):a}function j(a){if(x||!u.isFunction(a))return u.inspect(a);var b=h(a),c=b?": "+b:"";return"[Function"+c+"]"}function k(a){return i(j(a.actual),128)+" "+a.operator+" "+i(j(a.expected),128)}function l(a,b,c,d,e){throw new y.AssertionError({message:c,actual:a,expected:b,operator:d,stackStartFunction:e})}function m(a,b){a||l(a,!0,b,"==",y.ok)}function n(a,b,c,h){if(a===b)return!0;if(e(a)&&e(b))return 0===d(a,b);if(u.isDate(a)&&u.isDate(b))return a.getTime()===b.getTime();if(u.isRegExp(a)&&u.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.lastIndex===b.lastIndex&&a.ignoreCase===b.ignoreCase;if(null!==a&&"object"==typeof a||null!==b&&"object"==typeof b){if(g(a)&&g(b)&&f(a)===f(b)&&!(a instanceof Float32Array||a instanceof Float64Array))return 0===d(new Uint8Array(a.buffer),new Uint8Array(b.buffer));if(e(a)!==e(b))return!1;h=h||{actual:[],expected:[]};var i=h.actual.indexOf(a);return i!==-1&&i===h.expected.indexOf(b)||(h.actual.push(a),h.expected.push(b),p(a,b,c,h))}return c?a===b:a==b}function o(a){return"[object Arguments]"==Object.prototype.toString.call(a)}function p(a,b,c,d){if(null===a||void 0===a||null===b||void 0===b)return!1;if(u.isPrimitive(a)||u.isPrimitive(b))return a===b;if(c&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var e=o(a),f=o(b);if(e&&!f||!e&&f)return!1;if(e)return a=w.call(a),b=w.call(b),n(a,b,c);var g,h,i=A(a),j=A(b);if(i.length!==j.length)return!1;for(i.sort(),j.sort(),h=i.length-1;h>=0;h--)if(i[h]!==j[h])return!1;for(h=i.length-1;h>=0;h--)if(g=i[h],!n(a[g],b[g],c,d))return!1;return!0}function q(a,b,c){n(a,b,!0)&&l(a,b,c,"notDeepStrictEqual",q)}function r(a,b){if(!a||!b)return!1;if("[object RegExp]"==Object.prototype.toString.call(b))return b.test(a);try{if(a instanceof b)return!0}catch(c){}return!Error.isPrototypeOf(b)&&b.call({},a)===!0}function s(a){var b;try{a()}catch(c){b=c}return b}function t(a,b,c,d){var e;if("function"!=typeof b)throw new TypeError('"block" argument must be a function');"string"==typeof c&&(d=c,c=null),e=s(b),d=(c&&c.name?" ("+c.name+").":".")+(d?" "+d:"."),a&&!e&&l(e,c,"Missing expected exception"+d);var f="string"==typeof d,g=!a&&u.isError(e),h=!a&&e&&!c;if((g&&f&&r(e,c)||h)&&l(e,c,"Got unwanted exception"+d),a&&e&&c&&!r(e,c)||!a&&e)throw e}var u=c("../node_modules/util/util.js"),v=Object.prototype.hasOwnProperty,w=Array.prototype.slice,x=function(){return"foo"===function(){}.name}(),y=a.exports=m,z=/\s*function\s+([^\(\s]*)\s*/;y.AssertionError=function(a){this.name="AssertionError",this.actual=a.actual,this.expected=a.expected,this.operator=a.operator,a.message?(this.message=a.message,this.generatedMessage=!1):(this.message=k(this),this.generatedMessage=!0);var b=a.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var c=new Error;if(c.stack){var d=c.stack,e=h(b),f=d.indexOf("\n"+e);if(f>=0){var g=d.indexOf("\n",f+1);d=d.substring(g+1)}this.stack=d}}},u.inherits(y.AssertionError,Error),y.fail=l,y.ok=m,y.equal=function(a,b,c){a!=b&&l(a,b,c,"==",y.equal)},y.notEqual=function(a,b,c){a==b&&l(a,b,c,"!=",y.notEqual)},y.deepEqual=function(a,b,c){n(a,b,!1)||l(a,b,c,"deepEqual",y.deepEqual)},y.deepStrictEqual=function(a,b,c){n(a,b,!0)||l(a,b,c,"deepStrictEqual",y.deepStrictEqual)},y.notDeepEqual=function(a,b,c){n(a,b,!1)&&l(a,b,c,"notDeepEqual",y.notDeepEqual)},y.notDeepStrictEqual=q,y.strictEqual=function(a,b,c){a!==b&&l(a,b,c,"===",y.strictEqual)},y.notStrictEqual=function(a,b,c){a===b&&l(a,b,c,"!==",y.notStrictEqual)},y["throws"]=function(a,b,c){t(!0,a,b,c)},y.doesNotThrow=function(a,b,c){t(!1,a,b,c)},y.ifError=function(a){if(a)throw a};var A=Object.keys||function(a){var b=[];for(var c in a)v.call(a,c)&&b.push(c);return b}}).call(this,c("../node_modules/webpack/buildin/global.js"))},"../node_modules/base64-js/index.js":function(a,b,c){"use strict";function d(a){var b=a.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===a[b-2]?2:"="===a[b-1]?1:0}function e(a){return 3*a.length/4-d(a)}function f(a){var b,c,e,f,g,h=a.length;f=d(a),g=new l(3*h/4-f),c=f>0?h-4:h;var i=0;for(b=0;b<c;b+=4)e=k[a.charCodeAt(b)]<<18|k[a.charCodeAt(b+1)]<<12|k[a.charCodeAt(b+2)]<<6|k[a.charCodeAt(b+3)],g[i++]=e>>16&255,g[i++]=e>>8&255,g[i++]=255&e;return 2===f?(e=k[a.charCodeAt(b)]<<2|k[a.charCodeAt(b+1)]>>4,g[i++]=255&e):1===f&&(e=k[a.charCodeAt(b)]<<10|k[a.charCodeAt(b+1)]<<4|k[a.charCodeAt(b+2)]>>2,g[i++]=e>>8&255,g[i++]=255&e),g}function g(a){return j[a>>18&63]+j[a>>12&63]+j[a>>6&63]+j[63&a]}function h(a,b,c){for(var d,e=[],f=b;f<c;f+=3)d=(a[f]<<16&16711680)+(a[f+1]<<8&65280)+(255&a[f+2]),e.push(g(d));return e.join("")}function i(a){for(var b,c=a.length,d=c%3,e="",f=[],g=16383,i=0,k=c-d;i<k;i+=g)f.push(h(a,i,i+g>k?k:i+g));return 1===d?(b=a[c-1],e+=j[b>>2],e+=j[b<<4&63],e+="=="):2===d&&(b=(a[c-2]<<8)+a[c-1],e+=j[b>>10],e+=j[b>>4&63],e+=j[b<<2&63],e+="="),f.push(e),f.join("")}b.byteLength=e,b.toByteArray=f,b.fromByteArray=i;for(var j=[],k=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=m.length;n<o;++n)j[n]=m[n],k[m.charCodeAt(n)]=n;k["-".charCodeAt(0)]=62,k["_".charCodeAt(0)]=63},"../node_modules/browserify-zlib/lib/binding.js":function(a,b,c){"use strict";(function(a,d){function e(a){if("number"!=typeof a||a<b.DEFLATE||a>b.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=a,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}var f=c("../node_modules/assert/assert.js"),g=c("../node_modules/pako/lib/zlib/zstream.js"),h=c("../node_modules/pako/lib/zlib/deflate.js"),i=c("../node_modules/pako/lib/zlib/inflate.js"),j=c("../node_modules/pako/lib/zlib/constants.js");for(var k in j)b[k]=j[k];b.NONE=0,b.DEFLATE=1,b.INFLATE=2,b.GZIP=3,b.GUNZIP=4,b.DEFLATERAW=5,b.INFLATERAW=6,b.UNZIP=7;var l=31,m=139;e.prototype.close=function(){return this.write_in_progress?void(this.pending_close=!0):(this.pending_close=!1,f(this.init_done,"close before init"),f(this.mode<=b.UNZIP),this.mode===b.DEFLATE||this.mode===b.GZIP||this.mode===b.DEFLATERAW?h.deflateEnd(this.strm):this.mode!==b.INFLATE&&this.mode!==b.GUNZIP&&this.mode!==b.INFLATERAW&&this.mode!==b.UNZIP||i.inflateEnd(this.strm),this.mode=b.NONE,void(this.dictionary=null))},e.prototype.write=function(a,b,c,d,e,f,g){return this._write(!0,a,b,c,d,e,f,g)},e.prototype.writeSync=function(a,b,c,d,e,f,g){return this._write(!1,a,b,c,d,e,f,g)},e.prototype._write=function(c,e,g,h,i,j,k,l){if(f.equal(arguments.length,8),f(this.init_done,"write before init"),f(this.mode!==b.NONE,"already finalized"),f.equal(!1,this.write_in_progress,"write already in progress"),f.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,f.equal(!1,void 0===e,"must provide flush value"),this.write_in_progress=!0,e!==b.Z_NO_FLUSH&&e!==b.Z_PARTIAL_FLUSH&&e!==b.Z_SYNC_FLUSH&&e!==b.Z_FULL_FLUSH&&e!==b.Z_FINISH&&e!==b.Z_BLOCK)throw new Error("Invalid flush value");if(null==g&&(g=a.alloc(0),i=0,h=0),this.strm.avail_in=i,this.strm.input=g,this.strm.next_in=h,this.strm.avail_out=l,this.strm.output=j,this.strm.next_out=k,this.flush=e,c){var m=this;return d.nextTick(function(){m._process(),m._after()}),this}if(this._process(),this._checkError())return this._afterSync()},e.prototype._afterSync=function(){var a=this.strm.avail_out,b=this.strm.avail_in;return this.write_in_progress=!1,[b,a]},e.prototype._process=function(){var a=null;switch(this.mode){case b.DEFLATE:case b.GZIP:case b.DEFLATERAW:this.err=h.deflate(this.strm,this.flush);break;case b.UNZIP:switch(this.strm.avail_in>0&&(a=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===a)break;if(this.strm.input[a]!==l){this.mode=b.INFLATE;break}if(this.gzip_id_bytes_read=1,a++,1===this.strm.avail_in)break;case 1:if(null===a)break;this.strm.input[a]===m?(this.gzip_id_bytes_read=2,this.mode=b.GUNZIP):this.mode=b.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case b.INFLATE:case b.GUNZIP:case b.INFLATERAW:for(this.err=i.inflate(this.strm,this.flush),this.err===b.Z_NEED_DICT&&this.dictionary&&(this.err=i.inflateSetDictionary(this.strm,this.dictionary),this.err===b.Z_OK?this.err=i.inflate(this.strm,this.flush):this.err===b.Z_DATA_ERROR&&(this.err=b.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===b.GUNZIP&&this.err===b.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=i.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},e.prototype._checkError=function(){switch(this.err){case b.Z_OK:case b.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===b.Z_FINISH)return this._error("unexpected end of file"),!1;break;case b.Z_STREAM_END:break;case b.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},e.prototype._after=function(){if(this._checkError()){var a=this.strm.avail_out,b=this.strm.avail_in;this.write_in_progress=!1,this.callback(b,a),this.pending_close&&this.close()}},e.prototype._error=function(a){this.strm.msg&&(a=this.strm.msg),this.onerror(a,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},e.prototype.init=function(a,c,d,e,g){f(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),f(a>=8&&a<=15,"invalid windowBits"),f(c>=-1&&c<=9,"invalid compression level"),f(d>=1&&d<=9,"invalid memlevel"),f(e===b.Z_FILTERED||e===b.Z_HUFFMAN_ONLY||e===b.Z_RLE||e===b.Z_FIXED||e===b.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(c,a,d,e,g),this._setDictionary()},e.prototype.params=function(){throw new Error("deflateParams Not supported")},e.prototype.reset=function(){this._reset(),this._setDictionary()},e.prototype._init=function(a,c,d,e,f){switch(this.level=a,this.windowBits=c,this.memLevel=d,this.strategy=e,this.flush=b.Z_NO_FLUSH,this.err=b.Z_OK,this.mode!==b.GZIP&&this.mode!==b.GUNZIP||(this.windowBits+=16),this.mode===b.UNZIP&&(this.windowBits+=32),this.mode!==b.DEFLATERAW&&this.mode!==b.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new g,this.mode){case b.DEFLATE:case b.GZIP:case b.DEFLATERAW:this.err=h.deflateInit2(this.strm,this.level,b.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case b.INFLATE:case b.GUNZIP:case b.INFLATERAW:case b.UNZIP:this.err=i.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==b.Z_OK&&this._error("Init error"),this.dictionary=f,this.write_in_progress=!1,this.init_done=!0},e.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=b.Z_OK,this.mode){case b.DEFLATE:case b.DEFLATERAW:this.err=h.deflateSetDictionary(this.strm,this.dictionary)}this.err!==b.Z_OK&&this._error("Failed to set dictionary")}},e.prototype._reset=function(){switch(this.err=b.Z_OK,this.mode){case b.DEFLATE:case b.DEFLATERAW:case b.GZIP:this.err=h.deflateReset(this.strm);break;case b.INFLATE:case b.INFLATERAW:case b.GUNZIP:this.err=i.inflateReset(this.strm)}this.err!==b.Z_OK&&this._error("Failed to reset stream")},b.Zlib=e}).call(this,c("../node_modules/buffer/index.js").Buffer,c("../node_modules/process/browser.js"))},"../node_modules/browserify-zlib/lib/index.js":function(a,b,c){"use strict";(function(a){function d(a,b,c){function d(){for(var b;null!==(b=a.read());)g.push(b),h+=b.length;a.once("readable",d)}function e(b){a.removeListener("end",f),a.removeListener("readable",d),c(b)}function f(){var b,d=null;h>=v?d=new RangeError(w):b=q.concat(g,h),g=[],a.close(),c(d,b)}var g=[],h=0;a.on("error",e),a.on("end",f),a.end(b),d()}function e(a,b){if("string"==typeof b&&(b=q.from(b)),!q.isBuffer(b))throw new TypeError("Not a string or buffer");var c=a._finishFlushFlag;return a._processChunk(b,c)}function f(a){return this instanceof f?void n.call(this,a,s.DEFLATE):new f(a)}function g(a){return this instanceof g?void n.call(this,a,s.INFLATE):new g(a)}function h(a){return this instanceof h?void n.call(this,a,s.GZIP):new h(a)}function i(a){return this instanceof i?void n.call(this,a,s.GUNZIP):new i(a)}function j(a){return this instanceof j?void n.call(this,a,s.DEFLATERAW):new j(a)}function k(a){return this instanceof k?void n.call(this,a,s.INFLATERAW):new k(a)}function l(a){return this instanceof l?void n.call(this,a,s.UNZIP):new l(a)}function m(a){return a===s.Z_NO_FLUSH||a===s.Z_PARTIAL_FLUSH||a===s.Z_SYNC_FLUSH||a===s.Z_FULL_FLUSH||a===s.Z_FINISH||a===s.Z_BLOCK}function n(a,c){var d=this;if(this._opts=a=a||{},this._chunkSize=a.chunkSize||b.Z_DEFAULT_CHUNK,r.call(this,a),a.flush&&!m(a.flush))throw new Error("Invalid flush flag: "+a.flush);if(a.finishFlush&&!m(a.finishFlush))throw new Error("Invalid flush flag: "+a.finishFlush);if(this._flushFlag=a.flush||s.Z_NO_FLUSH,this._finishFlushFlag="undefined"!=typeof a.finishFlush?a.finishFlush:s.Z_FINISH,a.chunkSize&&(a.chunkSize<b.Z_MIN_CHUNK||a.chunkSize>b.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+a.chunkSize);if(a.windowBits&&(a.windowBits<b.Z_MIN_WINDOWBITS||a.windowBits>b.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+a.windowBits);if(a.level&&(a.level<b.Z_MIN_LEVEL||a.level>b.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+a.level);if(a.memLevel&&(a.memLevel<b.Z_MIN_MEMLEVEL||a.memLevel>b.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+a.memLevel);if(a.strategy&&a.strategy!=b.Z_FILTERED&&a.strategy!=b.Z_HUFFMAN_ONLY&&a.strategy!=b.Z_RLE&&a.strategy!=b.Z_FIXED&&a.strategy!=b.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+a.strategy);if(a.dictionary&&!q.isBuffer(a.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new s.Zlib(c);var e=this;this._hadError=!1,this._handle.onerror=function(a,c){o(e),e._hadError=!0;var d=new Error(a);d.errno=c,d.code=b.codes[c],e.emit("error",d)};var f=b.Z_DEFAULT_COMPRESSION;"number"==typeof a.level&&(f=a.level);var g=b.Z_DEFAULT_STRATEGY;"number"==typeof a.strategy&&(g=a.strategy),this._handle.init(a.windowBits||b.Z_DEFAULT_WINDOWBITS,f,a.memLevel||b.Z_DEFAULT_MEMLEVEL,g,a.dictionary),this._buffer=q.allocUnsafe(this._chunkSize),this._offset=0,this._level=f,this._strategy=g,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!d._handle},configurable:!0,enumerable:!0})}function o(b,c){c&&a.nextTick(c),b._handle&&(b._handle.close(),b._handle=null)}function p(a){a.emit("close")}var q=c("../node_modules/buffer/index.js").Buffer,r=c("../node_modules/stream-browserify/index.js").Transform,s=c("../node_modules/browserify-zlib/lib/binding.js"),t=c("../node_modules/util/util.js"),u=c("../node_modules/assert/assert.js").ok,v=c("../node_modules/buffer/index.js").kMaxLength,w="Cannot create final Buffer. It would be larger than 0x"+v.toString(16)+" bytes";
s.Z_MIN_WINDOWBITS=8,s.Z_MAX_WINDOWBITS=15,s.Z_DEFAULT_WINDOWBITS=15,s.Z_MIN_CHUNK=64,s.Z_MAX_CHUNK=1/0,s.Z_DEFAULT_CHUNK=16384,s.Z_MIN_MEMLEVEL=1,s.Z_MAX_MEMLEVEL=9,s.Z_DEFAULT_MEMLEVEL=8,s.Z_MIN_LEVEL=-1,s.Z_MAX_LEVEL=9,s.Z_DEFAULT_LEVEL=s.Z_DEFAULT_COMPRESSION;for(var x=Object.keys(s),y=0;y<x.length;y++){var z=x[y];z.match(/^Z/)&&Object.defineProperty(b,z,{enumerable:!0,value:s[z],writable:!1})}for(var A={Z_OK:s.Z_OK,Z_STREAM_END:s.Z_STREAM_END,Z_NEED_DICT:s.Z_NEED_DICT,Z_ERRNO:s.Z_ERRNO,Z_STREAM_ERROR:s.Z_STREAM_ERROR,Z_DATA_ERROR:s.Z_DATA_ERROR,Z_MEM_ERROR:s.Z_MEM_ERROR,Z_BUF_ERROR:s.Z_BUF_ERROR,Z_VERSION_ERROR:s.Z_VERSION_ERROR},B=Object.keys(A),C=0;C<B.length;C++){var D=B[C];A[A[D]]=D}Object.defineProperty(b,"codes",{enumerable:!0,value:Object.freeze(A),writable:!1}),b.Deflate=f,b.Inflate=g,b.Gzip=h,b.Gunzip=i,b.DeflateRaw=j,b.InflateRaw=k,b.Unzip=l,b.createDeflate=function(a){return new f(a)},b.createInflate=function(a){return new g(a)},b.createDeflateRaw=function(a){return new j(a)},b.createInflateRaw=function(a){return new k(a)},b.createGzip=function(a){return new h(a)},b.createGunzip=function(a){return new i(a)},b.createUnzip=function(a){return new l(a)},b.deflate=function(a,b,c){return"function"==typeof b&&(c=b,b={}),d(new f(b),a,c)},b.deflateSync=function(a,b){return e(new f(b),a)},b.gzip=function(a,b,c){return"function"==typeof b&&(c=b,b={}),d(new h(b),a,c)},b.gzipSync=function(a,b){return e(new h(b),a)},b.deflateRaw=function(a,b,c){return"function"==typeof b&&(c=b,b={}),d(new j(b),a,c)},b.deflateRawSync=function(a,b){return e(new j(b),a)},b.unzip=function(a,b,c){return"function"==typeof b&&(c=b,b={}),d(new l(b),a,c)},b.unzipSync=function(a,b){return e(new l(b),a)},b.inflate=function(a,b,c){return"function"==typeof b&&(c=b,b={}),d(new g(b),a,c)},b.inflateSync=function(a,b){return e(new g(b),a)},b.gunzip=function(a,b,c){return"function"==typeof b&&(c=b,b={}),d(new i(b),a,c)},b.gunzipSync=function(a,b){return e(new i(b),a)},b.inflateRaw=function(a,b,c){return"function"==typeof b&&(c=b,b={}),d(new k(b),a,c)},b.inflateRawSync=function(a,b){return e(new k(b),a)},t.inherits(n,r),n.prototype.params=function(c,d,e){if(c<b.Z_MIN_LEVEL||c>b.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+c);if(d!=b.Z_FILTERED&&d!=b.Z_HUFFMAN_ONLY&&d!=b.Z_RLE&&d!=b.Z_FIXED&&d!=b.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+d);if(this._level!==c||this._strategy!==d){var f=this;this.flush(s.Z_SYNC_FLUSH,function(){u(f._handle,"zlib binding closed"),f._handle.params(c,d),f._hadError||(f._level=c,f._strategy=d,e&&e())})}else a.nextTick(e)},n.prototype.reset=function(){return u(this._handle,"zlib binding closed"),this._handle.reset()},n.prototype._flush=function(a){this._transform(q.alloc(0),"",a)},n.prototype.flush=function(b,c){var d=this,e=this._writableState;("function"==typeof b||void 0===b&&!c)&&(c=b,b=s.Z_FULL_FLUSH),e.ended?c&&a.nextTick(c):e.ending?c&&this.once("end",c):e.needDrain?c&&this.once("drain",function(){return d.flush(b,c)}):(this._flushFlag=b,this.write(q.alloc(0),"",c))},n.prototype.close=function(b){o(this,b),a.nextTick(p,this)},n.prototype._transform=function(a,b,c){var d,e=this._writableState,f=e.ending||e.ended,g=f&&(!a||e.length===a.length);return null===a||q.isBuffer(a)?this._handle?(g?d=this._finishFlushFlag:(d=this._flushFlag,a.length>=e.length&&(this._flushFlag=this._opts.flush||s.Z_NO_FLUSH)),void this._processChunk(a,d,c)):c(new Error("zlib binding closed")):c(new Error("invalid input"))},n.prototype._processChunk=function(a,b,c){function d(j,m){if(this&&(this.buffer=null,this.callback=null),!h._hadError){var n=f-m;if(u(n>=0,"have should not go down"),n>0){var o=h._buffer.slice(h._offset,h._offset+n);h._offset+=n,i?h.push(o):(k.push(o),l+=o.length)}if((0===m||h._offset>=h._chunkSize)&&(f=h._chunkSize,h._offset=0,h._buffer=q.allocUnsafe(h._chunkSize)),0===m){if(g+=e-j,e=j,!i)return!0;var p=h._handle.write(b,a,g,e,h._buffer,h._offset,h._chunkSize);return p.callback=d,void(p.buffer=a)}return!!i&&void c()}}var e=a&&a.length,f=this._chunkSize-this._offset,g=0,h=this,i="function"==typeof c;if(!i){var j,k=[],l=0;this.on("error",function(a){j=a}),u(this._handle,"zlib binding closed");do var m=this._handle.writeSync(b,a,g,e,this._buffer,this._offset,f);while(!this._hadError&&d(m[0],m[1]));if(this._hadError)throw j;if(l>=v)throw o(this),new RangeError(w);var n=q.concat(k,l);return o(this),n}u(this._handle,"zlib binding closed");var p=this._handle.write(b,a,g,e,this._buffer,this._offset,f);p.buffer=a,p.callback=d},t.inherits(f,n),t.inherits(g,n),t.inherits(h,n),t.inherits(i,n),t.inherits(j,n),t.inherits(k,n),t.inherits(l,n)}).call(this,c("../node_modules/process/browser.js"))},"../node_modules/buffer/index.js":function(a,b,c){"use strict";(function(a){function d(){try{var a=new Uint8Array(1);return a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===a.foo()&&"function"==typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(b){return!1}}function e(){return g.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(a,b){if(e()<b)throw new RangeError("Invalid typed array length");return g.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(b),a.__proto__=g.prototype):(null===a&&(a=new g(b)),a.length=b),a}function g(a,b,c){if(!(g.TYPED_ARRAY_SUPPORT||this instanceof g))return new g(a,b,c);if("number"==typeof a){if("string"==typeof b)throw new Error("If encoding is specified then the first argument must be a string");return k(this,a)}return h(this,a,b,c)}function h(a,b,c,d){if("number"==typeof b)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&b instanceof ArrayBuffer?n(a,b,c,d):"string"==typeof b?l(a,b,c):o(a,b)}function i(a){if("number"!=typeof a)throw new TypeError('"size" argument must be a number');if(a<0)throw new RangeError('"size" argument must not be negative')}function j(a,b,c,d){return i(b),b<=0?f(a,b):void 0!==c?"string"==typeof d?f(a,b).fill(c,d):f(a,b).fill(c):f(a,b)}function k(a,b){if(i(b),a=f(a,b<0?0:0|p(b)),!g.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;++c)a[c]=0;return a}function l(a,b,c){if("string"==typeof c&&""!==c||(c="utf8"),!g.isEncoding(c))throw new TypeError('"encoding" must be a valid string encoding');var d=0|r(b,c);a=f(a,d);var e=a.write(b,c);return e!==d&&(a=a.slice(0,e)),a}function m(a,b){var c=b.length<0?0:0|p(b.length);a=f(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function n(a,b,c,d){if(b.byteLength,c<0||b.byteLength<c)throw new RangeError("'offset' is out of bounds");if(b.byteLength<c+(d||0))throw new RangeError("'length' is out of bounds");return b=void 0===c&&void 0===d?new Uint8Array(b):void 0===d?new Uint8Array(b,c):new Uint8Array(b,c,d),g.TYPED_ARRAY_SUPPORT?(a=b,a.__proto__=g.prototype):a=m(a,b),a}function o(a,b){if(g.isBuffer(b)){var c=0|p(b.length);return a=f(a,c),0===a.length?a:(b.copy(a,0,0,c),a)}if(b){if("undefined"!=typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer||"length"in b)return"number"!=typeof b.length||Y(b.length)?f(a,0):m(a,b);if("Buffer"===b.type&&_(b.data))return m(a,b.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(a){if(a>=e())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e().toString(16)+" bytes");return 0|a}function q(a){return+a!=a&&(a=0),g.alloc(+a)}function r(a,b){if(g.isBuffer(a))return a.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":case void 0:return T(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return W(a).length;default:if(d)return T(a).length;b=(""+b).toLowerCase(),d=!0}}function s(a,b,c){var d=!1;if((void 0===b||b<0)&&(b=0),b>this.length)return"";if((void 0===c||c>this.length)&&(c=this.length),c<=0)return"";if(c>>>=0,b>>>=0,c<=b)return"";for(a||(a="utf8");;)switch(a){case"hex":return H(this,b,c);case"utf8":case"utf-8":return D(this,b,c);case"ascii":return F(this,b,c);case"latin1":case"binary":return G(this,b,c);case"base64":return C(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function u(a,b,c,d,e){if(0===a.length)return-1;if("string"==typeof c?(d=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,isNaN(c)&&(c=e?0:a.length-1),c<0&&(c=a.length+c),c>=a.length){if(e)return-1;c=a.length-1}else if(c<0){if(!e)return-1;c=0}if("string"==typeof b&&(b=g.from(b,d)),g.isBuffer(b))return 0===b.length?-1:v(a,b,c,d,e);if("number"==typeof b)return b=255&b,g.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):v(a,[b],c,d,e);throw new TypeError("val must be string, number or Buffer")}function v(a,b,c,d,e){function f(a,b){return 1===g?a[b]:a.readUInt16BE(b*g)}var g=1,h=a.length,i=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return-1;g=2,h/=2,i/=2,c/=2}var j;if(e){var k=-1;for(j=c;j<h;j++)if(f(a,j)===f(b,k===-1?0:j-k)){if(k===-1&&(k=j),j-k+1===i)return k*g}else k!==-1&&(j-=j-k),k=-1}else for(c+i>h&&(c=h-i),j=c;j>=0;j--){for(var l=!0,m=0;m<i;m++)if(f(a,j+m)!==f(b,m)){l=!1;break}if(l)return j}return-1}function w(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new TypeError("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;++g){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))return g;a[c+g]=h}return g}function x(a,b,c,d){return X(T(b,a.length-c),a,c,d)}function y(a,b,c,d){return X(U(b),a,c,d)}function z(a,b,c,d){return y(a,b,c,d)}function A(a,b,c,d){return X(W(b),a,c,d)}function B(a,b,c,d){return X(V(b,a.length-c),a,c,d)}function C(a,b,c){return 0===b&&c===a.length?Z.fromByteArray(a):Z.fromByteArray(a.slice(b,c))}function D(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(l<55296||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&l<1114112&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return E(d)}function E(a){var b=a.length;if(b<=aa)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=aa));return c}function F(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function G(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function H(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;++f)e+=S(a[f]);return e}function I(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function J(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function K(a,b,c,d,e,f){if(!g.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw new RangeError('"value" argument is out of bounds');if(c+d>a.length)throw new RangeError("Index out of range")}function L(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;++e)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function M(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;++e)a[c+e]=b>>>8*(d?e:3-e)&255}function N(a,b,c,d,e,f){if(c+d>a.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function O(a,b,c,d,e){return e||N(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(a,b,c,d,23,4),c+4}function P(a,b,c,d,e){return e||N(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(a,b,c,d,52,8),c+8}function Q(a){if(a=R(a).replace(ba,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function R(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function S(a){return a<16?"0"+a.toString(16):a.toString(16)}function T(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;++g){if(c=a.charCodeAt(g),c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function U(a){for(var b=[],c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function V(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);++g)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function W(a){return Z.toByteArray(Q(a))}function X(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function Y(a){return a!==a}var Z=c("../node_modules/base64-js/index.js"),$=c("../node_modules/ieee754/index.js"),_=c("../node_modules/isarray/index.js");b.Buffer=g,b.SlowBuffer=q,b.INSPECT_MAX_BYTES=50,g.TYPED_ARRAY_SUPPORT=void 0!==a.TYPED_ARRAY_SUPPORT?a.TYPED_ARRAY_SUPPORT:d(),b.kMaxLength=e(),g.poolSize=8192,g._augment=function(a){return a.__proto__=g.prototype,a},g.from=function(a,b,c){return h(null,a,b,c)},g.TYPED_ARRAY_SUPPORT&&(g.prototype.__proto__=Uint8Array.prototype,g.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&g[Symbol.species]===g&&Object.defineProperty(g,Symbol.species,{value:null,configurable:!0})),g.alloc=function(a,b,c){return j(null,a,b,c)},g.allocUnsafe=function(a){return k(null,a)},g.allocUnsafeSlow=function(a){return k(null,a)},g.isBuffer=function(a){return!(null==a||!a._isBuffer)},g.compare=function(a,b){if(!g.isBuffer(a)||!g.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:d<c?1:0},g.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(a,b){if(!_(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return g.alloc(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;++c)b+=a[c].length;var d=g.allocUnsafe(b),e=0;for(c=0;c<a.length;++c){var f=a[c];if(!g.isBuffer(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(d,e),e+=f.length}return d},g.byteLength=r,g.prototype._isBuffer=!0,g.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<a;b+=2)t(this,b,b+1);return this},g.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)t(this,b,b+3),t(this,b+1,b+2);return this},g.prototype.swap64=function(){var a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<a;b+=8)t(this,b,b+7),t(this,b+1,b+6),t(this,b+2,b+5),t(this,b+3,b+4);return this},g.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?D(this,0,a):s.apply(this,arguments)},g.prototype.equals=function(a){if(!g.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===g.compare(this,a)},g.prototype.inspect=function(){var a="",c=b.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(a+=" ... ")),"<Buffer "+a+">"},g.prototype.compare=function(a,b,c,d,e){if(!g.isBuffer(a))throw new TypeError("Argument must be a Buffer");if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),b<0||c>a.length||d<0||e>this.length)throw new RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return-1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;for(var f=e-d,h=c-b,i=Math.min(f,h),j=this.slice(d,e),k=a.slice(b,c),l=0;l<i;++l)if(j[l]!==k[l]){f=j[l],h=k[l];break}return f<h?-1:h<f?1:0},g.prototype.includes=function(a,b,c){return this.indexOf(a,b,c)!==-1},g.prototype.indexOf=function(a,b,c){return u(this,a,b,c,!0)},g.prototype.lastIndexOf=function(a,b,c){return u(this,a,b,c,!1)},g.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else{if(!isFinite(b))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0)}var e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var f=!1;;)switch(d){case"hex":return w(this,a,b,c);case"utf8":case"utf-8":return x(this,a,b,c);case"ascii":return y(this,a,b,c);case"latin1":case"binary":return z(this,a,b,c);case"base64":return A(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,a,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var aa=4096;g.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c,a<0&&(a=0)):a>c&&(a=c),b<0?(b+=c,b<0&&(b=0)):b>c&&(b=c),b<a&&(b=a);var d;if(g.TYPED_ARRAY_SUPPORT)d=this.subarray(a,b),d.__proto__=g.prototype;else{var e=b-a;d=new g(e,(void 0));for(var f=0;f<e;++f)d[f]=this[f+a]}return d},g.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},g.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},g.prototype.readUInt8=function(a,b){return b||J(a,1,this.length),this[a]},g.prototype.readUInt16LE=function(a,b){return b||J(a,2,this.length),this[a]|this[a+1]<<8},g.prototype.readUInt16BE=function(a,b){return b||J(a,2,this.length),this[a]<<8|this[a+1]},g.prototype.readUInt32LE=function(a,b){return b||J(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},g.prototype.readUInt32BE=function(a,b){return b||J(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},g.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},g.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},g.prototype.readInt8=function(a,b){return b||J(a,1,this.length),128&this[a]?(255-this[a]+1)*-1:this[a]},g.prototype.readInt16LE=function(a,b){b||J(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},g.prototype.readInt16BE=function(a,b){b||J(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},g.prototype.readInt32LE=function(a,b){return b||J(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},g.prototype.readInt32BE=function(a,b){return b||J(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},g.prototype.readFloatLE=function(a,b){return b||J(a,4,this.length),$.read(this,a,!0,23,4)},g.prototype.readFloatBE=function(a,b){return b||J(a,4,this.length),$.read(this,a,!1,23,4)},g.prototype.readDoubleLE=function(a,b){return b||J(a,8,this.length),$.read(this,a,!0,52,8)},g.prototype.readDoubleBE=function(a,b){return b||J(a,8,this.length),$.read(this,a,!1,52,8)},g.prototype.writeUIntLE=function(a,b,c,d){if(a=+a,b=0|b,c=0|c,!d){var e=Math.pow(2,8*c)-1;K(this,a,b,c,e,0)}var f=1,g=0;for(this[b]=255&a;++g<c&&(f*=256);)this[b+g]=a/f&255;return b+c},g.prototype.writeUIntBE=function(a,b,c,d){if(a=+a,b=0|b,c=0|c,!d){var e=Math.pow(2,8*c)-1;K(this,a,b,c,e,0)}var f=c-1,g=1;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=a/g&255;return b+c},g.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,1,255,0),g.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=255&a,b+1},g.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):L(this,a,b,!0),b+2},g.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):L(this,a,b,!1),b+2},g.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a):M(this,a,b,!0),b+4},g.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):M(this,a,b,!1),b+4},g.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);K(this,a,b,c,e-1,-e)}var f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)a<0&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},g.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);K(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)a<0&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},g.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,1,127,-128),g.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),a<0&&(a=255+a+1),this[b]=255&a,b+1},g.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):L(this,a,b,!0),b+2},g.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):L(this,a,b,!1),b+2},g.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,4,2147483647,-2147483648),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):M(this,a,b,!0),b+4},g.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||K(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):M(this,a,b,!1),b+4},g.prototype.writeFloatLE=function(a,b,c){return O(this,a,b,!0,c)},g.prototype.writeFloatBE=function(a,b,c){return O(this,a,b,!1,c)},g.prototype.writeDoubleLE=function(a,b,c){return P(this,a,b,!0,c)},g.prototype.writeDoubleBE=function(a,b,c){return P(this,a,b,!1,c)},g.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("sourceStart out of bounds");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var e,f=d-c;if(this===a&&c<b&&b<d)for(e=f-1;e>=0;--e)a[e+b]=this[e+c];else if(f<1e3||!g.TYPED_ARRAY_SUPPORT)for(e=0;e<f;++e)a[e+b]=this[e+c];else Uint8Array.prototype.set.call(a,this.subarray(c,c+f),b);return f},g.prototype.fill=function(a,b,c,d){if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),1===a.length){var e=a.charCodeAt(0);e<256&&(a=e)}if(void 0!==d&&"string"!=typeof d)throw new TypeError("encoding must be a string");if("string"==typeof d&&!g.isEncoding(d))throw new TypeError("Unknown encoding: "+d)}else"number"==typeof a&&(a=255&a);if(b<0||this.length<b||this.length<c)throw new RangeError("Out of range index");if(c<=b)return this;b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0);var f;if("number"==typeof a)for(f=b;f<c;++f)this[f]=a;else{var h=g.isBuffer(a)?a:T(new g(a,d).toString()),i=h.length;for(f=0;f<c-b;++f)this[f+b]=h[f%i]}return this};var ba=/[^+\/0-9A-Za-z-_]/g}).call(this,c("../node_modules/webpack/buildin/global.js"))},"../node_modules/core-util-is/lib/util.js":function(a,b,c){(function(a){function c(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}b.isArray=c,b.isBoolean=d,b.isNull=e,b.isNullOrUndefined=f,b.isNumber=g,b.isString=h,b.isSymbol=i,b.isUndefined=j,b.isRegExp=k,b.isObject=l,b.isDate=m,b.isError=n,b.isFunction=o,b.isPrimitive=p,b.isBuffer=a.isBuffer}).call(this,c("../node_modules/buffer/index.js").Buffer)},"../node_modules/events/events.js":function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}a.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),c.apply(this,h)}else if(f(c))for(h=Array.prototype.slice.call(arguments,1),j=c.slice(),e=j.length,i=0;i<e;i++)j[i].apply(this,h);return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned&&(e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())),this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(e<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(d(b))return 1;if(b)return b.length}return 0},c.listenerCount=function(a,b){return a.listenerCount(b)}},"../node_modules/ieee754/index.js":function(a,b){b.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},b.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},"../node_modules/inherits/inherits_browser.js":function(a,b){"function"==typeof Object.create?a.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},"../node_modules/isarray/index.js":function(a,b){var c={}.toString;a.exports=Array.isArray||function(a){return"[object Array]"==c.call(a)}},"../node_modules/pako/lib/utils/common.js":function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var e="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;b.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!=typeof c)throw new TypeError(c+"must be non-object");for(var e in c)d(c,e)&&(a[e]=c[e])}}return a},b.shrinkBuf=function(a,b){return a.length===b?a:a.subarray?a.subarray(0,b):(a.length=b,a)};var f={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray)return void a.set(b.subarray(c,c+d),e);for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f,g;for(d=0,b=0,c=a.length;b<c;b++)d+=a[b].length;for(g=new Uint8Array(d),e=0,b=0,c=a.length;b<c;b++)f=a[b],g.set(f,e),e+=f.length;return g}},g={arraySet:function(a,b,c,d,e){for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};b.setTyped=function(a){a?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,
b.assign(b,f)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,g))},b.setTyped(e)},"../node_modules/pako/lib/zlib/adler32.js":function(a,b,c){"use strict";function d(a,b,c,d){for(var e=65535&a|0,f=a>>>16&65535|0,g=0;0!==c;){g=c>2e3?2e3:c,c-=g;do e=e+b[d++]|0,f=f+e|0;while(--g);e%=65521,f%=65521}return e|f<<16|0}a.exports=d},"../node_modules/pako/lib/zlib/constants.js":function(a,b,c){"use strict";a.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"../node_modules/pako/lib/zlib/crc32.js":function(a,b,c){"use strict";function d(){for(var a,b=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;b[c]=a}return b}function e(a,b,c,d){var e=f,g=d+c;a^=-1;for(var h=d;h<g;h++)a=a>>>8^e[255&(a^b[h])];return a^-1}var f=d();a.exports=e},"../node_modules/pako/lib/zlib/deflate.js":function(a,b,c){"use strict";function d(a,b){return a.msg=I[b],b}function e(a){return(a<<1)-(a>4?9:0)}function f(a){for(var b=a.length;--b>=0;)a[b]=0}function g(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out),0!==c&&(E.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function h(a,b){F._tr_flush_block(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,b),a.block_start=a.strstart,g(a.strm)}function i(a,b){a.pending_buf[a.pending++]=b}function j(a,b){a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=255&b}function k(a,b,c,d){var e=a.avail_in;return e>d&&(e=d),0===e?0:(a.avail_in-=e,E.arraySet(b,a.input,a.next_in,e,c),1===a.state.wrap?a.adler=G(a.adler,b,e,c):2===a.state.wrap&&(a.adler=H(a.adler,b,e,c)),a.next_in+=e,a.total_in+=e,e)}function l(a,b){var c,d,e=a.max_chain_length,f=a.strstart,g=a.prev_length,h=a.nice_match,i=a.strstart>a.w_size-la?a.strstart-(a.w_size-la):0,j=a.window,k=a.w_mask,l=a.prev,m=a.strstart+ka,n=j[f+g-1],o=j[f+g];a.prev_length>=a.good_match&&(e>>=2),h>a.lookahead&&(h=a.lookahead);do if(c=b,j[c+g]===o&&j[c+g-1]===n&&j[c]===j[f]&&j[++c]===j[f+1]){f+=2,c++;do;while(j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&f<m);if(d=ka-(m-f),f=m-ka,d>g){if(a.match_start=b,g=d,d>=h)break;n=j[f+g-1],o=j[f+g]}}while((b=l[b&k])>i&&0!==--e);return g<=a.lookahead?g:a.lookahead}function m(a){var b,c,d,e,f,g=a.w_size;do{if(e=a.window_size-a.lookahead-a.strstart,a.strstart>=g+(g-la)){E.arraySet(a.window,a.window,g,g,0),a.match_start-=g,a.strstart-=g,a.block_start-=g,c=a.hash_size,b=c;do d=a.head[--b],a.head[b]=d>=g?d-g:0;while(--c);c=g,b=c;do d=a.prev[--b],a.prev[b]=d>=g?d-g:0;while(--c);e+=g}if(0===a.strm.avail_in)break;if(c=k(a.strm,a.window,a.strstart+a.lookahead,e),a.lookahead+=c,a.lookahead+a.insert>=ja)for(f=a.strstart-a.insert,a.ins_h=a.window[f],a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+ja-1])&a.hash_mask,a.prev[f&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=f,f++,a.insert--,!(a.lookahead+a.insert<ja)););}while(a.lookahead<la&&0!==a.strm.avail_in)}function n(a,b){var c=65535;for(c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);;){if(a.lookahead<=1){if(m(a),0===a.lookahead&&b===J)return ua;if(0===a.lookahead)break}a.strstart+=a.lookahead,a.lookahead=0;var d=a.block_start+c;if((0===a.strstart||a.strstart>=d)&&(a.lookahead=a.strstart-d,a.strstart=d,h(a,!1),0===a.strm.avail_out))return ua;if(a.strstart-a.block_start>=a.w_size-la&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.strstart>a.block_start&&(h(a,!1),0===a.strm.avail_out)?ua:ua}function o(a,b){for(var c,d;;){if(a.lookahead<la){if(m(a),a.lookahead<la&&b===J)return ua;if(0===a.lookahead)break}if(c=0,a.lookahead>=ja&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==c&&a.strstart-c<=a.w_size-la&&(a.match_length=l(a,c)),a.match_length>=ja)if(d=F._tr_tally(a,a.strstart-a.match_start,a.match_length-ja),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=ja){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else d=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=a.strstart<ja-1?a.strstart:ja-1,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function p(a,b){for(var c,d,e;;){if(a.lookahead<la){if(m(a),a.lookahead<la&&b===J)return ua;if(0===a.lookahead)break}if(c=0,a.lookahead>=ja&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=ja-1,0!==c&&a.prev_length<a.max_lazy_match&&a.strstart-c<=a.w_size-la&&(a.match_length=l(a,c),a.match_length<=5&&(a.strategy===U||a.match_length===ja&&a.strstart-a.match_start>4096)&&(a.match_length=ja-1)),a.prev_length>=ja&&a.match_length<=a.prev_length){e=a.strstart+a.lookahead-ja,d=F._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-ja),a.lookahead-=a.prev_length-1,a.prev_length-=2;do++a.strstart<=e&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!==--a.prev_length);if(a.match_available=0,a.match_length=ja-1,a.strstart++,d&&(h(a,!1),0===a.strm.avail_out))return ua}else if(a.match_available){if(d=F._tr_tally(a,0,a.window[a.strstart-1]),d&&h(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return ua}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(d=F._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<ja-1?a.strstart:ja-1,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function q(a,b){for(var c,d,e,f,g=a.window;;){if(a.lookahead<=ka){if(m(a),a.lookahead<=ka&&b===J)return ua;if(0===a.lookahead)break}if(a.match_length=0,a.lookahead>=ja&&a.strstart>0&&(e=a.strstart-1,d=g[e],d===g[++e]&&d===g[++e]&&d===g[++e])){f=a.strstart+ka;do;while(d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&e<f);a.match_length=ka-(f-e),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=ja?(c=F._tr_tally(a,1,a.match_length-ja),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),c&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function r(a,b){for(var c;;){if(0===a.lookahead&&(m(a),0===a.lookahead)){if(b===J)return ua;break}if(a.match_length=0,c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,c&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function s(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e}function t(a){a.window_size=2*a.w_size,f(a.head),a.max_lazy_match=D[a.level].max_lazy,a.good_match=D[a.level].good_length,a.nice_match=D[a.level].nice_length,a.max_chain_length=D[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=ja-1,a.match_available=0,a.ins_h=0}function u(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=$,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*ha),this.dyn_dtree=new E.Buf16(2*(2*fa+1)),this.bl_tree=new E.Buf16(2*(2*ga+1)),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(ia+1),this.heap=new E.Buf16(2*ea+1),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*ea+1),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function v(a){var b;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=Z,b=a.state,b.pending=0,b.pending_out=0,b.wrap<0&&(b.wrap=-b.wrap),b.status=b.wrap?na:sa,a.adler=2===b.wrap?0:1,b.last_flush=J,F._tr_init(b),O):d(a,Q)}function w(a){var b=v(a);return b===O&&t(a.state),b}function x(a,b){return a&&a.state?2!==a.state.wrap?Q:(a.state.gzhead=b,O):Q}function y(a,b,c,e,f,g){if(!a)return Q;var h=1;if(b===T&&(b=6),e<0?(h=0,e=-e):e>15&&(h=2,e-=16),f<1||f>_||c!==$||e<8||e>15||b<0||b>9||g<0||g>X)return d(a,Q);8===e&&(e=9);var i=new u;return a.state=i,i.strm=a,i.wrap=h,i.gzhead=null,i.w_bits=e,i.w_size=1<<i.w_bits,i.w_mask=i.w_size-1,i.hash_bits=f+7,i.hash_size=1<<i.hash_bits,i.hash_mask=i.hash_size-1,i.hash_shift=~~((i.hash_bits+ja-1)/ja),i.window=new E.Buf8(2*i.w_size),i.head=new E.Buf16(i.hash_size),i.prev=new E.Buf16(i.w_size),i.lit_bufsize=1<<f+6,i.pending_buf_size=4*i.lit_bufsize,i.pending_buf=new E.Buf8(i.pending_buf_size),i.d_buf=1*i.lit_bufsize,i.l_buf=3*i.lit_bufsize,i.level=b,i.strategy=g,i.method=c,w(a)}function z(a,b){return y(a,b,$,aa,ba,Y)}function A(a,b){var c,h,k,l;if(!a||!a.state||b>N||b<0)return a?d(a,Q):Q;if(h=a.state,!a.output||!a.input&&0!==a.avail_in||h.status===ta&&b!==M)return d(a,0===a.avail_out?S:Q);if(h.strm=a,c=h.last_flush,h.last_flush=b,h.status===na)if(2===h.wrap)a.adler=0,i(h,31),i(h,139),i(h,8),h.gzhead?(i(h,(h.gzhead.text?1:0)+(h.gzhead.hcrc?2:0)+(h.gzhead.extra?4:0)+(h.gzhead.name?8:0)+(h.gzhead.comment?16:0)),i(h,255&h.gzhead.time),i(h,h.gzhead.time>>8&255),i(h,h.gzhead.time>>16&255),i(h,h.gzhead.time>>24&255),i(h,9===h.level?2:h.strategy>=V||h.level<2?4:0),i(h,255&h.gzhead.os),h.gzhead.extra&&h.gzhead.extra.length&&(i(h,255&h.gzhead.extra.length),i(h,h.gzhead.extra.length>>8&255)),h.gzhead.hcrc&&(a.adler=H(a.adler,h.pending_buf,h.pending,0)),h.gzindex=0,h.status=oa):(i(h,0),i(h,0),i(h,0),i(h,0),i(h,0),i(h,9===h.level?2:h.strategy>=V||h.level<2?4:0),i(h,ya),h.status=sa);else{var m=$+(h.w_bits-8<<4)<<8,n=-1;n=h.strategy>=V||h.level<2?0:h.level<6?1:6===h.level?2:3,m|=n<<6,0!==h.strstart&&(m|=ma),m+=31-m%31,h.status=sa,j(h,m),0!==h.strstart&&(j(h,a.adler>>>16),j(h,65535&a.adler)),a.adler=1}if(h.status===oa)if(h.gzhead.extra){for(k=h.pending;h.gzindex<(65535&h.gzhead.extra.length)&&(h.pending!==h.pending_buf_size||(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending!==h.pending_buf_size));)i(h,255&h.gzhead.extra[h.gzindex]),h.gzindex++;h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),h.gzindex===h.gzhead.extra.length&&(h.gzindex=0,h.status=pa)}else h.status=pa;if(h.status===pa)if(h.gzhead.name){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.name.length?255&h.gzhead.name.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.gzindex=0,h.status=qa)}else h.status=qa;if(h.status===qa)if(h.gzhead.comment){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.comment.length?255&h.gzhead.comment.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.status=ra)}else h.status=ra;if(h.status===ra&&(h.gzhead.hcrc?(h.pending+2>h.pending_buf_size&&g(a),h.pending+2<=h.pending_buf_size&&(i(h,255&a.adler),i(h,a.adler>>8&255),a.adler=0,h.status=sa)):h.status=sa),0!==h.pending){if(g(a),0===a.avail_out)return h.last_flush=-1,O}else if(0===a.avail_in&&e(b)<=e(c)&&b!==M)return d(a,S);if(h.status===ta&&0!==a.avail_in)return d(a,S);if(0!==a.avail_in||0!==h.lookahead||b!==J&&h.status!==ta){var o=h.strategy===V?r(h,b):h.strategy===W?q(h,b):D[h.level].func(h,b);if(o!==wa&&o!==xa||(h.status=ta),o===ua||o===wa)return 0===a.avail_out&&(h.last_flush=-1),O;if(o===va&&(b===K?F._tr_align(h):b!==N&&(F._tr_stored_block(h,0,0,!1),b===L&&(f(h.head),0===h.lookahead&&(h.strstart=0,h.block_start=0,h.insert=0))),g(a),0===a.avail_out))return h.last_flush=-1,O}return b!==M?O:h.wrap<=0?P:(2===h.wrap?(i(h,255&a.adler),i(h,a.adler>>8&255),i(h,a.adler>>16&255),i(h,a.adler>>24&255),i(h,255&a.total_in),i(h,a.total_in>>8&255),i(h,a.total_in>>16&255),i(h,a.total_in>>24&255)):(j(h,a.adler>>>16),j(h,65535&a.adler)),g(a),h.wrap>0&&(h.wrap=-h.wrap),0!==h.pending?O:P)}function B(a){var b;return a&&a.state?(b=a.state.status,b!==na&&b!==oa&&b!==pa&&b!==qa&&b!==ra&&b!==sa&&b!==ta?d(a,Q):(a.state=null,b===sa?d(a,R):O)):Q}function C(a,b){var c,d,e,g,h,i,j,k,l=b.length;if(!a||!a.state)return Q;if(c=a.state,g=c.wrap,2===g||1===g&&c.status!==na||c.lookahead)return Q;for(1===g&&(a.adler=G(a.adler,b,l,0)),c.wrap=0,l>=c.w_size&&(0===g&&(f(c.head),c.strstart=0,c.block_start=0,c.insert=0),k=new E.Buf8(c.w_size),E.arraySet(k,b,l-c.w_size,c.w_size,0),b=k,l=c.w_size),h=a.avail_in,i=a.next_in,j=a.input,a.avail_in=l,a.next_in=0,a.input=b,m(c);c.lookahead>=ja;){d=c.strstart,e=c.lookahead-(ja-1);do c.ins_h=(c.ins_h<<c.hash_shift^c.window[d+ja-1])&c.hash_mask,c.prev[d&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=d,d++;while(--e);c.strstart=d,c.lookahead=ja-1,m(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=ja-1,c.match_available=0,a.next_in=i,a.input=j,a.avail_in=h,c.wrap=g,O}var D,E=c("../node_modules/pako/lib/utils/common.js"),F=c("../node_modules/pako/lib/zlib/trees.js"),G=c("../node_modules/pako/lib/zlib/adler32.js"),H=c("../node_modules/pako/lib/zlib/crc32.js"),I=c("../node_modules/pako/lib/zlib/messages.js"),J=0,K=1,L=3,M=4,N=5,O=0,P=1,Q=-2,R=-3,S=-5,T=-1,U=1,V=2,W=3,X=4,Y=0,Z=2,$=8,_=9,aa=15,ba=8,ca=29,da=256,ea=da+1+ca,fa=30,ga=19,ha=2*ea+1,ia=15,ja=3,ka=258,la=ka+ja+1,ma=32,na=42,oa=69,pa=73,qa=91,ra=103,sa=113,ta=666,ua=1,va=2,wa=3,xa=4,ya=3;D=[new s(0,0,0,0,n),new s(4,4,8,4,o),new s(4,5,16,8,o),new s(4,6,32,32,o),new s(4,4,16,16,p),new s(8,16,32,32,p),new s(8,16,128,128,p),new s(8,32,128,256,p),new s(32,128,258,1024,p),new s(32,258,258,4096,p)],b.deflateInit=z,b.deflateInit2=y,b.deflateReset=w,b.deflateResetKeep=v,b.deflateSetHeader=x,b.deflate=A,b.deflateEnd=B,b.deflateSetDictionary=C,b.deflateInfo="pako deflate (from Nodeca project)"},"../node_modules/pako/lib/zlib/inffast.js":function(a,b,c){"use strict";var d=30,e=12;a.exports=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;c=a.state,f=a.next_in,B=a.input,g=f+(a.avail_in-5),h=a.next_out,C=a.output,i=h-(b-a.avail_out),j=h+(a.avail_out-257),k=c.dmax,l=c.wsize,m=c.whave,n=c.wnext,o=c.window,p=c.hold,q=c.bits,r=c.lencode,s=c.distcode,t=(1<<c.lenbits)-1,u=(1<<c.distbits)-1;a:do{q<15&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=r[p&t];b:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,0===w)C[h++]=65535&v;else{if(!(16&w)){if(0===(64&w)){v=r[(65535&v)+(p&(1<<w)-1)];continue b}if(32&w){c.mode=e;break a}a.msg="invalid literal/length code",c.mode=d;break a}x=65535&v,w&=15,w&&(q<w&&(p+=B[f++]<<q,q+=8),x+=p&(1<<w)-1,p>>>=w,q-=w),q<15&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=s[p&u];c:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,!(16&w)){if(0===(64&w)){v=s[(65535&v)+(p&(1<<w)-1)];continue c}a.msg="invalid distance code",c.mode=d;break a}if(y=65535&v,w&=15,q<w&&(p+=B[f++]<<q,q+=8,q<w&&(p+=B[f++]<<q,q+=8)),y+=p&(1<<w)-1,y>k){a.msg="invalid distance too far back",c.mode=d;break a}if(p>>>=w,q-=w,w=h-i,y>w){if(w=y-w,w>m&&c.sane){a.msg="invalid distance too far back",c.mode=d;break a}if(z=0,A=o,0===n){if(z+=l-w,w<x){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}else if(n<w){if(z+=l+n-w,w-=n,w<x){x-=w;do C[h++]=o[z++];while(--w);if(z=0,n<x){w=n,x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}}else if(z+=n-w,w<x){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}for(;x>2;)C[h++]=A[z++],C[h++]=A[z++],C[h++]=A[z++],x-=3;x&&(C[h++]=A[z++],x>1&&(C[h++]=A[z++]))}else{z=h-y;do C[h++]=C[z++],C[h++]=C[z++],C[h++]=C[z++],x-=3;while(x>2);x&&(C[h++]=C[z++],x>1&&(C[h++]=C[z++]))}break}}break}}while(f<g&&h<j);x=q>>3,f-=x,q-=x<<3,p&=(1<<q)-1,a.next_in=f,a.next_out=h,a.avail_in=f<g?5+(g-f):5-(f-g),a.avail_out=h<j?257+(j-h):257-(h-j),c.hold=p,c.bits=q}},"../node_modules/pako/lib/zlib/inflate.js":function(a,b,c){"use strict";function d(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(a){var b;return a&&a.state?(b=a.state,a.total_in=a.total_out=b.total=0,a.msg="",b.wrap&&(a.adler=1&b.wrap),b.mode=L,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new s.Buf32(pa),b.distcode=b.distdyn=new s.Buf32(qa),b.sane=1,b.back=-1,D):G}function g(a){var b;return a&&a.state?(b=a.state,b.wsize=0,b.whave=0,b.wnext=0,f(a)):G}function h(a,b){var c,d;return a&&a.state?(d=a.state,b<0?(c=0,b=-b):(c=(b>>4)+1,b<48&&(b&=15)),b&&(b<8||b>15)?G:(null!==d.window&&d.wbits!==b&&(d.window=null),d.wrap=c,d.wbits=b,g(a))):G}function i(a,b){var c,d;return a?(d=new e,a.state=d,d.window=null,c=h(a,b),c!==D&&(a.state=null),c):G}function j(a){return i(a,sa)}function k(a){if(ta){var b;for(q=new s.Buf32(512),r=new s.Buf32(32),b=0;b<144;)a.lens[b++]=8;for(;b<256;)a.lens[b++]=9;for(;b<280;)a.lens[b++]=7;for(;b<288;)a.lens[b++]=8;for(w(y,a.lens,0,288,q,0,a.work,{bits:9}),b=0;b<32;)a.lens[b++]=5;w(z,a.lens,0,32,r,0,a.work,{bits:5}),ta=!1}a.lencode=q,a.lenbits=9,a.distcode=r,a.distbits=5}function l(a,b,c,d){var e,f=a.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new s.Buf8(f.wsize)),d>=f.wsize?(s.arraySet(f.window,b,c-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(e=f.wsize-f.wnext,e>d&&(e=d),s.arraySet(f.window,b,c-d,e,f.wnext),d-=e,d?(s.arraySet(f.window,b,c-d,d,0),f.wnext=d,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0}function m(a,b){var c,e,f,g,h,i,j,m,n,o,p,q,r,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa=0,Ba=new s.Buf8(4),Ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return G;c=a.state,c.mode===W&&(c.mode=X),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,o=i,p=j,xa=D;a:for(;;)switch(c.mode){case L:if(0===c.wrap){c.mode=X;break}for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(2&c.wrap&&35615===m){c.check=0,Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0),m=0,n=0,c.mode=M;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&m)<<8)+(m>>8))%31){a.msg="incorrect header check",c.mode=ma;break}if((15&m)!==K){a.msg="unknown compression method",c.mode=ma;break}if(m>>>=4,n-=4,wa=(15&m)+8,0===c.wbits)c.wbits=wa;else if(wa>c.wbits){a.msg="invalid window size",c.mode=ma;break}c.dmax=1<<wa,a.adler=c.check=1,c.mode=512&m?U:W,m=0,n=0;break;case M:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.flags=m,(255&c.flags)!==K){a.msg="unknown compression method",c.mode=ma;break}if(57344&c.flags){a.msg="unknown header flags set",c.mode=ma;break}c.head&&(c.head.text=m>>8&1),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0,c.mode=N;case N:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.time=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,Ba[2]=m>>>16&255,Ba[3]=m>>>24&255,c.check=u(c.check,Ba,4,0)),m=0,n=0,c.mode=O;case O:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.xflags=255&m,c.head.os=m>>8),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0,c.mode=P;case P:if(1024&c.flags){for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length=m,c.head&&(c.head.extra_len=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0}else c.head&&(c.head.extra=null);c.mode=Q;case Q:if(1024&c.flags&&(q=c.length,q>i&&(q=i),q&&(c.head&&(wa=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),s.arraySet(c.head.extra,e,g,q,wa)),512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,c.length-=q),c.length))break a;c.length=0,c.mode=R;case R:if(2048&c.flags){if(0===i)break a;q=0;do wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.name+=String.fromCharCode(wa));while(wa&&q<i);if(512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.name=null);c.length=0,c.mode=S;case S:if(4096&c.flags){if(0===i)break a;q=0;do wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.comment+=String.fromCharCode(wa));while(wa&&q<i);if(512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.comment=null);c.mode=T;case T:if(512&c.flags){for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(65535&c.check)){a.msg="header crc mismatch",c.mode=ma;break}m=0,n=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),a.adler=c.check=0,c.mode=W;break;case U:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}a.adler=c.check=d(m),m=0,n=0,c.mode=V;case V:if(0===c.havedict)return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,F;a.adler=c.check=1,c.mode=W;case W:if(b===B||b===C)break a;case X:if(c.last){m>>>=7&n,n-=7&n,c.mode=ja;break}for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}switch(c.last=1&m,m>>>=1,n-=1,3&m){case 0:c.mode=Y;break;case 1:if(k(c),c.mode=ca,b===C){m>>>=2,n-=2;break a}break;case 2:c.mode=_;break;case 3:a.msg="invalid block type",c.mode=ma}m>>>=2,n-=2;break;case Y:for(m>>>=7&n,n-=7&n;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if((65535&m)!==(m>>>16^65535)){a.msg="invalid stored block lengths",c.mode=ma;break}if(c.length=65535&m,m=0,n=0,c.mode=Z,b===C)break a;case Z:c.mode=$;case $:if(q=c.length){if(q>i&&(q=i),q>j&&(q=j),0===q)break a;s.arraySet(f,e,g,q,h),i-=q,g+=q,j-=q,h+=q,c.length-=q;break}c.mode=W;break;case _:for(;n<14;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.nlen=(31&m)+257,m>>>=5,n-=5,c.ndist=(31&m)+1,m>>>=5,n-=5,c.ncode=(15&m)+4,m>>>=4,n-=4,c.nlen>286||c.ndist>30){a.msg="too many length or distance symbols",c.mode=ma;break}c.have=0,c.mode=aa;case aa:for(;c.have<c.ncode;){for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.lens[Ca[c.have++]]=7&m,m>>>=3,n-=3}for(;c.have<19;)c.lens[Ca[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,ya={bits:c.lenbits},xa=w(x,c.lens,0,19,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid code lengths set",c.mode=ma;break}c.have=0,c.mode=ba;case ba:for(;c.have<c.nlen+c.ndist;){for(;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(sa<16)m>>>=qa,n-=qa,c.lens[c.have++]=sa;else{if(16===sa){for(za=qa+2;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m>>>=qa,n-=qa,0===c.have){a.msg="invalid bit length repeat",c.mode=ma;break}wa=c.lens[c.have-1],q=3+(3&m),m>>>=2,n-=2}else if(17===sa){for(za=qa+3;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=3+(7&m),m>>>=3,n-=3}else{for(za=qa+7;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=11+(127&m),m>>>=7,n-=7}if(c.have+q>c.nlen+c.ndist){a.msg="invalid bit length repeat",c.mode=ma;break}for(;q--;)c.lens[c.have++]=wa}}if(c.mode===ma)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block",c.mode=ma;break}if(c.lenbits=9,ya={bits:c.lenbits},xa=w(y,c.lens,0,c.nlen,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid literal/lengths set",c.mode=ma;break}if(c.distbits=6,c.distcode=c.distdyn,ya={bits:c.distbits},xa=w(z,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,ya),c.distbits=ya.bits,xa){a.msg="invalid distances set",c.mode=ma;break}if(c.mode=ca,b===C)break a;case ca:c.mode=da;case da:if(i>=6&&j>=258){a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,v(a,p),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,c.mode===W&&(c.back=-1);break}for(c.back=0;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(ra&&0===(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.lencode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,c.length=sa,0===ra){c.mode=ia;break}if(32&ra){c.back=-1,c.mode=W;break}if(64&ra){a.msg="invalid literal/length code",c.mode=ma;break}c.extra=15&ra,c.mode=ea;case ea:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=fa;case fa:for(;Aa=c.distcode[m&(1<<c.distbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(0===(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.distcode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,64&ra){a.msg="invalid distance code",c.mode=ma;break}c.offset=sa,c.extra=15&ra,c.mode=ga;case ga:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.offset+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back",c.mode=ma;break}c.mode=ha;case ha:if(0===j)break a;if(q=p-j,c.offset>q){if(q=c.offset-q,q>c.whave&&c.sane){a.msg="invalid distance too far back",c.mode=ma;break}q>c.wnext?(q-=c.wnext,r=c.wsize-q):r=c.wnext-q,q>c.length&&(q=c.length),pa=c.window}else pa=f,r=h-c.offset,q=c.length;q>j&&(q=j),j-=q,c.length-=q;do f[h++]=pa[r++];while(--q);0===c.length&&(c.mode=da);break;case ia:if(0===j)break a;f[h++]=c.length,j--,c.mode=da;break;case ja:if(c.wrap){for(;n<32;){if(0===i)break a;i--,m|=e[g++]<<n,n+=8}if(p-=j,a.total_out+=p,c.total+=p,p&&(a.adler=c.check=c.flags?u(c.check,f,p,h-p):t(c.check,f,p,h-p)),p=j,(c.flags?m:d(m))!==c.check){a.msg="incorrect data check",c.mode=ma;break}m=0,n=0}c.mode=ka;case ka:if(c.wrap&&c.flags){for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(4294967295&c.total)){a.msg="incorrect length check",c.mode=ma;break}m=0,n=0}c.mode=la;case la:xa=E;break a;case ma:xa=H;break a;case na:return I;case oa:default:return G}return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,(c.wsize||p!==a.avail_out&&c.mode<ma&&(c.mode<ja||b!==A))&&l(a,a.output,a.next_out,p-a.avail_out)?(c.mode=na,I):(o-=a.avail_in,p-=a.avail_out,a.total_in+=o,a.total_out+=p,c.total+=p,c.wrap&&p&&(a.adler=c.check=c.flags?u(c.check,f,p,a.next_out-p):t(c.check,f,p,a.next_out-p)),a.data_type=c.bits+(c.last?64:0)+(c.mode===W?128:0)+(c.mode===ca||c.mode===Z?256:0),(0===o&&0===p||b===A)&&xa===D&&(xa=J),xa)}function n(a){if(!a||!a.state)return G;var b=a.state;return b.window&&(b.window=null),a.state=null,D}function o(a,b){var c;return a&&a.state?(c=a.state,0===(2&c.wrap)?G:(c.head=b,b.done=!1,D)):G}function p(a,b){var c,d,e,f=b.length;return a&&a.state?(c=a.state,0!==c.wrap&&c.mode!==V?G:c.mode===V&&(d=1,d=t(d,b,f,0),d!==c.check)?H:(e=l(a,b,f,f))?(c.mode=na,I):(c.havedict=1,D)):G}var q,r,s=c("../node_modules/pako/lib/utils/common.js"),t=c("../node_modules/pako/lib/zlib/adler32.js"),u=c("../node_modules/pako/lib/zlib/crc32.js"),v=c("../node_modules/pako/lib/zlib/inffast.js"),w=c("../node_modules/pako/lib/zlib/inftrees.js"),x=0,y=1,z=2,A=4,B=5,C=6,D=0,E=1,F=2,G=-2,H=-3,I=-4,J=-5,K=8,L=1,M=2,N=3,O=4,P=5,Q=6,R=7,S=8,T=9,U=10,V=11,W=12,X=13,Y=14,Z=15,$=16,_=17,aa=18,ba=19,ca=20,da=21,ea=22,fa=23,ga=24,ha=25,ia=26,ja=27,ka=28,la=29,ma=30,na=31,oa=32,pa=852,qa=592,ra=15,sa=ra,ta=!0;b.inflateReset=g,b.inflateReset2=h,b.inflateResetKeep=f,b.inflateInit=j,b.inflateInit2=i,b.inflate=m,b.inflateEnd=n,b.inflateGetHeader=o,b.inflateSetDictionary=p,b.inflateInfo="pako inflate (from Nodeca project)"},"../node_modules/pako/lib/zlib/inftrees.js":function(a,b,c){"use strict";var d=c("../node_modules/pako/lib/utils/common.js"),e=15,f=852,g=592,h=0,i=1,j=2,k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],n=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];a.exports=function(a,b,c,o,p,q,r,s){var t,u,v,w,x,y,z,A,B,C=s.bits,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=null,O=0,P=new d.Buf16(e+1),Q=new d.Buf16(e+1),R=null,S=0;for(D=0;D<=e;D++)P[D]=0;for(E=0;E<o;E++)P[b[c+E]]++;for(H=C,G=e;G>=1&&0===P[G];G--);if(H>G&&(H=G),0===G)return p[q++]=20971520,p[q++]=20971520,s.bits=1,0;for(F=1;F<G&&0===P[F];F++);for(H<F&&(H=F),K=1,D=1;D<=e;D++)if(K<<=1,K-=P[D],K<0)return-1;if(K>0&&(a===h||1!==G))return-1;for(Q[1]=0,D=1;D<e;D++)Q[D+1]=Q[D]+P[D];for(E=0;E<o;E++)0!==b[c+E]&&(r[Q[b[c+E]]++]=E);if(a===h?(N=R=r,y=19):a===i?(N=k,O-=257,R=l,S-=257,y=256):(N=m,R=n,y=-1),M=0,E=0,D=F,x=q,I=H,J=0,v=-1,L=1<<H,w=L-1,a===i&&L>f||a===j&&L>g)return 1;for(;;){z=D-J,r[E]<y?(A=0,B=r[E]):r[E]>y?(A=R[S+r[E]],B=N[O+r[E]]):(A=96,B=0),t=1<<D-J,u=1<<I,F=u;do u-=t,p[x+(M>>J)+u]=z<<24|A<<16|B|0;while(0!==u);for(t=1<<D-1;M&t;)t>>=1;if(0!==t?(M&=t-1,M+=t):M=0,E++,0===--P[D]){if(D===G)break;D=b[c+r[E]]}if(D>H&&(M&w)!==v){for(0===J&&(J=H),x+=F,I=D-J,K=1<<I;I+J<G&&(K-=P[I+J],!(K<=0));)I++,K<<=1;if(L+=1<<I,a===i&&L>f||a===j&&L>g)return 1;v=M&w,p[v]=H<<24|I<<16|x-q|0}}return 0!==M&&(p[x+M]=D-J<<24|64<<16|0),s.bits=H,0}},"../node_modules/pako/lib/zlib/messages.js":function(a,b,c){"use strict";a.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"../node_modules/pako/lib/zlib/trees.js":function(a,b,c){"use strict";function d(a){for(var b=a.length;--b>=0;)a[b]=0}function e(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length}function f(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b}function g(a){return a<256?ia[a]:ia[256+(a>>>7)]}function h(a,b){a.pending_buf[a.pending++]=255&b,a.pending_buf[a.pending++]=b>>>8&255}function i(a,b,c){a.bi_valid>X-c?(a.bi_buf|=b<<a.bi_valid&65535,h(a,a.bi_buf),a.bi_buf=b>>X-a.bi_valid,a.bi_valid+=c-X):(a.bi_buf|=b<<a.bi_valid&65535,
a.bi_valid+=c)}function j(a,b,c){i(a,c[2*b],c[2*b+1])}function k(a,b){var c=0;do c|=1&a,a>>>=1,c<<=1;while(--b>0);return c>>>1}function l(a){16===a.bi_valid?(h(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)}function m(a,b){var c,d,e,f,g,h,i=b.dyn_tree,j=b.max_code,k=b.stat_desc.static_tree,l=b.stat_desc.has_stree,m=b.stat_desc.extra_bits,n=b.stat_desc.extra_base,o=b.stat_desc.max_length,p=0;for(f=0;f<=W;f++)a.bl_count[f]=0;for(i[2*a.heap[a.heap_max]+1]=0,c=a.heap_max+1;c<V;c++)d=a.heap[c],f=i[2*i[2*d+1]+1]+1,f>o&&(f=o,p++),i[2*d+1]=f,d>j||(a.bl_count[f]++,g=0,d>=n&&(g=m[d-n]),h=i[2*d],a.opt_len+=h*(f+g),l&&(a.static_len+=h*(k[2*d+1]+g)));if(0!==p){do{for(f=o-1;0===a.bl_count[f];)f--;a.bl_count[f]--,a.bl_count[f+1]+=2,a.bl_count[o]--,p-=2}while(p>0);for(f=o;0!==f;f--)for(d=a.bl_count[f];0!==d;)e=a.heap[--c],e>j||(i[2*e+1]!==f&&(a.opt_len+=(f-i[2*e+1])*i[2*e],i[2*e+1]=f),d--)}}function n(a,b,c){var d,e,f=new Array(W+1),g=0;for(d=1;d<=W;d++)f[d]=g=g+c[d-1]<<1;for(e=0;e<=b;e++){var h=a[2*e+1];0!==h&&(a[2*e]=k(f[h]++,h))}}function o(){var a,b,c,d,f,g=new Array(W+1);for(c=0,d=0;d<Q-1;d++)for(ka[d]=c,a=0;a<1<<ba[d];a++)ja[c++]=d;for(ja[c-1]=d,f=0,d=0;d<16;d++)for(la[d]=f,a=0;a<1<<ca[d];a++)ia[f++]=d;for(f>>=7;d<T;d++)for(la[d]=f<<7,a=0;a<1<<ca[d]-7;a++)ia[256+f++]=d;for(b=0;b<=W;b++)g[b]=0;for(a=0;a<=143;)ga[2*a+1]=8,a++,g[8]++;for(;a<=255;)ga[2*a+1]=9,a++,g[9]++;for(;a<=279;)ga[2*a+1]=7,a++,g[7]++;for(;a<=287;)ga[2*a+1]=8,a++,g[8]++;for(n(ga,S+1,g),a=0;a<T;a++)ha[2*a+1]=5,ha[2*a]=k(a,5);ma=new e(ga,ba,R+1,S,W),na=new e(ha,ca,0,T,W),oa=new e(new Array(0),da,0,U,Y)}function p(a){var b;for(b=0;b<S;b++)a.dyn_ltree[2*b]=0;for(b=0;b<T;b++)a.dyn_dtree[2*b]=0;for(b=0;b<U;b++)a.bl_tree[2*b]=0;a.dyn_ltree[2*Z]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function q(a){a.bi_valid>8?h(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function r(a,b,c,d){q(a),d&&(h(a,c),h(a,~c)),G.arraySet(a.pending_buf,a.window,b,c,a.pending),a.pending+=c}function s(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function t(a,b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len&&(e<a.heap_len&&s(b,a.heap[e+1],a.heap[e],a.depth)&&e++,!s(b,d,a.heap[e],a.depth));)a.heap[c]=a.heap[e],c=e,e<<=1;a.heap[c]=d}function u(a,b,c){var d,e,f,h,k=0;if(0!==a.last_lit)do d=a.pending_buf[a.d_buf+2*k]<<8|a.pending_buf[a.d_buf+2*k+1],e=a.pending_buf[a.l_buf+k],k++,0===d?j(a,e,b):(f=ja[e],j(a,f+R+1,b),h=ba[f],0!==h&&(e-=ka[f],i(a,e,h)),d--,f=g(d),j(a,f,c),h=ca[f],0!==h&&(d-=la[f],i(a,d,h)));while(k<a.last_lit);j(a,Z,b)}function v(a,b){var c,d,e,f=b.dyn_tree,g=b.stat_desc.static_tree,h=b.stat_desc.has_stree,i=b.stat_desc.elems,j=-1;for(a.heap_len=0,a.heap_max=V,c=0;c<i;c++)0!==f[2*c]?(a.heap[++a.heap_len]=j=c,a.depth[c]=0):f[2*c+1]=0;for(;a.heap_len<2;)e=a.heap[++a.heap_len]=j<2?++j:0,f[2*e]=1,a.depth[e]=0,a.opt_len--,h&&(a.static_len-=g[2*e+1]);for(b.max_code=j,c=a.heap_len>>1;c>=1;c--)t(a,f,c);e=i;do c=a.heap[1],a.heap[1]=a.heap[a.heap_len--],t(a,f,1),d=a.heap[1],a.heap[--a.heap_max]=c,a.heap[--a.heap_max]=d,f[2*e]=f[2*c]+f[2*d],a.depth[e]=(a.depth[c]>=a.depth[d]?a.depth[c]:a.depth[d])+1,f[2*c+1]=f[2*d+1]=e,a.heap[1]=e++,t(a,f,1);while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1],m(a,b),n(f,j,a.bl_count)}function w(a,b,c){var d,e,f=-1,g=b[1],h=0,i=7,j=4;for(0===g&&(i=138,j=3),b[2*(c+1)+1]=65535,d=0;d<=c;d++)e=g,g=b[2*(d+1)+1],++h<i&&e===g||(h<j?a.bl_tree[2*e]+=h:0!==e?(e!==f&&a.bl_tree[2*e]++,a.bl_tree[2*$]++):h<=10?a.bl_tree[2*_]++:a.bl_tree[2*aa]++,h=0,f=e,0===g?(i=138,j=3):e===g?(i=6,j=3):(i=7,j=4))}function x(a,b,c){var d,e,f=-1,g=b[1],h=0,k=7,l=4;for(0===g&&(k=138,l=3),d=0;d<=c;d++)if(e=g,g=b[2*(d+1)+1],!(++h<k&&e===g)){if(h<l){do j(a,e,a.bl_tree);while(0!==--h)}else 0!==e?(e!==f&&(j(a,e,a.bl_tree),h--),j(a,$,a.bl_tree),i(a,h-3,2)):h<=10?(j(a,_,a.bl_tree),i(a,h-3,3)):(j(a,aa,a.bl_tree),i(a,h-11,7));h=0,f=e,0===g?(k=138,l=3):e===g?(k=6,l=3):(k=7,l=4)}}function y(a){var b;for(w(a,a.dyn_ltree,a.l_desc.max_code),w(a,a.dyn_dtree,a.d_desc.max_code),v(a,a.bl_desc),b=U-1;b>=3&&0===a.bl_tree[2*ea[b]+1];b--);return a.opt_len+=3*(b+1)+5+5+4,b}function z(a,b,c,d){var e;for(i(a,b-257,5),i(a,c-1,5),i(a,d-4,4),e=0;e<d;e++)i(a,a.bl_tree[2*ea[e]+1],3);x(a,a.dyn_ltree,b-1),x(a,a.dyn_dtree,c-1)}function A(a){var b,c=4093624447;for(b=0;b<=31;b++,c>>>=1)if(1&c&&0!==a.dyn_ltree[2*b])return I;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return J;for(b=32;b<R;b++)if(0!==a.dyn_ltree[2*b])return J;return I}function B(a){pa||(o(),pa=!0),a.l_desc=new f(a.dyn_ltree,ma),a.d_desc=new f(a.dyn_dtree,na),a.bl_desc=new f(a.bl_tree,oa),a.bi_buf=0,a.bi_valid=0,p(a)}function C(a,b,c,d){i(a,(L<<1)+(d?1:0),3),r(a,b,c,!0)}function D(a){i(a,M<<1,3),j(a,Z,ga),l(a)}function E(a,b,c,d){var e,f,g=0;a.level>0?(a.strm.data_type===K&&(a.strm.data_type=A(a)),v(a,a.l_desc),v(a,a.d_desc),g=y(a),e=a.opt_len+3+7>>>3,f=a.static_len+3+7>>>3,f<=e&&(e=f)):e=f=c+5,c+4<=e&&b!==-1?C(a,b,c,d):a.strategy===H||f===e?(i(a,(M<<1)+(d?1:0),3),u(a,ga,ha)):(i(a,(N<<1)+(d?1:0),3),z(a,a.l_desc.max_code+1,a.d_desc.max_code+1,g+1),u(a,a.dyn_ltree,a.dyn_dtree)),p(a),d&&q(a)}function F(a,b,c){return a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&b,a.pending_buf[a.l_buf+a.last_lit]=255&c,a.last_lit++,0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(ja[c]+R+1)]++,a.dyn_dtree[2*g(b)]++),a.last_lit===a.lit_bufsize-1}var G=c("../node_modules/pako/lib/utils/common.js"),H=4,I=0,J=1,K=2,L=0,M=1,N=2,O=3,P=258,Q=29,R=256,S=R+1+Q,T=30,U=19,V=2*S+1,W=15,X=16,Y=7,Z=256,$=16,_=17,aa=18,ba=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ca=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],da=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ea=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fa=512,ga=new Array(2*(S+2));d(ga);var ha=new Array(2*T);d(ha);var ia=new Array(fa);d(ia);var ja=new Array(P-O+1);d(ja);var ka=new Array(Q);d(ka);var la=new Array(T);d(la);var ma,na,oa,pa=!1;b._tr_init=B,b._tr_stored_block=C,b._tr_flush_block=E,b._tr_tally=F,b._tr_align=D},"../node_modules/pako/lib/zlib/zstream.js":function(a,b,c){"use strict";function d(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}a.exports=d},"../node_modules/process-nextick-args/index.js":function(a,b,c){"use strict";(function(b){function c(a,c,d,e){if("function"!=typeof a)throw new TypeError('"callback" argument must be a function');var f,g,h=arguments.length;switch(h){case 0:case 1:return b.nextTick(a);case 2:return b.nextTick(function(){a.call(null,c)});case 3:return b.nextTick(function(){a.call(null,c,d)});case 4:return b.nextTick(function(){a.call(null,c,d,e)});default:for(f=new Array(h-1),g=0;g<f.length;)f[g++]=arguments[g];return b.nextTick(function(){a.apply(null,f)})}}!b.version||0===b.version.indexOf("v0.")||0===b.version.indexOf("v1.")&&0!==b.version.indexOf("v1.8.")?a.exports={nextTick:c}:a.exports=b}).call(this,c("../node_modules/process/browser.js"))},"../node_modules/process/browser.js":function(a,b){function c(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}function e(a){if(k===setTimeout)return setTimeout(a,0);if((k===c||!k)&&setTimeout)return k=setTimeout,setTimeout(a,0);try{return k(a,0)}catch(b){try{return k.call(null,a,0)}catch(b){return k.call(this,a,0)}}}function f(a){if(l===clearTimeout)return clearTimeout(a);if((l===d||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(a);try{return l(a)}catch(b){try{return l.call(null,a)}catch(b){return l.call(this,a)}}}function g(){p&&n&&(p=!1,n.length?o=n.concat(o):q=-1,o.length&&h())}function h(){if(!p){var a=e(g);p=!0;for(var b=o.length;b;){for(n=o,o=[];++q<b;)n&&n[q].run();q=-1,b=o.length}n=null,p=!1,f(a)}}function i(a,b){this.fun=a,this.array=b}function j(){}var k,l,m=a.exports={};!function(){try{k="function"==typeof setTimeout?setTimeout:c}catch(a){k=c}try{l="function"==typeof clearTimeout?clearTimeout:d}catch(a){l=d}}();var n,o=[],p=!1,q=-1;m.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];o.push(new i(a,b)),1!==o.length||p||e(h)},i.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=j,m.addListener=j,m.once=j,m.off=j,m.removeListener=j,m.removeAllListeners=j,m.emit=j,m.prependListener=j,m.prependOnceListener=j,m.listeners=function(a){return[]},m.binding=function(a){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(a){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},"../node_modules/readable-stream/duplex-browser.js":function(a,b,c){a.exports=c("../node_modules/readable-stream/lib/_stream_duplex.js")},"../node_modules/readable-stream/lib/_stream_duplex.js":function(a,b,c){"use strict";function d(a){return this instanceof d?(j.call(this,a),k.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||g.nextTick(f,this)}function f(a){a.end()}var g=c("../node_modules/process-nextick-args/index.js"),h=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};a.exports=d;var i=c("../node_modules/core-util-is/lib/util.js");i.inherits=c("../node_modules/inherits/inherits_browser.js");var j=c("../node_modules/readable-stream/lib/_stream_readable.js"),k=c("../node_modules/readable-stream/lib/_stream_writable.js");i.inherits(d,j);for(var l=h(k.prototype),m=0;m<l.length;m++){var n=l[m];d.prototype[n]||(d.prototype[n]=k.prototype[n])}Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(a){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=a,this._writableState.destroyed=a)}}),d.prototype._destroy=function(a,b){this.push(null),this.end(),g.nextTick(b,a)}},"../node_modules/readable-stream/lib/_stream_passthrough.js":function(a,b,c){"use strict";function d(a){return this instanceof d?void e.call(this,a):new d(a)}a.exports=d;var e=c("../node_modules/readable-stream/lib/_stream_transform.js"),f=c("../node_modules/core-util-is/lib/util.js");f.inherits=c("../node_modules/inherits/inherits_browser.js"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},"../node_modules/readable-stream/lib/_stream_readable.js":function(a,b,c){"use strict";(function(b,d){function e(a){return L.from(a)}function f(a){return L.isBuffer(a)||a instanceof M}function g(a,b,c){return"function"==typeof a.prependListener?a.prependListener(b,c):void(a._events&&a._events[b]?I(a._events[b])?a._events[b].unshift(c):a._events[b]=[c,a._events[b]]:a.on(b,c))}function h(a,b){H=H||c("../node_modules/readable-stream/lib/_stream_duplex.js"),a=a||{};var d=b instanceof H;this.objectMode=!!a.objectMode,d&&(this.objectMode=this.objectMode||!!a.readableObjectMode);var e=a.highWaterMark,f=a.readableHighWaterMark,g=this.objectMode?16:16384;e||0===e?this.highWaterMark=e:d&&(f||0===f)?this.highWaterMark=f:this.highWaterMark=g,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new R,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=a.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,a.encoding&&(Q||(Q=c("../node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this.decoder=new Q(a.encoding),this.encoding=a.encoding)}function i(a){return H=H||c("../node_modules/readable-stream/lib/_stream_duplex.js"),this instanceof i?(this._readableState=new h(a,this),this.readable=!0,a&&("function"==typeof a.read&&(this._read=a.read),"function"==typeof a.destroy&&(this._destroy=a.destroy)),void K.call(this)):new i(a)}function j(a,b,c,d,f){var g=a._readableState;if(null===b)g.reading=!1,p(a,g);else{var h;f||(h=l(g,b)),h?a.emit("error",h):g.objectMode||b&&b.length>0?("string"==typeof b||g.objectMode||Object.getPrototypeOf(b)===L.prototype||(b=e(b)),d?g.endEmitted?a.emit("error",new Error("stream.unshift() after end event")):k(a,g,b,!0):g.ended?a.emit("error",new Error("stream.push() after EOF")):(g.reading=!1,g.decoder&&!c?(b=g.decoder.write(b),g.objectMode||0!==b.length?k(a,g,b,!1):s(a,g)):k(a,g,b,!1))):d||(g.reading=!1)}return m(g)}function k(a,b,c,d){b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,d?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&q(a)),s(a,b)}function l(a,b){var c;return f(b)||"string"==typeof b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function m(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function n(a){return a>=U?a=U:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function o(a,b){return a<=0||0===b.length&&b.ended?0:b.objectMode?1:a!==a?b.flowing&&b.length?b.buffer.head.data.length:b.length:(a>b.highWaterMark&&(b.highWaterMark=n(a)),a<=b.length?a:b.ended?b.length:(b.needReadable=!0,0))}function p(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,q(a)}}function q(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(P("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?G.nextTick(r,a):r(a))}function r(a){P("emit readable"),a.emit("readable"),y(a)}function s(a,b){b.readingMore||(b.readingMore=!0,G.nextTick(t,a,b))}function t(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(P("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function u(a){return function(){var b=a._readableState;P("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&J(a,"data")&&(b.flowing=!0,y(a))}}function v(a){P("readable nexttick read 0"),a.read(0)}function w(a,b){b.resumeScheduled||(b.resumeScheduled=!0,G.nextTick(x,a,b))}function x(a,b){b.reading||(P("resume read 0"),a.read(0)),b.resumeScheduled=!1,b.awaitDrain=0,a.emit("resume"),y(a),b.flowing&&!b.reading&&a.read(0)}function y(a){var b=a._readableState;for(P("flow",b.flowing);b.flowing&&null!==a.read(););}function z(a,b){if(0===b.length)return null;var c;return b.objectMode?c=b.buffer.shift():!a||a>=b.length?(c=b.decoder?b.buffer.join(""):1===b.buffer.length?b.buffer.head.data:b.buffer.concat(b.length),b.buffer.clear()):c=A(a,b.buffer,b.decoder),c}function A(a,b,c){var d;return a<b.head.data.length?(d=b.head.data.slice(0,a),b.head.data=b.head.data.slice(a)):d=a===b.head.data.length?b.shift():c?B(a,b):C(a,b),d}function B(a,b){var c=b.head,d=1,e=c.data;for(a-=e.length;c=c.next;){var f=c.data,g=a>f.length?f.length:a;if(e+=g===f.length?f:f.slice(0,a),a-=g,0===a){g===f.length?(++d,c.next?b.head=c.next:b.head=b.tail=null):(b.head=c,c.data=f.slice(g));break}++d}return b.length-=d,e}function C(a,b){var c=L.allocUnsafe(a),d=b.head,e=1;for(d.data.copy(c),a-=d.data.length;d=d.next;){var f=d.data,g=a>f.length?f.length:a;if(f.copy(c,c.length-a,0,g),a-=g,0===a){g===f.length?(++e,d.next?b.head=d.next:b.head=b.tail=null):(b.head=d,d.data=f.slice(g));break}++e}return b.length-=e,c}function D(a){var b=a._readableState;if(b.length>0)throw new Error('"endReadable()" called on non-empty stream');b.endEmitted||(b.ended=!0,G.nextTick(E,b,a))}function E(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function F(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}var G=c("../node_modules/process-nextick-args/index.js");a.exports=i;var H,I=c("../node_modules/isarray/index.js");i.ReadableState=h;var J=(c("../node_modules/events/events.js").EventEmitter,function(a,b){return a.listeners(b).length}),K=c("../node_modules/readable-stream/lib/internal/streams/stream-browser.js"),L=c("../node_modules/safe-buffer/index.js").Buffer,M=b.Uint8Array||function(){},N=c("../node_modules/core-util-is/lib/util.js");N.inherits=c("../node_modules/inherits/inherits_browser.js");var O=c(0),P=void 0;P=O&&O.debuglog?O.debuglog("stream"):function(){};var Q,R=c("../node_modules/readable-stream/lib/internal/streams/BufferList.js"),S=c("../node_modules/readable-stream/lib/internal/streams/destroy.js");N.inherits(i,K);var T=["error","close","destroy","pause","resume"];Object.defineProperty(i.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(a){this._readableState&&(this._readableState.destroyed=a)}}),i.prototype.destroy=S.destroy,i.prototype._undestroy=S.undestroy,i.prototype._destroy=function(a,b){this.push(null),b(a)},i.prototype.push=function(a,b){var c,d=this._readableState;return d.objectMode?c=!0:"string"==typeof a&&(b=b||d.defaultEncoding,b!==d.encoding&&(a=L.from(a,b),b=""),c=!0),j(this,a,b,!1,c)},i.prototype.unshift=function(a){return j(this,a,null,!0,!1)},i.prototype.isPaused=function(){return this._readableState.flowing===!1},i.prototype.setEncoding=function(a){return Q||(Q=c("../node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this._readableState.decoder=new Q(a),this._readableState.encoding=a,this};var U=8388608;i.prototype.read=function(a){P("read",a),a=parseInt(a,10);var b=this._readableState,c=a;if(0!==a&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return P("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?D(this):q(this),null;if(a=o(a,b),0===a&&b.ended)return 0===b.length&&D(this),null;var d=b.needReadable;P("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,P("length less than watermark",d)),b.ended||b.reading?(d=!1,P("reading or ended",d)):d&&(P("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(a=o(c,b)));var e;return e=a>0?z(a,b):null,null===e?(b.needReadable=!0,a=0):b.length-=a,0===b.length&&(b.ended||(b.needReadable=!0),c!==a&&b.ended&&D(this)),null!==e&&this.emit("data",e),e},i.prototype._read=function(a){this.emit("error",new Error("_read() is not implemented"))},i.prototype.pipe=function(a,b){function c(a,b){P("onunpipe"),a===m&&b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,f())}function e(){P("onend"),a.end()}function f(){P("cleanup"),a.removeListener("close",j),a.removeListener("finish",k),a.removeListener("drain",q),a.removeListener("error",i),a.removeListener("unpipe",c),m.removeListener("end",e),m.removeListener("end",l),m.removeListener("data",h),r=!0,!n.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function h(b){P("ondata"),s=!1;var c=a.write(b);!1!==c||s||((1===n.pipesCount&&n.pipes===a||n.pipesCount>1&&F(n.pipes,a)!==-1)&&!r&&(P("false write response, pause",m._readableState.awaitDrain),m._readableState.awaitDrain++,s=!0),m.pause())}function i(b){P("onerror",b),l(),a.removeListener("error",i),0===J(a,"error")&&a.emit("error",b)}function j(){a.removeListener("finish",k),l()}function k(){P("onfinish"),a.removeListener("close",j),l()}function l(){P("unpipe"),m.unpipe(a)}var m=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=a;break;case 1:n.pipes=[n.pipes,a];break;default:n.pipes.push(a)}n.pipesCount+=1,P("pipe count=%d opts=%j",n.pipesCount,b);var o=(!b||b.end!==!1)&&a!==d.stdout&&a!==d.stderr,p=o?e:l;n.endEmitted?G.nextTick(p):m.once("end",p),a.on("unpipe",c);var q=u(m);a.on("drain",q);var r=!1,s=!1;return m.on("data",h),g(a,"error",i),a.once("close",j),a.once("finish",k),a.emit("pipe",m),n.flowing||(P("pipe resume"),m.resume()),a},i.prototype.unpipe=function(a){var b=this._readableState,c={hasUnpiped:!1};if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this,c),this);if(!a){var d=b.pipes,e=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var f=0;f<e;f++)d[f].emit("unpipe",this,c);return this}var g=F(b.pipes,a);return g===-1?this:(b.pipes.splice(g,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this,c),this)},i.prototype.on=function(a,b){var c=K.prototype.on.call(this,a,b);if("data"===a)this._readableState.flowing!==!1&&this.resume();else if("readable"===a){var d=this._readableState;d.endEmitted||d.readableListening||(d.readableListening=d.needReadable=!0,d.emittedReadable=!1,d.reading?d.length&&q(this):G.nextTick(v,this))}return c},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var a=this._readableState;return a.flowing||(P("resume"),a.flowing=!0,w(this,a)),this},i.prototype.pause=function(){return P("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(P("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(a){var b=this,c=this._readableState,d=!1;a.on("end",function(){if(P("wrapped end"),c.decoder&&!c.ended){var a=c.decoder.end();a&&a.length&&b.push(a)}b.push(null)}),a.on("data",function(e){if(P("wrapped data"),c.decoder&&(e=c.decoder.write(e)),(!c.objectMode||null!==e&&void 0!==e)&&(c.objectMode||e&&e.length)){var f=b.push(e);f||(d=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));for(var f=0;f<T.length;f++)a.on(T[f],this.emit.bind(this,T[f]));return this._read=function(b){P("wrapped _read",b),d&&(d=!1,a.resume())},this},i._fromList=z}).call(this,c("../node_modules/webpack/buildin/global.js"),c("../node_modules/process/browser.js"))},"../node_modules/readable-stream/lib/_stream_transform.js":function(a,b,c){"use strict";function d(a,b){var c=this._transformState;c.transforming=!1;var d=c.writecb;if(!d)return this.emit("error",new Error("write callback called multiple times"));c.writechunk=null,c.writecb=null,null!=b&&this.push(b),d(a);var e=this._readableState;e.reading=!1,(e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}function e(a){return this instanceof e?(h.call(this,a),this._transformState={afterTransform:d.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),void this.on("prefinish",f)):new e(a)}function f(){var a=this;"function"==typeof this._flush?this._flush(function(b,c){g(a,b,c)}):g(this,null,null)}function g(a,b,c){if(b)return a.emit("error",b);if(null!=c&&a.push(c),a._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(a._transformState.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}a.exports=e;var h=c("../node_modules/readable-stream/lib/_stream_duplex.js"),i=c("../node_modules/core-util-is/lib/util.js");i.inherits=c("../node_modules/inherits/inherits_browser.js"),i.inherits(e,h),e.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},e.prototype._transform=function(a,b,c){throw new Error("_transform() is not implemented")},e.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},e.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0},e.prototype._destroy=function(a,b){var c=this;h.prototype._destroy.call(this,a,function(a){b(a),c.emit("close")})}},"../node_modules/readable-stream/lib/_stream_writable.js":function(a,b,c){"use strict";(function(b,d,e){function f(a){var b=this;this.next=null,this.entry=null,this.finish=function(){B(b,a)}}function g(a){return I.from(a)}function h(a){return I.isBuffer(a)||a instanceof J}function i(){}function j(a,b){D=D||c("../node_modules/readable-stream/lib/_stream_duplex.js"),a=a||{};var d=b instanceof D;this.objectMode=!!a.objectMode,d&&(this.objectMode=this.objectMode||!!a.writableObjectMode);var e=a.highWaterMark,g=a.writableHighWaterMark,h=this.objectMode?16:16384;e||0===e?this.highWaterMark=e:d&&(g||0===g)?this.highWaterMark=g:this.highWaterMark=h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=a.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){s(b,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new f(this)}function k(a){return D=D||c("../node_modules/readable-stream/lib/_stream_duplex.js"),L.call(k,this)||this instanceof D?(this._writableState=new j(a,this),this.writable=!0,a&&("function"==typeof a.write&&(this._write=a.write),"function"==typeof a.writev&&(this._writev=a.writev),"function"==typeof a.destroy&&(this._destroy=a.destroy),"function"==typeof a["final"]&&(this._final=a["final"])),void H.call(this)):new k(a)}function l(a,b){var c=new Error("write after end");a.emit("error",c),C.nextTick(b,c)}function m(a,b,c,d){var e=!0,f=!1;return null===c?f=new TypeError("May not write null values to stream"):"string"==typeof c||void 0===c||b.objectMode||(f=new TypeError("Invalid non-string/buffer chunk")),f&&(a.emit("error",f),C.nextTick(d,f),e=!1),e}function n(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=I.from(b,c)),b}function o(a,b,c,d,e,f){if(!c){var g=n(b,d,e);d!==g&&(c=!0,e="buffer",d=g)}var h=b.objectMode?1:d.length;b.length+=h;var i=b.length<b.highWaterMark;if(i||(b.needDrain=!0),b.writing||b.corked){var j=b.lastBufferedRequest;b.lastBufferedRequest={chunk:d,encoding:e,isBuf:c,callback:f,next:null},j?j.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else p(a,b,!1,h,d,e,f);return i}function p(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function q(a,b,c,d,e){--b.pendingcb,c?(C.nextTick(e,d),C.nextTick(z,a,b),a._writableState.errorEmitted=!0,a.emit("error",d)):(e(d),a._writableState.errorEmitted=!0,a.emit("error",d),z(a,b))}function r(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function s(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(r(c),b)q(a,c,d,b,e);else{var f=w(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||v(a,c),d?E(t,a,c,f,e):t(a,c,f,e)}}function t(a,b,c,d){c||u(a,b),b.pendingcb--,d(),z(a,b)}function u(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function v(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,e=new Array(d),g=b.corkedRequestsFree;g.entry=c;for(var h=0,i=!0;c;)e[h]=c,c.isBuf||(i=!1),c=c.next,h+=1;e.allBuffers=i,p(a,b,!0,b.length,e,"",g.finish),b.pendingcb++,b.lastBufferedRequest=null,g.next?(b.corkedRequestsFree=g.next,g.next=null):b.corkedRequestsFree=new f(b),b.bufferedRequestCount=0}else{for(;c;){var j=c.chunk,k=c.encoding,l=c.callback,m=b.objectMode?1:j.length;if(p(a,b,!1,m,j,k,l),c=c.next,b.bufferedRequestCount--,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequest=c,b.bufferProcessing=!1}function w(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function x(a,b){a._final(function(c){b.pendingcb--,c&&a.emit("error",c),b.prefinished=!0,a.emit("prefinish"),z(a,b)})}function y(a,b){b.prefinished||b.finalCalled||("function"==typeof a._final?(b.pendingcb++,b.finalCalled=!0,C.nextTick(x,a,b)):(b.prefinished=!0,a.emit("prefinish")))}function z(a,b){var c=w(b);return c&&(y(a,b),0===b.pendingcb&&(b.finished=!0,a.emit("finish"))),c}function A(a,b,c){b.ending=!0,z(a,b),c&&(b.finished?C.nextTick(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function B(a,b,c){var d=a.entry;for(a.entry=null;d;){var e=d.callback;b.pendingcb--,e(c),d=d.next}b.corkedRequestsFree?b.corkedRequestsFree.next=a:b.corkedRequestsFree=a}var C=c("../node_modules/process-nextick-args/index.js");a.exports=k;var D,E=!b.browser&&["v0.10","v0.9."].indexOf(b.version.slice(0,5))>-1?d:C.nextTick;k.WritableState=j;var F=c("../node_modules/core-util-is/lib/util.js");F.inherits=c("../node_modules/inherits/inherits_browser.js");var G={deprecate:c("../node_modules/util-deprecate/browser.js")},H=c("../node_modules/readable-stream/lib/internal/streams/stream-browser.js"),I=c("../node_modules/safe-buffer/index.js").Buffer,J=e.Uint8Array||function(){},K=c("../node_modules/readable-stream/lib/internal/streams/destroy.js");F.inherits(k,H),j.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(j.prototype,"buffer",{get:G.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(a){}}();var L;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(a){return!!L.call(this,a)||this===k&&(a&&a._writableState instanceof j)}})):L=function(a){return a instanceof this},k.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},k.prototype.write=function(a,b,c){var d=this._writableState,e=!1,f=!d.objectMode&&h(a);return f&&!I.isBuffer(a)&&(a=g(a)),"function"==typeof b&&(c=b,b=null),f?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=i),d.ended?l(this,c):(f||m(this,d,a,c))&&(d.pendingcb++,e=o(this,d,f,a,b,c)),e},k.prototype.cork=function(){var a=this._writableState;a.corked++},k.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||v(this,a))},k.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);return this._writableState.defaultEncoding=a,this},k.prototype._write=function(a,b,c){c(new Error("_write() is not implemented"))},k.prototype._writev=null,k.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||A(this,d,c)},Object.defineProperty(k.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(a){this._writableState&&(this._writableState.destroyed=a)}}),k.prototype.destroy=K.destroy,k.prototype._undestroy=K.undestroy,k.prototype._destroy=function(a,b){this.end(),b(a)}}).call(this,c("../node_modules/process/browser.js"),c("../node_modules/timers-browserify/main.js").setImmediate,c("../node_modules/webpack/buildin/global.js"))},"../node_modules/readable-stream/lib/internal/streams/BufferList.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function e(a,b,c){a.copy(b,c)}var f=c("../node_modules/safe-buffer/index.js").Buffer,g=c(1);a.exports=function(){function a(){d(this,a),this.head=null,this.tail=null,this.length=0}return a.prototype.push=function(a){var b={data:a,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length},a.prototype.unshift=function(a){var b={data:a,next:this.head};0===this.length&&(this.tail=b),this.head=b,++this.length},a.prototype.shift=function(){if(0!==this.length){var a=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,a}},a.prototype.clear=function(){this.head=this.tail=null,this.length=0},a.prototype.join=function(a){if(0===this.length)return"";for(var b=this.head,c=""+b.data;b=b.next;)c+=a+b.data;return c},a.prototype.concat=function(a){if(0===this.length)return f.alloc(0);if(1===this.length)return this.head.data;for(var b=f.allocUnsafe(a>>>0),c=this.head,d=0;c;)e(c.data,b,d),d+=c.data.length,c=c.next;return b},a}(),g&&g.inspect&&g.inspect.custom&&(a.exports.prototype[g.inspect.custom]=function(){var a=g.inspect({length:this.length});return this.constructor.name+" "+a})},"../node_modules/readable-stream/lib/internal/streams/destroy.js":function(a,b,c){"use strict";function d(a,b){var c=this,d=this._readableState&&this._readableState.destroyed,e=this._writableState&&this._writableState.destroyed;return d||e?(b?b(a):!a||this._writableState&&this._writableState.errorEmitted||g.nextTick(f,this,a),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(a){!b&&a?(g.nextTick(f,c,a),c._writableState&&(c._writableState.errorEmitted=!0)):b&&b(a)}),this)}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function f(a,b){a.emit("error",b)}var g=c("../node_modules/process-nextick-args/index.js");a.exports={destroy:d,undestroy:e}},"../node_modules/readable-stream/lib/internal/streams/stream-browser.js":function(a,b,c){a.exports=c("../node_modules/events/events.js").EventEmitter},"../node_modules/readable-stream/passthrough.js":function(a,b,c){a.exports=c("../node_modules/readable-stream/readable-browser.js").PassThrough},"../node_modules/readable-stream/readable-browser.js":function(a,b,c){b=a.exports=c("../node_modules/readable-stream/lib/_stream_readable.js"),b.Stream=b,b.Readable=b,b.Writable=c("../node_modules/readable-stream/lib/_stream_writable.js"),b.Duplex=c("../node_modules/readable-stream/lib/_stream_duplex.js"),b.Transform=c("../node_modules/readable-stream/lib/_stream_transform.js"),b.PassThrough=c("../node_modules/readable-stream/lib/_stream_passthrough.js")},"../node_modules/readable-stream/transform.js":function(a,b,c){a.exports=c("../node_modules/readable-stream/readable-browser.js").Transform},"../node_modules/readable-stream/writable-browser.js":function(a,b,c){a.exports=c("../node_modules/readable-stream/lib/_stream_writable.js")},"../node_modules/safe-buffer/index.js":function(a,b,c){function d(a,b){for(var c in a)b[c]=a[c]}function e(a,b,c){return g(a,b,c)}var f=c("../node_modules/buffer/index.js"),g=f.Buffer;g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?a.exports=f:(d(f,b),b.Buffer=e),d(g,e),e.from=function(a,b,c){if("number"==typeof a)throw new TypeError("Argument must not be a number");return g(a,b,c)},e.alloc=function(a,b,c){if("number"!=typeof a)throw new TypeError("Argument must be a number");var d=g(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},e.allocUnsafe=function(a){if("number"!=typeof a)throw new TypeError("Argument must be a number");return g(a)},e.allocUnsafeSlow=function(a){if("number"!=typeof a)throw new TypeError("Argument must be a number");return f.SlowBuffer(a)}},"../node_modules/setimmediate/setImmediate.js":function(a,b,c){(function(a,b){!function(a,c){"use strict";function d(a){"function"!=typeof a&&(a=new Function(""+a));for(var b=new Array(arguments.length-1),c=0;c<b.length;c++)b[c]=arguments[c+1];var d={callback:a,args:b};return p[o]=d,n(o),o++}function e(a){delete p[a]}function f(a){var b=a.callback,d=a.args;switch(d.length){case 0:b();break;case 1:b(d[0]);break;case 2:b(d[0],d[1]);break;case 3:b(d[0],d[1],d[2]);break;default:b.apply(c,d)}}function g(a){if(q)setTimeout(g,0,a);else{var b=p[a];if(b){q=!0;try{f(b)}finally{e(a),q=!1}}}}function h(){n=function(a){b.nextTick(function(){g(a)})}}function i(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}function j(){var b="setImmediate$"+Math.random()+"$",c=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&g(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",c,!1):a.attachEvent("onmessage",c),n=function(c){a.postMessage(b+c,"*")}}function k(){var a=new MessageChannel;a.port1.onmessage=function(a){var b=a.data;g(b)},n=function(b){a.port2.postMessage(b)}}function l(){var a=r.documentElement;n=function(b){var c=r.createElement("script");c.onreadystatechange=function(){g(b),c.onreadystatechange=null,a.removeChild(c),c=null},a.appendChild(c)}}function m(){n=function(a){setTimeout(g,0,a)}}if(!a.setImmediate){var n,o=1,p={},q=!1,r=a.document,s=Object.getPrototypeOf&&Object.getPrototypeOf(a);s=s&&s.setTimeout?s:a,"[object process]"==={}.toString.call(a.process)?h():i()?j():a.MessageChannel?k():r&&"onreadystatechange"in r.createElement("script")?l():m(),s.setImmediate=d,s.clearImmediate=e}}("undefined"==typeof self?"undefined"==typeof a?this:a:self)}).call(this,c("../node_modules/webpack/buildin/global.js"),c("../node_modules/process/browser.js"))},"../node_modules/stream-browserify/index.js":function(a,b,c){function d(){e.call(this)}a.exports=d;var e=c("../node_modules/events/events.js").EventEmitter,f=c("../node_modules/inherits/inherits_browser.js");f(d,e),d.Readable=c("../node_modules/readable-stream/readable-browser.js"),d.Writable=c("../node_modules/readable-stream/writable-browser.js"),d.Duplex=c("../node_modules/readable-stream/duplex-browser.js"),d.Transform=c("../node_modules/readable-stream/transform.js"),d.PassThrough=c("../node_modules/readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},"../node_modules/string_decoder/lib/string_decoder.js":function(a,b,c){"use strict";function d(a){if(!a)return"utf8";for(var b;;)switch(a){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return a;default:if(b)return;a=(""+a).toLowerCase(),b=!0}}function e(a){var b=d(a);if("string"!=typeof b&&(s.isEncoding===t||!t(a)))throw new Error("Unknown encoding: "+a);return b||a}function f(a){this.encoding=e(a);var b;switch(this.encoding){case"utf16le":this.text=m,this.end=n,b=4;break;case"utf8":this.fillLast=j,b=4;break;case"base64":this.text=o,this.end=p,b=3;break;default:return this.write=q,void(this.end=r)}this.lastNeed=0,this.lastTotal=0,this.lastChar=s.allocUnsafe(b)}function g(a){return a<=127?0:a>>5===6?2:a>>4===14?3:a>>3===30?4:-1}function h(a,b,c){var d=b.length-1;if(d<c)return 0;var e=g(b[d]);return e>=0?(e>0&&(a.lastNeed=e-1),e):--d<c?0:(e=g(b[d]),e>=0?(e>0&&(a.lastNeed=e-2),e):--d<c?0:(e=g(b[d]),e>=0?(e>0&&(2===e?e=0:a.lastNeed=e-3),e):0))}function i(a,b,c){if(128!==(192&b[0]))return a.lastNeed=0,"".repeat(c);if(a.lastNeed>1&&b.length>1){if(128!==(192&b[1]))return a.lastNeed=1,"".repeat(c+1);if(a.lastNeed>2&&b.length>2&&128!==(192&b[2]))return a.lastNeed=2,"".repeat(c+2)}}function j(a){var b=this.lastTotal-this.lastNeed,c=i(this,a,b);return void 0!==c?c:this.lastNeed<=a.length?(a.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(a.copy(this.lastChar,b,0,a.length),void(this.lastNeed-=a.length))}function k(a,b){var c=h(this,a,b);if(!this.lastNeed)return a.toString("utf8",b);this.lastTotal=c;var d=a.length-(c-this.lastNeed);return a.copy(this.lastChar,0,d),a.toString("utf8",b,d)}function l(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+"".repeat(this.lastTotal-this.lastNeed):b}function m(a,b){if((a.length-b)%2===0){var c=a.toString("utf16le",b);if(c){var d=c.charCodeAt(c.length-1);if(d>=55296&&d<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1],c.slice(0,-1)}return c}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=a[a.length-1],a.toString("utf16le",b,a.length-1)}function n(a){var b=a&&a.length?this.write(a):"";if(this.lastNeed){var c=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,c)}return b}function o(a,b){var c=(a.length-b)%3;return 0===c?a.toString("base64",b):(this.lastNeed=3-c,this.lastTotal=3,1===c?this.lastChar[0]=a[a.length-1]:(this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1]),a.toString("base64",b,a.length-c))}function p(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function q(a){return a.toString(this.encoding)}function r(a){return a&&a.length?this.write(a):""}var s=c("../node_modules/safe-buffer/index.js").Buffer,t=s.isEncoding||function(a){switch(a=""+a,a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};b.StringDecoder=f,f.prototype.write=function(a){if(0===a.length)return"";var b,c;if(this.lastNeed){if(b=this.fillLast(a),void 0===b)return"";c=this.lastNeed,this.lastNeed=0}else c=0;return c<a.length?b?b+this.text(a,c):this.text(a,c):b||""},f.prototype.end=l,f.prototype.text=k,f.prototype.fillLast=function(a){return this.lastNeed<=a.length?(a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,a.length),void(this.lastNeed-=a.length))}},"../node_modules/timers-browserify/main.js":function(a,b,c){(function(a){function d(a,b){this._id=a,this._clearFn=b}var e=Function.prototype.apply;b.setTimeout=function(){return new d(e.call(setTimeout,window,arguments),clearTimeout)},b.setInterval=function(){return new d(e.call(setInterval,window,arguments),clearInterval)},b.clearTimeout=b.clearInterval=function(a){a&&a.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},b.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},b.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},b._unrefActive=b.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c("../node_modules/setimmediate/setImmediate.js"),b.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof a&&a.setImmediate||this&&this.setImmediate,b.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof a&&a.clearImmediate||this&&this.clearImmediate}).call(this,c("../node_modules/webpack/buildin/global.js"))},"../node_modules/util-deprecate/browser.js":function(a,b,c){(function(b){function c(a,b){function c(){if(!e){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),e=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var e=!1;return c}function d(a){try{if(!b.localStorage)return!1}catch(c){return!1}var d=b.localStorage[a];return null!=d&&"true"===String(d).toLowerCase()}a.exports=c}).call(this,c("../node_modules/webpack/buildin/global.js"))},"../node_modules/util/node_modules/inherits/inherits_browser.js":function(a,b){"function"==typeof Object.create?a.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},"../node_modules/util/support/isBufferBrowser.js":function(a,b){a.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},"../node_modules/util/util.js":function(a,b,c){(function(a,d){function e(a,c){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(c)?d.showHidden=c:c&&b._extend(d,c),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,c,d){if(a.customInspect&&c&&A(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c)){var e=c.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,c);if(f)return f;var g=Object.keys(c),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(c)),z(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(c);if(0===g.length){if(A(c)){var q=c.name?": "+c.name:"";return a.stylize("[Function"+q+"]","special")}if(w(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(y(c))return a.stylize(Date.prototype.toString.call(c),"date");if(z(c))return k(c)}var r="",s=!1,u=["{","}"];if(o(c)&&(s=!0,u=["[","]"]),A(c)){var v=c.name?": "+c.name:"";r=" [Function"+v+"]"}if(w(c)&&(r=" "+RegExp.prototype.toString.call(c)),y(c)&&(r=" "+Date.prototype.toUTCString.call(c)),z(c)&&(r=" "+k(c)),0===g.length&&(!s||0==c.length))return u[0]+r+u[1];if(d<0)return w(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special");a.seen.push(c);var x;return x=s?l(a,c,d,p,g):g.map(function(b){return m(a,c,d,p,b,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return a<10?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;b.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},b.deprecate=function(c,e){function f(){if(!g){if(d.throwDeprecation)throw new Error(e);d.traceDeprecation?console.trace(e):console.error(e),g=!0}return c.apply(this,arguments)}if(v(a.process))return function(){return b.deprecate(c,e).apply(this,arguments)};if(d.noDeprecation===!0)return c;var g=!1;return f};var H,I={};b.debuglog=function(a){if(v(H)&&(H=d.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var c=d.pid;I[a]=function(){var d=b.format.apply(b,arguments);console.error("%s %d: %s",a,c,d)}}else I[a]=function(){};return I[a]},b.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},b.isArray=o,b.isBoolean=p,b.isNull=q,b.isNullOrUndefined=r,b.isNumber=s,b.isString=t,b.isSymbol=u,b.isUndefined=v,b.isRegExp=w,b.isObject=x,b.isDate=y,b.isError=z,b.isFunction=A,b.isPrimitive=B,b.isBuffer=c("../node_modules/util/support/isBufferBrowser.js");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];b.log=function(){console.log("%s - %s",E(),b.format.apply(b,arguments))},b.inherits=c("../node_modules/util/node_modules/inherits/inherits_browser.js"),b._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,c("../node_modules/webpack/buildin/global.js"),c("../node_modules/process/browser.js"))},"../node_modules/webpack/buildin/global.js":function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()||(0,eval)("this")}catch(d){"object"==typeof window&&(c=window)}a.exports=c},"../node_modules/webpack/buildin/module.js":function(a,b){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children||(a.children=[]),Object.defineProperty(a,"loaded",{enumerable:!0,get:function(){return a.l}}),Object.defineProperty(a,"id",{enumerable:!0,get:function(){return a.i}}),a.webpackPolyfill=1),a}},"./alloc.js":function(a,b,c){"use strict";(function(a){function c(b,c){if("undefined"!=typeof a&&b instanceof a)return a.alloc(c);if(b instanceof Uint8Array)return new Uint8Array(c);throw"dicomParser.alloc: unknown type for byteArray"}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=c}).call(this,c("../node_modules/buffer/index.js").Buffer)},"./bigEndianByteArrayParser.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]={readUint16:function(a,b){if(b<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";return b+2>a.length&&console.log("bigEndianByteArrayParser.readUint16: attempt to read past end of buffer"),(a[b]<<8)+a[b+1]},readInt16:function(a,b){if(b<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";b+2>a.length&&console.log("bigEndianByteArrayParser.readInt16: attempt to read past end of buffer");var c=(a[b]<<8)+a[b+1];return 32768&c&&(c=c-65535-1),c},readUint32:function(a,b){if(b<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";b+4>a.length&&console.log("bigEndianByteArrayParser.readUint32: attempt to read past end of buffer");var c=256*(256*(256*a[b]+a[b+1])+a[b+2])+a[b+3];return c},readInt32:function(a,b){if(b<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";b+4>a.length&&console.log("bigEndianByteArrayParser.readInt32: attempt to read past end of buffer");var c=(a[b]<<24)+(a[b+1]<<16)+(a[b+2]<<8)+a[b+3];return c},readFloat:function(a,b){if(b<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";b+4>a.length&&console.log("bigEndianByteArrayParser.readFloat: attempt to read past end of buffer");var c=new Uint8Array(4);c[3]=a[b],c[2]=a[b+1],c[1]=a[b+2],c[0]=a[b+3];var d=new Float32Array(c.buffer);return d[0]},readDouble:function(a,b){if(b<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";b+8>a.length&&console.log("bigEndianByteArrayParser.readDouble: attempt to read past end of buffer");var c=new Uint8Array(8);c[7]=a[b],c[6]=a[b+1],c[5]=a[b+2],c[4]=a[b+3],c[3]=a[b+4],c[2]=a[b+5],c[1]=a[b+6],c[0]=a[b+7];var d=new Float64Array(c.buffer);return d[0]}}},"./byteArrayParser.js":function(a,b,c){"use strict";function d(a,b,c){if(c<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(b+c>a.length)return console.log("bigEndianByteArrayParser.readFixedString: attempt to read past end of buffer"),"";for(var d,e="",f=0;f<c;f++){if(d=a[b+f],0===d)return b+=c,e;e+=String.fromCharCode(d)}return e}Object.defineProperty(b,"__esModule",{value:!0}),b.readFixedString=d},"./byteStream.js":function(a,b,c){"use strict";(function(a){function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c("./sharedCopy.js"),h=d(g),i=c("./byteArrayParser.js"),j=function(){function b(c,d,f){if(e(this,b),void 0===c)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===d)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(d instanceof Uint8Array==!1&&d instanceof a==!1)throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(f<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(f>=d.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=c,this.byteArray=d,this.position=f?f:0,this.warnings=[]}return f(b,[{key:"seek",value:function(a){if(this.position+a<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=a}},{key:"readByteStream",value:function(a){if(this.position+a>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var c=(0,h["default"])(this.byteArray,this.position,a);return this.position+=a,new b(this.byteArrayParser,c)}},{key:"readUint16",value:function(){var a=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,a}},{key:"readUint32",value:function(){var a=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,a}},{key:"readFixedString",value:function(a){var b=(0,i.readFixedString)(this.byteArray,this.position,a);return this.position+=a,b}}]),b}();b["default"]=j}).call(this,c("../node_modules/buffer/index.js").Buffer)},"./dataSet.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){return void 0!==a.parser?a.parser:b}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c("./byteArrayParser.js"),h=function(){function a(b,c,e){d(this,a),this.byteArrayParser=b,this.byteArray=c,this.elements=e}return f(a,[{key:"uint16",value:function(a,b){var c=this.elements[a];if(b=void 0!==b?b:0,c&&0!==c.length)return e(c,this.byteArrayParser).readUint16(this.byteArray,c.dataOffset+2*b)}},{key:"int16",value:function(a,b){var c=this.elements[a];if(b=void 0!==b?b:0,c&&0!==c.length)return e(c,this.byteArrayParser).readInt16(this.byteArray,c.dataOffset+2*b)}},{key:"uint32",value:function(a,b){var c=this.elements[a];if(b=void 0!==b?b:0,c&&0!==c.length)return e(c,this.byteArrayParser).readUint32(this.byteArray,c.dataOffset+4*b)}},{key:"int32",value:function(a,b){var c=this.elements[a];if(b=void 0!==b?b:0,c&&0!==c.length)return e(c,this.byteArrayParser).readInt32(this.byteArray,c.dataOffset+4*b)}},{key:"float",value:function(a,b){var c=this.elements[a];if(b=void 0!==b?b:0,c&&0!==c.length)return e(c,this.byteArrayParser).readFloat(this.byteArray,c.dataOffset+4*b)}},{key:"double",value:function(a,b){var c=this.elements[a];if(b=void 0!==b?b:0,c&&0!==c.length)return e(c,this.byteArrayParser).readDouble(this.byteArray,c.dataOffset+8*b)}},{key:"numStringValues",value:function(a){var b=this.elements[a];if(b&&b.length>0){var c=(0,g.readFixedString)(this.byteArray,b.dataOffset,b.length),d=c.match(/\\/g);return null===d?1:d.length+1}}},{key:"string",value:function(a,b){var c=this.elements[a];if(c&&c.length>0){var d=(0,g.readFixedString)(this.byteArray,c.dataOffset,c.length);if(b>=0){var e=d.split("\\");return e[b].trim()}return d.trim()}}},{key:"text",value:function(a,b){var c=this.elements[a];if(c&&c.length>0){var d=(0,g.readFixedString)(this.byteArray,c.dataOffset,c.length);if(b>=0){var e=d.split("\\");return e[b].replace(/ +$/,"")}return d.replace(/ +$/,"")}}},{key:"floatString",value:function(a,b){var c=this.elements[a];if(c&&c.length>0){b=void 0!==b?b:0;var d=this.string(a,b);if(void 0!==d)return parseFloat(d)}}},{key:"intString",value:function(a,b){var c=this.elements[a];if(c&&c.length>0){b=void 0!==b?b:0;var d=this.string(a,b);if(void 0!==d)return parseInt(d)}}},{key:"attributeTag",value:function(a){var b=this.elements[a];if(b&&4===b.length){var c=e(b,this.byteArrayParser).readUint16,d=this.byteArray,f=b.dataOffset;return"x"+("00000000"+(256*c(d,f)*256+c(d,f+2)).toString(16)).substr(-8)}}}]),a}();b["default"]=h},"./findAndSetUNElementLength.js":function(a,b,c){"use strict";function d(a,b){if(void 0===a)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var c=8,d=a.byteArray.length-c;a.position<=d;){var e=a.readUint16();if(65534===e){var f=a.readUint16();if(57565===f){var g=a.readUint32();return 0!==g&&a.warnings("encountered non zero length following item delimiter at position "+(a.position-4)+" while reading element of undefined length with tag "+b.tag),b.length=a.position-b.dataOffset,void console.log(e,f,a)}}}b.length=a.byteArray.length-b.dataOffset,a.seek(a.byteArray.length-a.position)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d},"./findEndOfEncapsulatedPixelData.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){if(void 0===a)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===b)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";b.encapsulatedPixelData=!0,b.basicOffsetTable=[],b.fragments=[];var d=(0,g["default"])(a);if("xfffee000"!==d)throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var e=a.readUint32(),f=e/4,h=0;h<f;h++){var i=a.readUint32();b.basicOffsetTable.push(i)}for(var j=a.position;a.position<a.byteArray.length;){var k=(0,g["default"])(a),l=a.readUint32();if("xfffee0dd"===k)return a.seek(l),void(b.length=a.position-b.dataOffset);if("xfffee000"!==k)return c&&c.push("unexpected tag "+k+" while searching for end of pixel data element with undefined length"),l>a.byteArray.length-a.position&&(l=a.byteArray.length-a.position),b.fragments.push({offset:a.position-j-8,position:a.position,length:l}),a.seek(l),void(b.length=a.position-b.dataOffset);b.fragments.push({offset:a.position-j-8,position:a.position,length:l}),a.seek(l)}c&&c.push("pixel data element "+b.tag+" missing sequence delimiter tag xfffee0dd")}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./readTag.js"),g=d(f)},"./findItemDelimitationItem.js":function(a,b,c){"use strict";function d(a,b){if(void 0===a)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var c=8,d=a.byteArray.length-c;a.position<=d;){var e=a.readUint16();if(65534===e){var f=a.readUint16();if(57357===f){var g=a.readUint32();return 0!==g&&a.warnings("encountered non zero length following item delimiter at position "+(a.position-4)+" while reading element of undefined length with tag "+b.tag),void(b.length=a.position-b.dataOffset)}}}b.length=a.byteArray.length-b.dataOffset,a.seek(a.byteArray.length-a.position)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d},"./index.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c("./util/index.js");Object.keys(e).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(b,a,{enumerable:!0,get:function(){return e[a]}})});var f=c("./parseDicomDataSet.js");Object.keys(f).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(b,a,{enumerable:!0,get:function(){return f[a]}})});var g=c("./byteArrayParser.js");Object.keys(g).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(b,a,{enumerable:!0,get:function(){return g[a]}})});var h=c("./alloc.js");Object.defineProperty(b,"alloc",{enumerable:!0,get:function(){return d(h)["default"]}});var i=c("./version.js");Object.defineProperty(b,"version",{enumerable:!0,get:function(){return d(i)["default"]}});var j=c("./bigEndianByteArrayParser.js");Object.defineProperty(b,"bigEndianByteArrayParser",{enumerable:!0,get:function(){return d(j)["default"]}});var k=c("./byteStream.js");Object.defineProperty(b,"ByteStream",{enumerable:!0,get:function(){return d(k)["default"]}});var l=c("./sharedCopy.js");Object.defineProperty(b,"sharedCopy",{enumerable:!0,get:function(){return d(l)["default"]}});var m=c("./dataSet.js");Object.defineProperty(b,"DataSet",{enumerable:!0,get:function(){return d(m)["default"]}});var n=c("./findAndSetUNElementLength.js");Object.defineProperty(b,"findAndSetUNElementLength",{enumerable:!0,get:function(){return d(n)["default"]}});var o=c("./findEndOfEncapsulatedPixelData.js");
Object.defineProperty(b,"findEndOfEncapsulatedElement",{enumerable:!0,get:function(){return d(o)["default"]}});var p=c("./findItemDelimitationItem.js");Object.defineProperty(b,"findItemDelimitationItemAndSetElementLength",{enumerable:!0,get:function(){return d(p)["default"]}});var q=c("./littleEndianByteArrayParser.js");Object.defineProperty(b,"littleEndianByteArrayParser",{enumerable:!0,get:function(){return d(q)["default"]}});var r=c("./parseDicom.js");Object.defineProperty(b,"parseDicom",{enumerable:!0,get:function(){return d(r)["default"]}});var s=c("./readDicomElementExplicit.js");Object.defineProperty(b,"readDicomElementExplicit",{enumerable:!0,get:function(){return d(s)["default"]}});var t=c("./readDicomElementImplicit.js");Object.defineProperty(b,"readDicomElementImplicit",{enumerable:!0,get:function(){return d(t)["default"]}});var u=c("./readEncapsulatedImageFrame.js");Object.defineProperty(b,"readEncapsulatedImageFrame",{enumerable:!0,get:function(){return d(u)["default"]}});var v=c("./readEncapsulatedPixelData.js");Object.defineProperty(b,"readEncapsulatedPixelData",{enumerable:!0,get:function(){return d(v)["default"]}});var w=c("./readEncapsulatedPixelDataFromFragments.js");Object.defineProperty(b,"readEncapsulatedPixelDataFromFragments",{enumerable:!0,get:function(){return d(w)["default"]}});var x=c("./readPart10Header.js");Object.defineProperty(b,"readPart10Header",{enumerable:!0,get:function(){return d(x)["default"]}});var y=c("./readSequenceElementExplicit.js");Object.defineProperty(b,"readSequenceItemsExplicit",{enumerable:!0,get:function(){return d(y)["default"]}});var z=c("./readSequenceElementImplicit.js");Object.defineProperty(b,"readSequenceItemsImplicit",{enumerable:!0,get:function(){return d(z)["default"]}});var A=c("./readSequenceItem.js");Object.defineProperty(b,"readSequenceItem",{enumerable:!0,get:function(){return d(A)["default"]}});var B=c("./readTag.js");Object.defineProperty(b,"readTag",{enumerable:!0,get:function(){return d(B)["default"]}})},"./littleEndianByteArrayParser.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]={readUint16:function(a,b){if(b<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";return b+2>a.length?void console.log("littleEndianByteArrayParser.readUint16: attempt to read past end of buffer",b):a[b]+256*a[b+1]},readInt16:function(a,b){if(b<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";b+2>a.length&&console.log("littleEndianByteArrayParser.readInt16: attempt to read past end of buffer");var c=a[b]+(a[b+1]<<8);return 32768&c&&(c=c-65535-1),c},readUint32:function(a,b){if(b<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";return b+4>a.length&&console.log("littleEndianByteArrayParser.readUint32: attempt to read past end of buffer"),a[b]+256*a[b+1]+256*a[b+2]*256+256*a[b+3]*256*256},readInt32:function(a,b){if(b<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";return b+4>a.length&&console.log("littleEndianByteArrayParser.readInt32: attempt to read past end of buffer"),a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24)},readFloat:function(a,b){if(b<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";b+4>a.length&&console.log("littleEndianByteArrayParser.readFloat: attempt to read past end of buffer");var c=new Uint8Array(4);c[0]=a[b],c[1]=a[b+1],c[2]=a[b+2],c[3]=a[b+3];var d=new Float32Array(c.buffer);return d[0]},readDouble:function(a,b){if(b<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";b+8>a.length&&console.log("littleEndianByteArrayParser.readDouble: attempt to read past end of buffer");var c=new Uint8Array(8);c[0]=a[b],c[1]=a[b+1],c[2]=a[b+2],c[3]=a[b+3],c[4]=a[b+4],c[5]=a[b+5],c[6]=a[b+6],c[7]=a[b+7];var d=new Float64Array(c.buffer);return d[0]}}},"./parseDicom.js":function(a,b,c){"use strict";(function(a){function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(b,d){function e(a){if(void 0===a.elements)return"1.2.840.10008.1.2";if(void 0===a.elements.x00020010)return"1.2.840.10008.1.2";var c=a.elements.x00020010;return v.readFixedString(b,c.dataOffset,c.length)}function f(a){return"1.2.840.10008.1.2"!==a}function g(e,f){if("1.2.840.10008.1.2.1.99"===e){if(d&&d.inflater){var g=d.inflater(b,f);return new l["default"](p["default"],g,0)}if("undefined"!=typeof a&&this.module!==a){var i=c("../node_modules/browserify-zlib/lib/index.js"),k=(0,t["default"])(b,f,b.length-f),m=i.inflateRawSync(k),n=(0,h["default"])(b,m.length+f);return b.copy(n,0,0,f),m.copy(n,f),new l["default"](p["default"],n,0)}if("undefined"!=typeof pako){var o=b.slice(f),q=pako.inflateRaw(o),r=(0,h["default"])(b,q.length+f);return r.set(b.slice(0,f),0),r.set(q,f),new l["default"](p["default"],r,0)}throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax"}return"1.2.840.10008.1.2.2"===e?new l["default"](j["default"],b,f):new l["default"](p["default"],b,f)}function i(a,b){for(var c in a.elements)a.elements.hasOwnProperty(c)&&(b.elements[c]=a.elements[c]);return void 0!==a.warnings&&(b.warnings=a.warnings.concat(b.warnings)),b}function k(a){var b=e(a),c=f(b),h=g(b,a.position),i={},j=new n["default"](h.byteArrayParser,h.byteArray,i);j.warnings=h.warnings;try{c?x.parseDicomDataSetExplicit(j,h,h.byteArray.length,d):x.parseDicomDataSetImplicit(j,h,h.byteArray.length,d)}catch(k){console.log(k);var l={exception:k,dataSet:j};throw l}return j}function m(){var a=(0,r["default"])(b,d),c=k(a);return i(a,c)}if(void 0===b)throw"dicomParser.parseDicom: missing required parameter 'byteArray'";return m()}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=f;var g=c("./alloc.js"),h=e(g),i=c("./bigEndianByteArrayParser.js"),j=e(i),k=c("./byteStream.js"),l=e(k),m=c("./dataSet.js"),n=e(m),o=c("./littleEndianByteArrayParser.js"),p=e(o),q=c("./readPart10Header.js"),r=e(q),s=c("./sharedCopy.js"),t=e(s),u=c("./byteArrayParser.js"),v=d(u),w=c("./parseDicomDataSet.js"),x=d(w)}).call(this,c("../node_modules/webpack/buildin/module.js")(a))},"./parseDicomDataSet.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(c=void 0===c?b.byteArray.length:c,void 0===b)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(c<b.position||c>b.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var e=a.elements;b.position<c;){var f=(0,h["default"])(b,a.warnings,d.untilTag);if(e[f.tag]=f,f.tag===d.untilTag)return}b.position>c&&console.log(":maxPosition , byteStream.position",c,b.position)}function f(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(c=void 0===c?a.byteArray.length:c,void 0===b)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(c<b.position||c>b.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var e=a.elements;b.position<c;){var f=(0,j["default"])(b,d.untilTag,d.vrCallback);if(e[f.tag]=f,f.tag===d.untilTag)return}}Object.defineProperty(b,"__esModule",{value:!0}),b.parseDicomDataSetExplicit=e,b.parseDicomDataSetImplicit=f;var g=c("./readDicomElementExplicit.js"),h=d(g),i=c("./readDicomElementImplicit.js"),j=d(i)},"./readDicomElementExplicit.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){if(void 0===a)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var d={tag:(0,m["default"])(a),vr:a.readFixedString(2)},e=p(d.vr);return 2===e?(d.length=a.readUint16(),d.dataOffset=a.position):(a.seek(2),d.length=a.readUint32(),d.dataOffset=a.position),4294967295===d.length&&(d.hadUndefinedLength=!0),d.tag===c?d:"SQ"===d.vr?((0,o["default"])(a,d,b),d):4294967295===d.length?"x7fe00010"===d.tag?((0,g["default"])(a,d,b),d):"UN"===d.vr?((0,i["default"])(a,d),d):((0,k["default"])(a,d),d):(a.seek(d.length),d)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./findEndOfEncapsulatedPixelData.js"),g=d(f),h=c("./findAndSetUNElementLength.js"),i=d(h),j=c("./findItemDelimitationItem.js"),k=d(j),l=c("./readTag.js"),m=d(l),n=c("./readSequenceElementExplicit.js"),o=d(n),p=function(a){return"OB"===a||"OW"===a||"SQ"===a||"OF"===a||"UT"===a||"UN"===a?4:2}},"./readDicomElementImplicit.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){if(void 0===a)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var d={tag:(0,k["default"])(a),length:a.readUint32(),dataOffset:a.position};return 4294967295===d.length&&(d.hadUndefinedLength=!0),d.tag===b?d:l(d,a,c)?((0,i["default"])(a,d),d):d.hadUndefinedLength?((0,g["default"])(a,d),d):(a.seek(d.length),d)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./findItemDelimitationItem.js"),g=d(f),h=c("./readSequenceElementImplicit.js"),i=d(h),j=c("./readTag.js"),k=d(j),l=function(a,b,c){if("undefined"!=typeof c)return"SQ"===c(a.tag);if(b.position+4<=b.byteArray.length){var d=(0,k["default"])(b);return b.seek(-4),"xfffee000"===d||"xfffee0dd"===d}return b.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1}},"./readEncapsulatedImageFrame.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d,e){if(d=d||b.basicOffsetTable,e=e||b.fragments,void 0===a)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===b)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===c)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===d)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==b.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(b.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(b.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===b.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===d.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(c<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(c>=d.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var f=d[c],j=h(e,f);if(void 0===j)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";var k=i(c,d,e,j);return(0,g["default"])(a,b,j,k,e)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./readEncapsulatedPixelDataFromFragments.js"),g=d(f),h=function(a,b){for(var c=0;c<a.length;c++)if(a[c].offset===b)return c},i=function(a,b,c,d){if(a===b.length-1)return c.length-d;for(var e=b[a+1],f=d+1;f<c.length;f++)if(c[f].offset===e)return f-d;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"}},"./readEncapsulatedPixelData.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){if(j||(j=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===a)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===b)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===c)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==b.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(b.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(b.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===b.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===b.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(c<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==b.basicOffsetTable.length?(0,g["default"])(a,b,c):(0,i["default"])(a,b,0,b.fragments.length)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./readEncapsulatedImageFrame.js"),g=d(f),h=c("./readEncapsulatedPixelDataFromFragments.js"),i=d(h),j=!1},"./readEncapsulatedPixelDataFromFragments.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d,e){if(d=d||1,e=e||b.fragments,void 0===a)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===b)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===c)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===d)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==b.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(b.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(b.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===b.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===b.fragments)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(b.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(c<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(c>=b.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(d<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(c+d>b.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var f=new i["default"](a.byteArrayParser,a.byteArray,b.dataOffset),h=(0,k["default"])(f);if("xfffee000"!==h.tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";f.seek(h.length);var j=f.position,l=8;if(1===d)return(0,m["default"])(f.byteArray,j+e[c].offset+l,e[c].length);for(var o=n(e,c,d),p=(0,g["default"])(f.byteArray,o),q=0,r=c;r<c+d;r++)for(var s=j+e[r].offset+l,t=0;t<e[r].length;t++)p[q++]=f.byteArray[s++];return p}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./alloc.js"),g=d(f),h=c("./byteStream.js"),i=d(h),j=c("./readSequenceItem.js"),k=d(j),l=c("./sharedCopy.js"),m=d(l),n=function(a,b,c){for(var d=0,e=b;e<b+c;e++)d+=a[e].length;return d}},"./readPart10Header.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){function c(){e.seek(128);var a=e.readFixedString(4);return"DICM"===a||(e.seek(-132),!1)}function d(){if(c()===!1)return e;for(var a=[],b={};e.position<e.byteArray.length;){var d=e.position,f=(0,m["default"])(e,a);if(f.tag>"x0002ffff"){e.position=d;break}f.parser=k["default"],b[f.tag]=f}var g=new i["default"](e.byteArrayParser,e.byteArray,b);return g.warnings=e.warnings,g.position=e.position,g}if(void 0===a)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var e=new g["default"](k["default"],a);return d()}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./byteStream.js"),g=d(f),h=c("./dataSet.js"),i=d(h),j=c("./littleEndianByteArrayParser.js"),k=d(j),l=c("./readDicomElementExplicit.js"),m=d(l)},"./readSequenceElementExplicit.js":function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){for(var c={};a.position<a.byteArray.length;){var d=(0,n["default"])(a,b);if(c[d.tag]=d,"xfffee00d"===d.tag)return new l["default"](a.byteArrayParser,a.byteArray,c)}return b.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new l["default"](a.byteArrayParser,a.byteArray,c)}function g(a,b){var c=(0,p["default"])(a);return 4294967295===c.length?(c.hadUndefinedLength=!0,c.dataSet=f(a,b),c.length=a.position-c.dataOffset):(c.dataSet=new l["default"](a.byteArrayParser,a.byteArray,{}),t.parseDicomDataSetExplicit(c.dataSet,a,a.position+c.length)),c}function h(a,b,c){for(;a.position+4<=a.byteArray.length;){var d=(0,r["default"])(a);if(a.seek(-4),"xfffee0dd"===d)return b.length=a.position-b.dataOffset,a.seek(8),b;var e=g(a,c);b.items.push(e)}c.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),b.length=a.position-b.dataOffset}function i(a,b,c){for(var d=b.dataOffset+b.length;a.position<d;){var e=g(a,c);b.items.push(e)}}function j(a,b,c){if(void 0===a)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===b)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";b.items=[],4294967295===b.length?h(a,b,c):i(a,b,c)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=j;var k=c("./dataSet.js"),l=e(k),m=c("./readDicomElementExplicit.js"),n=e(m),o=c("./readSequenceItem.js"),p=e(o),q=c("./readTag.js"),r=e(q),s=c("./parseDicomDataSet.js"),t=d(s)},"./readSequenceElementImplicit.js":function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){for(var c={};a.position<a.byteArray.length;){var d=(0,n["default"])(a,void 0,b);if(c[d.tag]=d,"xfffee00d"===d.tag)return new l["default"](a.byteArrayParser,a.byteArray,c)}return a.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new l["default"](a.byteArrayParser,a.byteArray,c)}function g(a,b){var c=(0,p["default"])(a);return 4294967295===c.length?(c.hadUndefinedLength=!0,c.dataSet=f(a,b),c.length=a.position-c.dataOffset):(c.dataSet=new l["default"](a.byteArrayParser,a.byteArray,{}),t.parseDicomDataSetImplicit(c.dataSet,a,a.position+c.length,{vrCallback:b})),c}function h(a,b,c){for(;a.position+4<=a.byteArray.length;){var d=(0,r["default"])(a);if(a.seek(-4),"xfffee0dd"===d)return b.length=a.position-b.dataOffset,a.seek(8),b;var e=g(a,c);b.items.push(e)}a.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),b.length=a.byteArray.length-b.dataOffset}function i(a,b,c){for(var d=b.dataOffset+b.length;a.position<d;){var e=g(a,c);b.items.push(e)}}function j(a,b,c){if(void 0===a)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===b)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";b.items=[],4294967295===b.length?h(a,b,c):i(a,b,c)}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=j;var k=c("./dataSet.js"),l=e(k),m=c("./readDicomElementImplicit.js"),n=e(m),o=c("./readSequenceItem.js"),p=e(o),q=c("./readTag.js"),r=e(q),s=c("./parseDicomDataSet.js"),t=d(s)},"./readSequenceItem.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(void 0===a)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var b={tag:(0,g["default"])(a),length:a.readUint32(),dataOffset:a.position};if("xfffee000"!==b.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset "+a.position;return b}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./readTag.js"),g=d(f)},"./readTag.js":function(a,b,c){"use strict";function d(a){if(void 0===a)throw"dicomParser.readTag: missing required parameter 'byteStream'";var b=256*a.readUint16()*256,c=a.readUint16(),d="x"+("00000000"+(b+c).toString(16)).substr(-8);return d}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d},"./sharedCopy.js":function(a,b,c){"use strict";(function(a){function c(b,c,d){if("undefined"!=typeof a&&b instanceof a)return b.slice(c,c+d);if(b instanceof Uint8Array)return new Uint8Array(b.buffer,b.byteOffset+c,d);throw"dicomParser.from: unknown type for byteArray"}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=c}).call(this,c("../node_modules/buffer/index.js").Buffer)},"./util/createJPEGBasicOffsetTable.js":function(a,b,c){"use strict";function d(a,b){return 255===a.byteArray[b]&&217===a.byteArray[b+1]}function e(a,b,c){var e=b.fragments[c];return!(!d(a,e.position+e.length-2)&&!d(a,e.position+e.length-3))}function f(a,b,c){for(var d=c;d<b.fragments.length;d++)if(e(a,b,d))return d}function g(a,b,c){if(void 0===a)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===b)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==b.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(b.encapsulatedPixelData!==!0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(b.hadUndefinedLength!==!0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===b.basicOffsetTable)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===b.fragments)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(b.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(c&&c.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";c=c||b.fragments;for(var d=[],e=0;;){d.push(b.fragments[e].offset);var g=f(a,b,e);if(void 0===g||g===b.fragments.length-1)return d;e=g+1}}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=g},"./util/dataSetToJS.js":function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(void 0===a)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";b=b||{omitPrivateAttibutes:!0,maxElementLength:128};var c={};for(var d in a.elements){var e=a.elements[d];if(b.omitPrivateAttibutes!==!0||!j.isPrivateTag(d))if(e.items){for(var g=[],i=0;i<e.items.length;i++)g.push(f(e.items[i].dataSet,b));c[d]=g}else{var k;k=void 0,e.length<b.maxElementLength&&(k=(0,h["default"])(a,e)),void 0!==k?c[d]=k:c[d]={dataOffset:e.dataOffset,length:e.length}}}return c}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=f;var g=c("./util/elementToString.js"),h=e(g),i=c("./util/util.js"),j=d(i)},"./util/elementToString.js":function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){function c(b,c){for(var d="",e=0;e<b;e++)0!==e&&(d+="/"),d+=c.call(a,f,e).toString();return d}if(void 0===a||void 0===b)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===b.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var d,e=b.vr,f=b.tag;if(g.isStringVr(e)===!0)d=a.string(f);else{if("AT"===e){var h=a.uint32(f);if(void 0===h)return;return h<0&&(h=4294967295+h+1),"x"+h.toString(16).toUpperCase()}"US"===e?d=c(b.length/2,a.uint16):"SS"===e?d=c(b.length/2,a.int16):"UL"===e?d=c(b.length/4,a.uint32):"SL"===e?d=c(b.length/4,a.int32):"FD"===e?d=c(b.length/8,a["double"]):"FL"===e&&(d=c(b.length/4,a["float"]))}return d}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e;var f=c("./util/util.js"),g=d(f)},"./util/index.js":function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c("./util/util.js");Object.keys(e).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(b,a,{enumerable:!0,get:function(){return e[a]}})});var f=c("./util/parseTM.js");Object.defineProperty(b,"parseTM",{enumerable:!0,get:function(){return d(f)["default"]}});var g=c("./util/parseDA.js");Object.defineProperty(b,"parseDA",{enumerable:!0,get:function(){return d(g)["default"]}});var h=c("./util/elementToString.js");Object.defineProperty(b,"explicitElementToString",{enumerable:!0,get:function(){return d(h)["default"]}});var i=c("./util/dataSetToJS.js");Object.defineProperty(b,"explicitDataSetToJS",{enumerable:!0,get:function(){return d(i)["default"]}});var j=c("./util/createJPEGBasicOffsetTable.js");Object.defineProperty(b,"createJPEGBasicOffsetTable",{enumerable:!0,get:function(){return d(j)["default"]}})},"./util/parseDA.js":function(a,b,c){"use strict";function d(a,b){switch(a){case 2:return b%4==0&&b%100||b%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}function e(a,b,c){return!isNaN(c)&&(b>0&&b<=12&&a>0&&a<=d(b,c))}function f(a,b){if(a&&8===a.length){var c=parseInt(a.substring(0,4),10),d=parseInt(a.substring(4,6),10),f=parseInt(a.substring(6,8),10);if(b&&e(f,d,c)!==!0)throw"invalid DA '"+a+"'";return{year:c,month:d,day:f}}if(b)throw"invalid DA '"+a+"'"}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=f},"./util/parseTM.js":function(a,b,c){"use strict";function d(a,b){if(a.length>=2){var c=parseInt(a.substring(0,2),10),d=a.length>=4?parseInt(a.substring(2,4),10):void 0,e=a.length>=6?parseInt(a.substring(4,6),10):void 0,f=a.length>=8?parseInt(a.substring(7,13),10):void 0;if(b&&(isNaN(c)||void 0!==d&&isNaN(d)||void 0!==e&&isNaN(e)||void 0!==f&&isNaN(f)||c<0||c>23||d&&(d<0||d>59)||e&&(e<0||e>59)||f&&(f<0||f>999999)))throw"invalid TM '"+a+"'";return{hours:c,minutes:d,seconds:e,fractionalSeconds:f}}if(b)throw"invalid TM '"+a+"'"}Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=d},"./util/util.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},e=function(a){return d[a]},f=function(a){var b=parseInt(a[4],10),c=b%2===1;return c},g=function(a){if(void 0!==a){var b=a.split("^");return{familyName:b[0],givenName:b[1],middleName:b[2],prefix:b[3],suffix:b[4]}}};b.isStringVr=e,b.isPrivateTag=f,b.parsePN=g},"./version.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]="1.8.1"},0:function(a,b){},1:function(a,b){}})});